var Handsontable={plugins:{},helper:{}};!function(e,t,o){"use strict";function n(){this.refCounter=0,this.init()}function i(){function e(){var e=this;e._registerTimeout(setTimeout(function(){e.updateSettings({observeChanges:!0})},0))}function t(e){return function(t,o){return"string"==typeof t[1]&&(t[1]=t[1].toLowerCase()),"string"==typeof o[1]&&(o[1]=o[1].toLowerCase()),t[1]===o[1]?0:null===t[1]||""===t[1]?1:null===o[1]||""===o[1]?-1:t[1]<o[1]?e?-1:1:t[1]>o[1]?e?1:-1:0}}function n(e){return function(t,o){if(t[1]===o[1])return 0;if(null===t[1])return 1;if(null===o[1])return-1;var n=new Date(t[1]),i=new Date(o[1]);return i>n?e?-1:1:n>i?e?1:-1:0}}function i(e){return"undefined"!=typeof e.sortColumn}var r=this;this.init=function(t){var o,n,i=this,s=i.getSettings().columnSorting;if(i.sortingEnabled=!!s,i.sortingEnabled){i.sortIndex=[];var c=a.call(i);"undefined"!=typeof c?(o=c.sortColumn,n=c.sortOrder):(o=s.column,n=s.sortOrder),r.sortByColumn.call(i,o,n),i.sort=function(){var e=Array.prototype.slice.call(arguments);return r.sortByColumn.apply(i,e)},"undefined"==typeof i.getSettings().observeChanges&&e.call(i),"afterInit"==t&&(l.call(i),i.addHook("afterCreateRow",r.afterCreateRow),i.addHook("afterRemoveRow",r.afterRemoveRow),i.addHook("afterLoadData",r.init))}else delete i.sort,i.removeHook("afterCreateRow",r.afterCreateRow),i.removeHook("afterRemoveRow",r.afterRemoveRow),i.removeHook("afterLoadData",r.init)},this.setSortingColumn=function(e,t){var o=this;return"undefined"==typeof e?(delete o.sortColumn,void delete o.sortOrder):(o.sortOrder=o.sortColumn===e&&"undefined"==typeof t?!o.sortOrder:"undefined"!=typeof t?t:!0,void(o.sortColumn=e))},this.sortByColumn=function(e,t){var n=this;r.setSortingColumn.call(n,e,t),"undefined"!=typeof n.sortColumn&&(o.hooks.run(n,"beforeColumnSort",n.sortColumn,n.sortOrder),r.sort.call(n),n.render(),s.call(n),o.hooks.run(n,"afterColumnSort",n.sortColumn,n.sortOrder))};var s=function(){var e=this,t={};"undefined"!=typeof e.sortColumn&&(t.sortColumn=e.sortColumn),"undefined"!=typeof e.sortOrder&&(t.sortOrder=e.sortOrder),(t.hasOwnProperty("sortColumn")||t.hasOwnProperty("sortOrder"))&&o.hooks.run(e,"persistentStateSave","columnSorting",t)},a=function(){var e=this,t={};return o.hooks.run(e,"persistentStateLoad","columnSorting",t),t.value},l=function(){function e(){var e=n.view.TBODY.querySelector("tr").querySelectorAll("th");return e.length}function t(t){var n=o.Dom.closest(t,"TH");return o.Dom.index(n)-e()}var n=this;n.rootElement.on("click.handsontable",".columnSorting",function(e){var o=t(e.target);r.sortByColumn.call(n,o)})};this.sort=function(){var e=this;if("undefined"!=typeof e.sortOrder){e.sortingEnabled=!1,e.sortIndex.length=0;for(var o=this.colOffset(),i=0,r=this.countRows()-e.getSettings().minSpareRows;r>i;i++)this.sortIndex.push([i,e.getDataAtCell(i,this.sortColumn+o)]);var s,a=e.getCellMeta(0,e.sortColumn);switch(a.type){case"date":s=n;break;default:s=t}this.sortIndex.sort(s(e.sortOrder));for(var i=this.sortIndex.length;i<e.countRows();i++)this.sortIndex.push([i,e.getDataAtCell(i,this.sortColumn+o)]);e.sortingEnabled=!0}},this.translateRow=function(e){var t=this;return t.sortingEnabled&&t.sortIndex&&t.sortIndex.length&&t.sortIndex[e]?t.sortIndex[e][0]:e},this.untranslateRow=function(e){var t=this;if(t.sortingEnabled&&t.sortIndex&&t.sortIndex.length)for(var o=0;o<t.sortIndex.length;o++)if(t.sortIndex[o][0]==e)return o},this.getColHeader=function(e,t){this.getSettings().columnSorting&&e>=0&&o.Dom.addClass(t.querySelector(".colHeader"),"columnSorting")},this.afterCreateRow=function(e,t){var o=this;if(i(o)){for(var n=0;n<o.sortIndex.length;n++)o.sortIndex[n][0]>=e&&(o.sortIndex[n][0]+=t);for(var n=0;t>n;n++)o.sortIndex.splice(e+n,0,[e+n,o.getData()[e+n][o.sortColumn+o.colOffset()]]);s.call(o)}},this.afterRemoveRow=function(e,t){var o=this;if(i(o)){var n=r.translateRow.call(o,e);o.sortIndex.splice(e,t);for(var a=0;a<o.sortIndex.length;a++)o.sortIndex[a][0]>n&&(o.sortIndex[a][0]-=t);s.call(o)}},this.afterChangeSort=function(e){var t=this,o=!1,n={};if(e){for(var i=0;i<e.length;i++)if(e[i][1]==t.sortColumn){o=!0,n.row=r.translateRow.call(t,e[i][0]),n.col=e[i][1];break}o&&t._registerTimeout(setTimeout(function(){r.sort.call(t),t.render(),t.selectCell(r.untranslateRow.call(t,n.row),n.col)},0))}}}function r(t){var n=function(e,t,o,n){n.setCellMeta(e,t,"comment",o),n.render()},i=function(e,t,o){n(e.from.row,e.from.col,t,o)},r=function(){var e=c();e.style.display="none",e.value=""},s=function(n){function s(o){if(e(document).off("mouseover.htCommment"),"htCommentTextArea"!=o.target.className&&-1==o.target.innerHTML.indexOf("Comment")){var s=document.getElementsByClassName("htCommentTextArea")[0].value;s.trim().length>1&&i(n,s,t),a(),r()}}e(document).on("mousedown.htCommment",o.helper.proxy(s))},a=function(){e(document).off("mousedown.htCommment"),e(document).on("mouseover.htCommment",o.helper.proxy(u))},l=function(e,n){var i=t.view.wt.wtTable.getCell(e.from),r=o.Dom.offset(i),a=t.getColWidth(e.from.col);n.style.position="absolute",n.style.left=r.left+a+"px",n.style.top=r.top+"px",n.style.zIndex=2,s(e,n)},c=function(e){var t=document.getElementsByClassName("htComments")[0];if(!t){t=document.createElement("DIV");var n=document.createElement("TEXTAREA");o.Dom.addClass(n,"htCommentTextArea"),t.appendChild(n),o.Dom.addClass(t,"htComments"),document.getElementsByTagName("body")[0].appendChild(t)}return e=e||"",document.getElementsByClassName("htCommentTextArea")[0].value=e,t},u=function(e){if(-1!=e.target.className.indexOf("htCommentCell")){a();var n=t.view.wt.wtTable.getCoords(e.target),i={from:new f(n.row,n.col)};o.Comments.showComment(i)}else"htCommentTextArea"!=e.target.className&&r()};return{init:function(){e(document).on("mouseover.htCommment",o.helper.proxy(u))},showComment:function(e){var o=t.getCellMeta(e.from.row,e.from.col),n="";o.comment&&(n=o.comment);var i=c(n);i.style.display="block",l(e,i)},removeComment:function(e,o){t.removeCellMeta(e,o,"comment"),t.render()},checkSelectionCommentsConsistency:function(){var e=!1,o=t.getSelectedRange().from;return t.getCellMeta(o.row,o.col).comment&&(e=!0),e}}}function s(e){var o,n=function(){t.localStorage[e+"__persistentStateKeys"]=JSON.stringify(o)},i=function(){var n=t.localStorage[e+"__persistentStateKeys"],i="string"==typeof n?JSON.parse(n):void 0;o=i?i:[]},r=function(){o=[],n()};i(),this.saveValue=function(i,r){t.localStorage[e+"_"+i]=JSON.stringify(r),-1==o.indexOf(i)&&(o.push(i),n())},this.loadValue=function(o,n){o="undefined"!=typeof o?o:n;var i=t.localStorage[e+"_"+o];return"undefined"==typeof i?void 0:JSON.parse(i)},this.reset=function(o){t.localStorage.removeItem(e+"_"+o)},this.resetAll=function(){for(var n=0;n<o.length;n++)t.localStorage.removeItem(e+"_"+o[n]);r()}}function a(){this.boundaries=null,this.callback=null}function l(){var e=[];return e.getInfo=function(e,t){for(var o=0,n=this.length;n>o;o++)if(this[o].row<=e&&this[o].row+this[o].rowspan-1>=e&&this[o].col<=t&&this[o].col+this[o].colspan-1>=t)return this[o]},e.setInfo=function(e){for(var t=0,o=this.length;o>t;t++)if(this[t].row===e.row&&this[t].col===e.col)return void(this[t]=e);this.push(e)},e.removeInfo=function(e,t){for(var o=0,n=this.length;n>o;o++)if(this[o].row===e&&this[o].col===t){this.splice(o,1);break}},e}function c(e){if(this.mergedCellInfoCollection=new l,o.helper.isArray(e))for(var t=0,n=e.length;n>t;t++)this.mergedCellInfoCollection.setInfo(e[t])}function u(){}function h(e){this.instance=e}function d(t,o){var n;if(o){this.instance=t,this.settings=o,this.main=document.createElement("div"),n=this.main.style,n.position="absolute",n.top=0,n.left=0;for(var i=["top","left","bottom","right","corner"],r=0;5>r;r++){var s=i[r],a=document.createElement("DIV");a.className="wtBorder "+(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(a.className+=" hidden"),n=a.style,n.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:o.border.color,n.height=this.settings[s]&&this.settings[s].width?this.settings[s].width+"px":o.border.width+"px",n.width=this.settings[s]&&this.settings[s].width?this.settings[s].width+"px":o.border.width+"px",this.main.appendChild(a)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width="5px",this.cornerStyle.height="5px",this.cornerStyle.border="2px solid #FFF",this.disappear(),t.wtTable.bordersHolder||(t.wtTable.bordersHolder=document.createElement("div"),t.wtTable.bordersHolder.className="htBorders",t.wtTable.hider.appendChild(t.wtTable.bordersHolder)),t.wtTable.bordersHolder.insertBefore(this.main,t.wtTable.bordersHolder.firstChild);var l=!1,c=e(document.body);c.on("mousedown.walkontable."+t.guid,function(){l=!0}),c.on("mouseup.walkontable."+t.guid,function(){l=!1}),e(this.main.childNodes).on("mouseenter",function(o){if(l&&t.getSetting("hideBorderOnMouseDownOver")){o.preventDefault(),o.stopImmediatePropagation();var n=this.getBoundingClientRect(),i=e(this);i.hide();var r=function(e){return e.clientY<Math.floor(n.top)?!0:e.clientY>Math.ceil(n.top+n.height)?!0:e.clientX<Math.floor(n.left)?!0:e.clientX>Math.ceil(n.left+n.width)?!0:void 0};c.on("mousemove.border."+t.guid,function(e){r(e)&&(c.off("mousemove.border."+t.guid),i.show())})}})}}function f(e,t){"undefined"!=typeof e&&"undefined"!=typeof t?(this.row=e,this.col=t):(this.row=null,this.col=null)}function p(e,t,o){this.highlight=e,this.from=t,this.to=o}function g(e,t){this.total=e,this.countTH=t}function m(e,t,o,n){var i,r=0;for(h.apply(this,arguments),this.containerSizeFn=t,this.cellSizesSum=0,this.cellSizes=[],this.cellStretch=[],this.cellCount=0,this.visibleCellCount=0,this.remainingSize=0,this.strategy=n;;){if(i=o(r),void 0===i)break;this.cellSizesSum<this.getContainerSize(this.cellSizesSum+i)&&this.visibleCellCount++,this.cellSizes.push(i),this.cellSizesSum+=i,this.cellCount++,r++}var s=this.getContainerSize(this.cellSizesSum);this.remainingSize=this.cellSizesSum-s}function w(e){var t=[];if(this.guid="wt_"+C(),e.cloneSource?(this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=new H(this,e.table),this.wtScroll=new R(this),this.wtViewport=e.cloneSource.wtViewport,this.wtEvent=new y(this),this.selections=this.cloneSource.selections):(this.wtSettings=new A(this,e),this.wtTable=new H(this,e.table),this.wtScroll=new R(this),this.wtViewport=new M(this),this.wtEvent=new y(this),this.selections=this.getSetting("selections"),this.wtScrollbars=new D(this)),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;i>n;n++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,n){o.Dom.fastInnerText(n,t[e])}])}this.drawn=!1,this.drawInterrupted=!1}function v(t){this.instance=t,this.init(),this.clone=this.makeClone("debug"),this.clone.wtTable.holder.style.opacity=.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",this.lastTimeout=null;var n=this,i=0,r=0,s=n.clone.wtTable.holder.parentNode;e(document.body).on("mousemove."+this.instance.guid,function(e){n.instance.wtTable.holder.parentNode&&(e.clientX-i>-5&&e.clientX-i<5&&e.clientY-r>-5&&e.clientY-r<5||(i=e.clientX,r=e.clientY,o.Dom.addClass(s,"wtDebugHidden"),o.Dom.removeClass(s,"wtDebugVisible"),clearTimeout(this.lastTimeout),this.lastTimeout=setTimeout(function(){o.Dom.removeClass(s,"wtDebugHidden"),o.Dom.addClass(s,"wtDebugVisible")},1e3)))})}function y(n){var i=this;this.instance=n;var r=[null,null];this.dblClickTimeout=[null,null];var s,a=function(e){var t=i.parentCell(e.target);o.Dom.hasClass(e.target,"corner")?i.instance.getSetting("onCellCornerMouseDown",e,e.target):t.TD&&i.instance.hasSetting("onCellMouseDown")&&i.instance.getSetting("onCellMouseDown",e,t.coords,t.TD,i.instance),2!==e.button&&t.TD&&(r[0]=t.TD,clearTimeout(i.dblClickTimeout[0]),i.dblClickTimeout[0]=setTimeout(function(){r[0]=null},1e3))},l=function(e){if(i.instance.hasSetting("onCellMouseOver")){var t=i.instance.wtTable.TABLE,n=o.Dom.closest(e.target,["TD","TH"],t);n&&n!==s&&o.Dom.isChildOf(n,t)&&(s=n,i.instance.getSetting("onCellMouseOver",e,i.instance.wtTable.getCoords(n),n,i.instance))}},c=function(e){if(2!==e.button){var t=i.parentCell(e.target);t.TD===r[0]&&t.TD===r[1]?(o.Dom.hasClass(e.target,"corner")?i.instance.getSetting("onCellCornerDblClick",e,t.coords,t.TD,i.instance):i.instance.getSetting("onCellDblClick",e,t.coords,t.TD,i.instance),r[0]=null,r[1]=null):t.TD===r[0]&&(r[1]=t.TD,clearTimeout(i.dblClickTimeout[1]),i.dblClickTimeout[1]=setTimeout(function(){r[1]=null},500))}};e(this.instance.wtTable.holder).on("mousedown",a),e(this.instance.wtTable.TABLE).on("mouseover",l),e(this.instance.wtTable.holder).on("mouseup",c),e(t).on("resize."+this.instance.guid,function(){i.instance.draw()})}function C(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function b(e,t,o){this.offset=e,this.total=t,this.countTH=o}function S(e,t,o){h.apply(this,arguments),this.containerSizeFn=t,this.sizeAtIndex=o,this.cellSizesSum=0,this.cellSizes=[],this.cellCount=0,this.visiblCellCount=0,this.remainingSize=-1/0,this.maxOuts=10,this.curOuts=this.maxOuts}function R(e){this.instance=e}function T(e){this.instance=e,this.type="corner",this.init(),this.clone=this.makeClone("corner")}function E(e){this.instance=e,this.type="horizontal",this.cellSize=50,this.offset=0,this.init(),this.clone=this.makeClone("left")}function k(e){this.instance=e,this.type="vertical",this.cellSize=this.instance.wtSettings.settings.defaultRowHeight,this.offset,this.total,this.init(),this.clone=this.makeClone("top")}function D(e){this.instance=e,e.update("scrollbarWidth",o.Dom.getScrollbarWidth()),e.update("scrollbarHeight",o.Dom.getScrollbarWidth()),this.vertical=new k(e),this.horizontal=new E(e),this.corner=new T(e),e.getSetting("debug")&&(this.debug=new v(e)),this.registerListeners()}function x(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={}}function A(e,t){var n=this;this.instance=e,this.defaults={table:void 0,debug:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(e,t,i){var r=n.getSetting("data",e,t);o.Dom.fastInnerText(i,void 0===r||null===r?"":r)},columnWidth:50,rowHeight:function(){return 23},defaultRowHeight:23,selections:null,hideBorderOnMouseDownOver:!1,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1},this.settings={};for(var i in this.defaults)if(this.defaults.hasOwnProperty(i))if(void 0!==t[i])this.settings[i]=t[i];else{if(void 0===this.defaults[i])throw new Error('A required setting "'+i+'" was not provided');this.settings[i]=this.defaults[i]}}function H(e,t){this.instance=e,this.TABLE=t,o.Dom.removeTextNodes(this.TABLE);var n=this.TABLE.parentNode;if(!n||1!==n.nodeType||!o.Dom.hasClass(n,"wtHolder")){var i=document.createElement("DIV");i.className="wtSpreader",n&&n.insertBefore(i,this.TABLE),i.appendChild(this.TABLE)}if(this.spreader=this.TABLE.parentNode,n=this.spreader.parentNode,!n||1!==n.nodeType||!o.Dom.hasClass(n,"wtHolder")){var r=document.createElement("DIV");r.className="wtHider",n&&n.insertBefore(r,this.spreader),r.appendChild(this.spreader)}if(this.hider=this.spreader.parentNode,this.hiderStyle=this.hider.style,this.hiderStyle.position="relative",n=this.hider.parentNode,!n||1!==n.nodeType||!o.Dom.hasClass(n,"wtHolder")){var s=document.createElement("DIV");s.style.position="relative",s.className="wtHolder",e.cloneSource||(s.className+=" ht_master"),n&&n.insertBefore(s,this.hider),s.appendChild(this.hider)}if(this.holder=this.hider.parentNode,this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0],this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0],this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0],this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.instance.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length){var a=document.createElement("TR");this.THEAD.appendChild(a)}this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null,this.columnWidthCache=[]}function O(e){this.wtTable=e,this.instance=e.instance,this.rowFilter=e.rowFilter,this.columnFilter=e.columnFilter,this.TABLE=e.TABLE,this.THEAD=e.THEAD,this.TBODY=e.TBODY,this.COLGROUP=e.COLGROUP,this.utils=O.utils}function M(o){this.instance=o,this.resetSettings();var n=this;e(t).on("resize.walkontable."+this.instance.guid,function(){n.clientHeight=n.getWorkspaceHeight()})}Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,o=Number(arguments[1])||0;for(o=0>o?Math.ceil(o):Math.floor(o),0>o&&(o+=t);t>o;o++)if(o in this&&this[o]===e)return o;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e,t){function o(e){return/NodeList/i.test(e.item)}function n(e){for(var t=[],o=0,n=e.length;n>o;o++)t[o]=e[o];return t}if("undefined"==typeof this||null===this)throw new TypeError;if("function"!=typeof e)throw new TypeError;t=t||this,o(t)&&(t=n(t));var i,r,s=t.length,a=[];for(i=0;s>i;i+=1)t.hasOwnProperty(i)&&(r=t[i],e.call(t,r,i,t)&&a.push(r));return a}),"undefined"==typeof WeakMap&&!function(){var e=Object.defineProperty;try{var o=!0;e(function(){},"foo",{})}catch(n){o=!1}var i=+new Date%1e9,r=function(){this.name="__st"+(1e9*Math.random()>>>0)+(i++ +"__"),o||(this._wmCache=[])};r.prototype=o?{set:function(t,o){var n=t[this.name];n&&n[0]===t?n[1]=o:e(t,this.name,{value:[t,o],writable:!0})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},"delete":function(e){this.set(e,void 0)}}:{set:function(e,t){if("undefined"!=typeof e&&"undefined"!=typeof t){for(var o=0,n=this._wmCache.length;n>o;o++)if(this._wmCache[o].key==e)return void(this._wmCache[o].value=t);this._wmCache.push({key:e,value:t})}},get:function(e){if("undefined"!=typeof e)for(var t=0,o=this._wmCache.length;o>t;t++)if(this._wmCache[t].key==e)return this._wmCache[t].value},"delete":function(e){if("undefined"!=typeof e)for(var t=0,o=this._wmCache.length;o>t;t++)this._wmCache[t].key==e&&Array.prototype.slice.call(this._wmCache,t,1)}},t.WeakMap=r}(),o.activeGuid=null,o.Core=function(n,i){function r(){var e=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==e&&(e=!0,this.onQueueEmpty())}}}function s(t,n,i){function s(){var r;t.length&&(r=o.hooks.execute(C,"beforeChange",t,n),"function"==typeof r?e.when(result).then(function(){i()}):r===!1&&t.splice(0,t.length)),"function"!=typeof r&&i()}var a=new r;a.onQueueEmpty=s;for(var l=t.length-1;l>=0;l--)if(null===t[l])t.splice(l,1);else{var c=t[l][0],u=m.propToCol(t[l][1]),h=C.runHooksAndReturn("modifyCol",u),d=C.getCellMeta(c,h);if("numeric"===d.type&&"string"==typeof t[l][3]&&t[l][3].length>0&&/^-?[\d\s]*(\.|\,)?\d*$/.test(t[l][3])){var f=t[l][3].length;numeral.language("undefined"==typeof d.language?"en":t[l][3].indexOf(".")===f-3&&-1===t[l][3].indexOf(",")?"en":d.language),t[l][3]=numeral().unformat(t[l][3]||"0")}C.getCellValidator(d)&&(a.addValidatorToQueue(),C.validateCell(t[l][3],d,function(e,o){return function(n){if("boolean"!=typeof n)throw new Error("Validation error: result is not boolean");n===!1&&o.allowInvalid===!1&&(t.splice(e,1),o.valid=!0,--e),a.removeValidatorFormQueue()}}(l,d),n))}a.checkIfQueueIsEmpty()}function a(e,t){var n=e.length-1;if(!(0>n)){for(;n>=0;n--)if(null!==e[n]){if(null!=e[n][2]||null!=e[n][3]){if(g.settings.minSpareRows)for(;e[n][0]>C.countRows()-1;)m.createRow();if("array"===C.dataType&&g.settings.minSpareCols)for(;m.propToCol(e[n][1])>C.countCols()-1;)m.createCol();m.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1);C.forceFullRender=!0,w.adjustRowsAndCols(),o.hooks.run(C,"beforeChangeRender",e,t),v.refreshBorders(null,!0),o.hooks.run(C,"afterChange",e,t||"edit")}}function l(t,o,n){return"object"==typeof t?t:e.isPlainObject(n)?n:[[t,o,n]]}function c(e){if(e.hasOwnProperty("type")){var t,n={};if("object"==typeof e.type)t=e.type;else if("string"==typeof e.type&&(t=o.cellTypes[e.type],void 0===t))throw new Error('You declared cell type "'+e.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(n[i]=t[i]);return n}}function u(e){return o.hooks.execute(C,"modifyRow",e)}function h(e){return o.hooks.execute(C,"modifyCol",e)}function d(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}var g,m,w,v,y,C=this,b=function(){},S=e(document.documentElement),R=e(document.body);o.helper.extend(b.prototype,P.prototype),o.helper.extend(b.prototype,i),o.helper.extend(b.prototype,c(i)),this.rootElement=n,this.container=document.createElement("DIV"),this.container.className="htContainer",n.prepend(this.container),this.container=e(this.container),this.guid="ht_"+o.helper.randomString(),this.rootElement[0].id&&"ht_"!==this.rootElement[0].id.substring(0,3)||(this.rootElement[0].id=this.guid),g={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new b,selRange:null,isPopulated:null,scrollable:null,firstRun:!0},w={alter:function(e,t,n,i,r){var s;switch(n=n||1,e){case"insert_row":s=m.createRow(t,n),s&&(v.isSelected()&&g.selRange.from.row>=t?(g.selRange.from.row=g.selRange.from.row+s,v.transformEnd(s,0)):v.refreshBorders());break;case"insert_col":if(s=m.createCol(t,n)){if(o.helper.isArray(C.getSettings().colHeaders)){var a=[t,0];a.length+=s,Array.prototype.splice.apply(C.getSettings().colHeaders,a)}v.isSelected()&&g.selRange.from.col>=t?(g.selRange.from.col=g.selRange.from.col+s,v.transformEnd(0,s)):v.refreshBorders()}break;case"remove_row":m.removeRow(t,n),g.cellSettings.splice(t,n),w.adjustRowsAndCols(),v.refreshBorders();break;case"remove_col":m.removeCol(t,n);for(var l=0,c=m.getAll().length;c>l;l++)l in g.cellSettings&&g.cellSettings[l].splice(t,n);o.helper.isArray(C.getSettings().colHeaders)&&("undefined"==typeof t&&(t=-1),C.getSettings().colHeaders.splice(t,n)),g.columnSettings.splice(t,n),w.adjustRowsAndCols(),v.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"')}r||w.adjustRowsAndCols()},adjustRowsAndCols:function(){var e,t,o,n;if(t=C.countRows(),t<g.settings.minRows)for(e=0;e<g.settings.minRows-t;e++)m.createRow(C.countRows(),1,!0);if(o=C.countEmptyRows(!0),o<g.settings.minSpareRows)for(;o<g.settings.minSpareRows&&C.countRows()<g.settings.maxRows;o++)m.createRow(C.countRows(),1,!0);if(n=C.countEmptyCols(!0),!g.settings.columns&&C.countCols()<g.settings.minCols)for(;C.countCols()<g.settings.minCols;n++)m.createCol(C.countCols(),1,!0);if(!g.settings.columns&&"array"===C.dataType&&n<g.settings.minSpareCols)for(;n<g.settings.minSpareCols&&C.countCols()<g.settings.maxCols;n++)m.createCol(C.countCols(),1,!0);var i=C.countRows(),r=C.countCols();if((0===i||0===r)&&v.deselect(),v.isSelected()){var s,a=g.selRange.from.row,l=g.selRange.from.col,c=g.selRange.to.row,u=g.selRange.to.col;a>i-1?(a=i-1,s=!0,c>a&&(c=a)):c>i-1&&(c=i-1,s=!0,a>c&&(a=c)),l>r-1?(l=r-1,s=!0,u>l&&(u=l)):u>r-1&&(u=r-1,s=!0,l>u&&(l=u)),s&&C.selectCell(a,l,c,u)}},populateFromArray:function(e,t,n,i,r){var s,a,l,c,u=[],h={};if(a=t.length,0===a)return!1;var d,f,p,m;switch(r){case"shift_down":for(d=n?n.col-e.col+1:0,f=n?n.row-e.row+1:0,t=o.helper.translateRowsToColumns(t),l=0,c=t.length,p=Math.max(c,d);p>l;l++)if(c>l){for(s=0,a=t[l].length;f-a>s;s++)t[l].push(t[l][s%a]);t[l].unshift(e.col+l,e.row,0),C.spliceCol.apply(C,t[l])}else t[l%c][0]=e.col+l,C.spliceCol.apply(C,t[l%c]);break;case"shift_right":for(d=n?n.col-e.col+1:0,f=n?n.row-e.row+1:0,s=0,a=t.length,m=Math.max(a,f);m>s;s++)if(a>s){for(l=0,c=t[s].length;d-c>l;l++)t[s].push(t[s][l%c]);t[s].unshift(e.row+s,e.col,0),C.spliceRow.apply(C,t[s])}else t[s%a][0]=e.row+s,C.spliceRow.apply(C,t[s%a]);break;case"overwrite":default:for(h.row=e.row,h.col=e.col,s=0;a>s&&!(n&&h.row>n.row||!g.settings.minSpareRows&&h.row>C.countRows()-1||h.row>=g.settings.maxRows);s++){for(h.col=e.col,c=t[s]?t[s].length:0,l=0;c>l&&!(n&&h.col>n.col||!g.settings.minSpareCols&&h.col>C.countCols()-1||h.col>=g.settings.maxCols);l++)C.getCellMeta(h.row,h.col).readOnly||u.push([h.row,h.col,t[s][l]]),h.col++,n&&l===c-1&&(l=-1);h.row++,n&&s===a-1&&(s=-1)}C.setDataAtCell(u,null,null,i||"populateFromArray")}}},this.selection=v={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(e,t){C.selection.selectedHeader.rows=e,C.selection.selectedHeader.cols=t},begin:function(){C.selection.inProgress=!0},finish:function(){var e=C.getSelected();o.hooks.run(C,"afterSelectionEnd",e[0],e[1],e[2],e[3]),o.hooks.run(C,"afterSelectionEndByProp",e[0],C.colToProp(e[1]),e[2],C.colToProp(e[3])),C.selection.inProgress=!1},isInProgress:function(){return C.selection.inProgress},setRangeStart:function(e){o.hooks.run(C,"beforeSetRangeStart",e),g.selRange=new p(e,e,e),v.setRangeEnd(e)},setRangeEnd:function(e,t){o.hooks.run(C,"beforeSetRangeEnd",e),C.selection.begin(),g.selRange.to=new f(e.row,e.col),g.settings.multiSelect||(g.selRange.from=e),C.view.wt.selections.current.clear(),C.view.wt.selections.current.add(g.selRange.highlight),C.view.wt.selections.area.clear(),v.isMultiple()&&(C.view.wt.selections.area.add(g.selRange.from),C.view.wt.selections.area.add(g.selRange.to)),(g.settings.currentRowClassName||g.settings.currentColClassName)&&(C.view.wt.selections.highlight.clear(),C.view.wt.selections.highlight.add(g.selRange.from),C.view.wt.selections.highlight.add(g.selRange.to)),o.hooks.run(C,"afterSelection",g.selRange.from.row,g.selRange.from.col,g.selRange.to.row,g.selRange.to.col),o.hooks.run(C,"afterSelectionByProp",g.selRange.from.row,m.colToProp(g.selRange.from.col),g.selRange.to.row,m.colToProp(g.selRange.to.col)),t!==!1&&C.view.mainViewIsActive()&&C.view.scrollViewport(e),v.refreshBorders()},refreshBorders:function(e,t){t||y.destroyEditor(e),C.view.render(),v.isSelected()&&!t&&y.prepareEditor()},isMultiple:function(){var e=!(g.selRange.to.col===g.selRange.from.col&&g.selRange.to.row===g.selRange.from.row),t=o.hooks.execute(C,"afterIsMultipleSelection",e);return e?t:void 0},transformStart:function(e,t,o){var n=new f(e,t);C.runHooks("modifyTransformStart",n),g.selRange.highlight.row+e>C.countRows()-1?o&&g.settings.minSpareRows>0?C.alter("insert_row",C.countRows()):g.settings.autoWrapCol&&(n.row=1-C.countRows(),n.col=g.selRange.highlight.col+n.col==C.countCols()-1?1-C.countCols():1):g.settings.autoWrapCol&&g.selRange.highlight.row+n.row<0&&g.selRange.highlight.col+n.col>=0&&(n.row=C.countRows()-1,n.col=g.selRange.highlight.col+n.col==0?C.countCols()-1:-1),g.selRange.highlight.col+n.col>C.countCols()-1?o&&g.settings.minSpareCols>0?C.alter("insert_col",C.countCols()):g.settings.autoWrapRow&&(n.row=g.selRange.highlight.row+n.row==C.countRows()-1?1-C.countRows():1,n.col=1-C.countCols()):g.settings.autoWrapRow&&g.selRange.highlight.col+n.col<0&&g.selRange.highlight.row+n.row>=0&&(n.row=g.selRange.highlight.row+n.row==0?C.countRows()-1:-1,n.col=C.countCols()-1);var i=C.countRows(),r=C.countCols(),s=new f(g.selRange.highlight.row+n.row,g.selRange.highlight.col+n.col);s.row<0?s.row=0:s.row>0&&s.row>=i&&(s.row=i-1),s.col<0?s.col=0:s.col>0&&s.col>=r&&(s.col=r-1),v.setRangeStart(s)},transformEnd:function(e,t){var o=new f(e,t);C.runHooks("modifyTransformEnd",o);var n=C.countRows(),i=C.countCols(),r=new f(g.selRange.to.row+o.row,g.selRange.to.col+o.col);r.row<0?r.row=0:r.row>0&&r.row>=n&&(r.row=n-1),r.col<0?r.col=0:r.col>0&&r.col>=i&&(r.col=i-1),v.setRangeEnd(r)},isSelected:function(){return null!==g.selRange},inInSelection:function(e){return v.isSelected()?g.selRange.includes(e):!1},deselect:function(){v.isSelected()&&(C.selection.inProgress=!1,g.selRange=null,C.view.wt.selections.current.clear(),C.view.wt.selections.area.clear(),(g.settings.currentRowClassName||g.settings.currentColClassName)&&C.view.wt.selections.highlight.clear(),y.destroyEditor(),v.refreshBorders(),o.hooks.run(C,"afterDeselect"))},selectAll:function(){g.settings.multiSelect&&(v.setRangeStart(new f(0,0)),v.setRangeEnd(new f(C.countRows()-1,C.countCols()-1),!1))},empty:function(){if(v.isSelected()){var e,t,o=g.selRange.getTopLeftCorner(),n=g.selRange.getBottomRightCorner(),i=[];for(e=o.row;e<=n.row;e++)for(t=o.col;t<=n.col;t++)C.getCellMeta(e,t).readOnly||i.push([e,t,""]);C.setDataAtCell(i)}}},this.init=function(){o.hooks.run(C,"beforeInit"),this.updateSettings(g.settings,!0),this.view=new o.TableView(this),y=new o.EditorManager(C,g,v,m),this.forceFullRender=!0,this.view.render(),"object"==typeof g.firstRun&&(o.hooks.run(C,"afterChange",g.firstRun[0],g.firstRun[1]),g.firstRun=!1),o.hooks.run(C,"afterInit")},this.validateCell=function(e,t,n,i){var r=C.getCellValidator(t);"[object RegExp]"===Object.prototype.toString.call(r)&&(r=function(e){return function(t,o){o(e.test(t))}}(r)),"function"==typeof r?(e=o.hooks.execute(C,"beforeValidate",e,t.row,t.prop,i),C._registerTimeout(setTimeout(function(){return r.call(t,e,function(r){t.valid=r,r=o.hooks.execute(C,"afterValidate",r,e,t.row,t.prop,i),n(r)}),e},0))):(t.valid=!0,n(!0))},this.setDataAtCell=function(e,t,o,n){var i,r,c,u=l(e,t,o),h=[];for(i=0,r=u.length;r>i;i++){if("object"!=typeof u[i])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof u[i][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=m.colToProp(u[i][1]),h.push([u[i][0],c,m.get(u[i][0],c),u[i][2]])}n||"object"!=typeof e||(n=t),s(h,n,function(){a(h,n)})},this.setDataAtRowProp=function(e,t,o,n){var i,r,c=l(e,t,o),u=[];for(i=0,r=c.length;r>i;i++)u.push([c[i][0],c[i][1],m.get(c[i][0],c[i][1]),c[i][2]]);n||"object"!=typeof e||(n=t),s(u,n,function(){a(u,n)})},this.listen=function(){o.activeGuid=C.guid,document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()},this.unlisten=function(){o.activeGuid=null},this.isListening=function(){return o.activeGuid===C.guid},this.destroyEditor=function(e){v.refreshBorders(e)},this.populateFromArray=function(e,t,o,n,i,r,s){if("object"!=typeof o||"object"!=typeof o[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");return w.populateFromArray(new f(e,t),o,"number"==typeof n?new f(n,i):null,r,s)},this.spliceCol=function(){return m.spliceCol.apply(m,arguments)},this.spliceRow=function(){return m.spliceRow.apply(m,arguments)},this.getSelected=function(){return v.isSelected()?[g.selRange.from.row,g.selRange.from.col,g.selRange.to.row,g.selRange.to.col]:void 0
},this.getSelectedRange=function(){return v.isSelected()?g.selRange:void 0},this.render=function(){C.view&&(C.forceFullRender=!0,v.refreshBorders(null,!0))},this.loadData=function(e){function t(){g.cellSettings.length=0}if("object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof e+" given)");e=[];for(var n,i=0,r=g.settings.startRows;r>i;i++){n=[];for(var s=0,a=g.settings.startCols;a>s;s++)n.push(null);e.push(n)}}g.isPopulated=!1,b.prototype.data=e,C.dataType=g.settings.dataSchema instanceof Array||e[0]instanceof Array?"array":"function"==typeof g.settings.dataSchema?"function":"object",m=new o.DataMap(C,g,b),t(),w.adjustRowsAndCols(),o.hooks.run(C,"afterLoadData"),g.firstRun?g.firstRun=[null,"loadData"]:(o.hooks.run(C,"afterChange",null,"loadData"),C.render()),g.isPopulated=!0},this.getData=function(e,t,o,n){return"undefined"==typeof e?m.getAll():m.getRange(new f(e,t),new f(o,n),m.DESTINATION_RENDERER)},this.getCopyableData=function(e,t,o,n){return m.getCopyableText(new f(e,t),new f(o,n))},this.updateSettings=function(e,t){var n,i;if("undefined"!=typeof e.rows)throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if("undefined"!=typeof e.cols)throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(n in e)"data"!==n&&(void 0!==o.hooks.hooks[n]||void 0!==o.hooks.legacy[n]?("function"==typeof e[n]||o.helper.isArray(e[n]))&&C.addHook(n,e[n]):!t&&e.hasOwnProperty(n)&&(b.prototype[n]=e[n]));if(void 0===e.data&&void 0===g.settings.data?C.loadData(null):void 0!==e.data?C.loadData(e.data):void 0!==e.columns&&m.createMap(),i=C.countCols(),g.cellSettings.length=0,i>0){var r,s;for(n=0;i>n;n++)g.columnSettings[n]=o.helper.columnFactory(b,g.columnsSettingConflicts),r=g.columnSettings[n].prototype,b.prototype.columns&&(s=b.prototype.columns[n],o.helper.extend(r,s),o.helper.extend(r,c(s)))}if("undefined"!=typeof e.cell)for(n in e.cell){var a=e.cell[n];C.setCellMetaObject(a.row,a.col,a)}if(o.hooks.run(C,"afterCellMetaReset"),"undefined"!=typeof e.className&&(b.prototype.className&&C.rootElement.removeClass(b.prototype.className),e.className&&C.rootElement.addClass(e.className)),"undefined"!=typeof e.height){var l=e.height;"function"==typeof l&&(l=l()),C.rootElement[0].style.height=l+"px"}if("undefined"!=typeof e.width){var u=e.width;"function"==typeof u&&(u=u()),C.rootElement[0].style.width=u+"px"}l&&(C.rootElement[0].style.overflow="auto"),t||o.hooks.run(C,"afterUpdateSettings"),w.adjustRowsAndCols(),C.view&&!g.firstRun&&(C.forceFullRender=!0,v.refreshBorders(null,!0))},this.getValue=function(){var e=C.getSelected();if(b.prototype.getValue){if("function"==typeof b.prototype.getValue)return b.prototype.getValue.call(C);if(e)return C.getData()[e[0]][b.prototype.getValue]}else if(e)return C.getDataAtCell(e[0],e[1])},this.getSettings=function(){return g.settings},this.clear=function(){v.selectAll(),v.empty()},this.alter=function(e,t,o,n,i){w.alter(e,t,o,n,i)},this.getCell=function(e,t){return C.view.getCellAtCoords(new f(e,t))},this.colToProp=function(e){return m.colToProp(e)},this.propToCol=function(e){return m.propToCol(e)},this.getDataAtCell=function(e,t){return m.get(e,m.colToProp(t))},this.getDataAtRowProp=function(e,t){return m.get(e,t)},this.getDataAtCol=function(e){var t=[];return t.concat.apply(t,m.getRange(new f(0,e),new f(g.settings.data.length-1,e),m.DESTINATION_RENDERER))},this.getDataAtProp=function(e){var t=[];return t.concat.apply(t,m.getRange(new f(0,m.propToCol(e)),new f(g.settings.data.length-1,m.propToCol(e)),m.DESTINATION_RENDERER))},this.getSourceDataAtCol=function(e){for(var t=[],o=g.settings.data,n=0;n<o.length;n++)t.push(o[n][e]);return t},this.getSourceDataAtRow=function(e){return g.settings.data[e]},this.getDataAtRow=function(e){var t=m.getRange(new f(e,0),new f(e,this.countCols()-1),m.DESTINATION_RENDERER);return t[0]},this.removeCellMeta=function(e,t,o){var n=C.getCellMeta(e,t);void 0!=n[o]&&delete g.cellSettings[e][t][o]},this.setCellMetaObject=function(e,t,o){if("object"==typeof o)for(var n in o){var i=n,r=o[n];this.setCellMeta(e,t,i,r)}},this.setCellMeta=function(e,t,n,i){g.cellSettings[e]||(g.cellSettings[e]=[]),g.cellSettings[e][t]||(g.cellSettings[e][t]=new g.columnSettings[t]),g.cellSettings[e][t][n]=i,o.hooks.run(C,"afterSetCellMeta",e,t,n,i)},this.getCellMeta=function(e,t){var n,i=m.colToProp(t);if(e=u(e),t=h(t),g.columnSettings[t]||(g.columnSettings[t]=o.helper.columnFactory(b,g.columnsSettingConflicts)),g.cellSettings[e]||(g.cellSettings[e]=[]),g.cellSettings[e][t]||(g.cellSettings[e][t]=new g.columnSettings[t]),n=g.cellSettings[e][t],n.row=e,n.col=t,n.prop=i,n.instance=C,o.hooks.run(C,"beforeGetCellMeta",e,t,n),o.helper.extend(n,c(n)),n.cells){var r=n.cells.call(n,e,t,i);r&&(o.helper.extend(n,r),o.helper.extend(n,c(r)))}return o.hooks.run(C,"afterGetCellMeta",e,t,n),n};var T=o.helper.cellMethodLookupFactory("renderer");this.getCellRenderer=function(e,t){var n=T.call(this,e,t);return o.renderers.getRenderer(n)},this.getCellEditor=o.helper.cellMethodLookupFactory("editor"),this.getCellValidator=o.helper.cellMethodLookupFactory("validator"),this.validateCells=function(e){var t=new r;t.onQueueEmpty=e;for(var o=C.countRows()-1;o>=0;){for(var n=C.countCols()-1;n>=0;)t.addValidatorToQueue(),C.validateCell(C.getDataAtCell(o,n),C.getCellMeta(o,n),function(){t.removeValidatorFormQueue()},"validateCells"),n--;o--}t.checkIfQueueIsEmpty()},this.getRowHeader=function(e){if(void 0===e){for(var t=[],o=0,n=C.countRows();n>o;o++)t.push(C.getRowHeader(o));return t}return"[object Array]"===Object.prototype.toString.call(g.settings.rowHeaders)&&void 0!==g.settings.rowHeaders[e]?g.settings.rowHeaders[e]:"function"==typeof g.settings.rowHeaders?g.settings.rowHeaders(e):g.settings.rowHeaders&&"string"!=typeof g.settings.rowHeaders&&"number"!=typeof g.settings.rowHeaders?e+1:g.settings.rowHeaders},this.hasRowHeaders=function(){return!!g.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==g.settings.colHeaders&&null!==g.settings.colHeaders)return!!g.settings.colHeaders;for(var e=0,t=C.countCols();t>e;e++)if(C.getColHeader(e))return!0;return!1},this.getColHeader=function(e){if(void 0===e){for(var t=[],n=0,i=C.countCols();i>n;n++)t.push(C.getColHeader(n));return t}var r=e;return e=o.hooks.execute(C,"modifyCol",e),g.settings.columns&&g.settings.columns[e]&&g.settings.columns[e].title?g.settings.columns[e].title:"[object Array]"===Object.prototype.toString.call(g.settings.colHeaders)&&void 0!==g.settings.colHeaders[e]?g.settings.colHeaders[e]:"function"==typeof g.settings.colHeaders?g.settings.colHeaders(e):g.settings.colHeaders&&"string"!=typeof g.settings.colHeaders&&"number"!=typeof g.settings.colHeaders?o.helper.spreadsheetColumnLabel(r):g.settings.colHeaders},this._getColWidthFromSettings=function(e){var t=C.getCellMeta(0,e),o=t.width;if((void 0===o||o===g.settings.width)&&(o=t.colWidths),void 0!==o&&null!==o){switch(typeof o){case"object":o=o[e];break;case"function":o=o(e)}"string"==typeof o&&(o=parseInt(o,10))}return o},this.getColWidth=function(e){var t=C._getColWidthFromSettings(e);return t||(t=50),t=o.hooks.execute(C,"modifyColWidth",t,e)},this._getRowHeightFromSettings=function(e){var t=g.settings.rowHeights;if(void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=C._getRowHeightFromSettings(e),n=C.checkIfRowIsOversized(e);return t=o.hooks.execute(C,"modifyRowHeight",t,e),n&&(t=t?Math.max(t,n):n),t},this.checkIfRowIsOversized=function(e){return C.view.wt.wtTable.oversizedRows?C.view.wt.wtTable.oversizedRows[e]:void 0},this.countRows=function(){return g.settings.data.length},this.countCols=function(){return"object"===C.dataType||"function"===C.dataType?g.settings.columns&&g.settings.columns.length?g.settings.columns.length:m.colToPropCache.length:"array"===C.dataType?g.settings.columns&&g.settings.columns.length?g.settings.columns.length:g.settings.data&&g.settings.data[0]&&g.settings.data[0].length?g.settings.data[0].length:0:void 0},this.rowOffset=function(){return C.view.wt.getSetting("offsetRow")},this.colOffset=function(){return 0},this.countVisibleRows=function(){return C.view.wt.drawn?C.view.wt.wtTable.rowStrategy.countVisible():-1},this.countVisibleCols=function(){return C.view.wt.drawn?C.view.wt.wtTable.columnStrategy.countVisible():-1},this.countEmptyRows=function(e){for(var t,n=C.countRows()-1,i=0;n>=0;){if(t=o.hooks.execute(this,"modifyRow",n),C.isEmptyRow(t))i++;else if(e)break;n--}return i},this.countEmptyCols=function(e){if(C.countRows()<1)return 0;for(var t=C.countCols()-1,o=0;t>=0;){if(C.isEmptyCol(t))o++;else if(e)break;t--}return o},this.isEmptyRow=function(e){return g.settings.isEmptyRow.call(C,e)},this.isEmptyCol=function(e){return g.settings.isEmptyCol.call(C,e)},this.selectCell=function(e,t,o,n,i){if("number"!=typeof e||0>e||e>=C.countRows())return!1;if("number"!=typeof t||0>t||t>=C.countCols())return!1;if("undefined"!=typeof o){if("number"!=typeof o||0>o||o>=C.countRows())return!1;if("number"!=typeof n||0>n||n>=C.countCols())return!1}var r=new f(e,t);return g.selRange=new p(r,r,r),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),C.listen(),"undefined"==typeof o?v.setRangeEnd(g.selRange.from,i):v.setRangeEnd(new f(o,n),i),C.selection.finish(),!0},this.selectCellByProp=function(){return arguments[1]=m.propToCol(arguments[1]),"undefined"!=typeof arguments[3]&&(arguments[3]=m.propToCol(arguments[3])),C.selectCell.apply(C,arguments)},this.deselectCell=function(){v.deselect()},this.destroy=function(){C._clearTimeouts(),C.view&&C.view.wt.destroy(),C.rootElement.empty(),C.rootElement.removeData("handsontable"),C.rootElement.off(".handsontable"),e(t).off("."+C.guid),S.off("."+C.guid),R.off("."+C.guid),o.hooks.run(C,"afterDestroy"),o.hooks.destroy(C);for(var n in C)C.hasOwnProperty(n)&&("function"==typeof C[n]?"runHooks"!==n&&"runHooksAndReturn"!==n&&(C[n]=d):"guid"!==n&&(C[n]=null));g=null,m=null,w=null,v=null,y=null,C=null,b=null,S=null,R=null},this.getActiveEditor=function(){return y.getActiveEditor()},this.getInstance=function(){return C},this.addHook=function(e,t){o.hooks.add(e,t,C)},this.addHookOnce=function(e,t){o.hooks.once(e,t,C)},this.removeHook=function(e,t){o.hooks.remove(e,t,C)},this.runHooks=function(e,t,n,i,r,s,a){o.hooks.run(C,e,t,n,i,r,s,a)},this.runHooksAndReturn=function(e,t,n,i,r,s,a){return o.hooks.execute(C,e,t,n,i,r,s,a)},this.timeouts=[],this._registerTimeout=function(e){this.timeouts.push(e)},this._clearTimeouts=function(){for(var e=0,t=this.timeouts.length;t>e;e++)clearTimeout(this.timeouts[e])},this.version="0.11.4"};var P=function(){};if(P.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,colWidths:void 0,columns:void 0,cells:void 0,cell:[],minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"none",isEmptyRow:function(e){for(var t,o=0,n=this.countCols();n>o;o++)if(t=this.getDataAtCell(e,o),""!==t&&null!==t&&"undefined"!=typeof t)return!1;return!0},isEmptyCol:function(e){for(var t,o=0,n=this.countRows();n>o;o++)if(t=this.getDataAtCell(o,e),""!==t&&null!==t&&"undefined"!=typeof t)return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,type:"text",copyable:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,groups:void 0},o.DefaultSettings=P,e.fn.handsontable=function(e){var t,n,i,r,s,a=this.first(),l=a.data("handsontable");if("string"!=typeof e)return s=e||{},l?l.updateSettings(s):(l=new o.Core(a,s),a.data("handsontable",l),l.init()),a;if(i=[],arguments.length>1)for(t=1,n=arguments.length;n>t;t++)i.push(arguments[t]);if(l){if("undefined"==typeof l[e])throw new Error("Handsontable do not provide action: "+e);r=l[e].apply(l,i)}return r},function(e){function t(){function e(e){return null!==e&&!o(e)&&("string"==typeof e||"number"==typeof e)}function t(e){return null!==e&&("object"==typeof e||"function"==typeof e)}function o(e){return e!==e}var n={arrayMap:[],weakMap:new WeakMap};return{get:function(o){return e(o)?n.arrayMap[o]:t(o)?n.weakMap.get(o):void 0},set:function(o,i){if(e(o))n.arrayMap[o]=i;else{if(!t(o))throw new Error("Invalid key type");n.weakMap.set(o,i)}},"delete":function(o){e(o)?delete n.arrayMap[o]:t(o)&&n.weakMap["delete"](o)}}}e.MultiMap||(e.MultiMap=t)}(t),!t.Handsontable)var o={};o.Dom={},o.Dom.closest=function(e,t,o){for(;null!=e&&e!==o;){if(1===e.nodeType&&t.indexOf(e.nodeName)>-1)return e;e=e.parentNode}return null},o.Dom.isChildOf=function(e,t){for(var o=e.parentNode;null!=o;){if(o==t)return!0;o=o.parentNode}return!1},o.Dom.index=function(e){for(var t=0;e=e.previousSibling;)++t;return t},document.documentElement.classList?(o.Dom.hasClass=function(e,t){return e.classList.contains(t)},o.Dom.addClass=function(e,t){e.classList.add(t)},o.Dom.removeClass=function(e,t){e.classList.remove(t)}):(o.Dom.hasClass=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},o.Dom.addClass=function(e,t){""==e.className?e.className=t:this.hasClass(e,t)||(e.className+=" "+t)},o.Dom.removeClass=function(e,t){if(this.hasClass(e,t)){var o=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(o," ").trim()}}),o.Dom.removeTextNodes=function(e,t){if(3===e.nodeType)t.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var o=e.childNodes,n=o.length-1;n>=0;n--)this.removeTextNodes(o[n],e)},o.Dom.empty=function(e){for(var t;t=e.lastChild;)e.removeChild(t)},o.Dom.HTML_CHARACTERS=/(<(.*)>|&(.*);)/,o.Dom.fastInnerHTML=function(e,t){this.HTML_CHARACTERS.test(t)?e.innerHTML=t:this.fastInnerText(e,t)},o.Dom.fastInnerText=document.createTextNode("test").textContent?function(e,t){var o=e.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.textContent=t:(this.empty(e),e.appendChild(document.createTextNode(t)))}:function(e,t){var o=e.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.data=t:(this.empty(e),e.appendChild(document.createTextNode(t)))},o.Dom.isVisible=function(e){for(var t=e;t!==document.documentElement;){if(null===t)return!1;if(11===t.nodeType){if(t.host){if(t.host.impl)return o.Dom.isVisible(t.host.impl);if(t.host)return o.Dom.isVisible(t.host);throw new Error("Lost in Web Components world")}return!1}if("none"===t.style.display)return!1;t=t.parentNode}return!0},o.Dom.offset=function(e){if(this.hasCaptionProblem()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName){var o=e.getBoundingClientRect();return{top:o.top+(t.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),left:o.left+(t.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)}}for(var n=e.offsetLeft,i=e.offsetTop,r=e;(e=e.offsetParent)&&e!==document.body;)n+=e.offsetLeft,i+=e.offsetTop,r=e;return r&&"fixed"===r.style.position&&(n+=t.pageXOffset||document.documentElement.scrollLeft,i+=t.pageYOffset||document.documentElement.scrollTop),{left:n,top:i}},o.Dom.getWindowScrollTop=function(){var e=t.scrollY;return void 0==e&&(e=document.documentElement.scrollTop),e},o.Dom.getWindowScrollLeft=function(){var e=t.scrollX;return void 0==e&&(e=document.documentElement.scrollLeft),e},o.Dom.getScrollTop=function(e){return e===t?o.Dom.getWindowScrollTop(e):e.scrollTop},o.Dom.getScrollLeft=function(e){return e===t?o.Dom.getWindowScrollLeft(e):e.scrollLeft},o.Dom.getComputedStyle=function(e){return e.currentStyle||document.defaultView.getComputedStyle(e)},o.Dom.outerWidth=function(e){return e.offsetWidth},o.Dom.outerHeight=function(e){return this.hasCaptionProblem()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight},o.Dom.innerHeight=function(e){return e.clientHeight},o.Dom.innerWidth=function(e){return e.innerWidth},function(){function e(){var e=document.createElement("TABLE");e.style.borderSpacing=0,e.style.borderWidth=0,e.style.padding=0;var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var o=document.createElement("CAPTION");o.innerHTML="c<br>c<br>c<br>c",o.style.padding=0,o.style.margin=0,e.insertBefore(o,t),document.body.appendChild(e),n=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function t(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),(document.body||document.documentElement).appendChild(t);var o=e.offsetWidth;t.style.overflow="scroll";var n=e.offsetWidth;return o==n&&(n=t.clientWidth),(document.body||document.documentElement).removeChild(t),o-n}var n;o.Dom.hasCaptionProblem=function(){return void 0===n&&e(),n},o.Dom.getCaretPosition=function(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var o=e.createTextRange(),n=o.duplicate();return o.moveToBookmark(t.getBookmark()),n.setEndPoint("EndToStart",o),n.text.length}return 0},o.Dom.getSelectionEndPosition=function(e){if(e.selectionEnd)return e.selectionEnd;if(document.selection){var t=document.selection.createRange();if(null==t)return 0;var o=e.createTextRange();return o.text.indexOf(t.text)+t.text.length}},o.Dom.setCaretPosition=function(e,t,o){if(void 0===o&&(o=t),e.setSelectionRange)e.focus(),e.setSelectionRange(t,o);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",o),n.moveStart("character",t),n.select()}};var i;o.Dom.getScrollbarWidth=function(){return void 0===i&&(i=t()),i}}(),o.TableView=function(n){var i=this,r=e(document.documentElement);this.instance=n,this.settings=n.getSettings(),n.rootElement.data("originalStyle",n.rootElement[0].getAttribute("style")),n.rootElement.addClass("handsontable");var s=document.createElement("TABLE");s.className="htCore",this.THEAD=document.createElement("THEAD"),s.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),s.appendChild(this.TBODY),n.$table=e(s),n.container.prepend(n.$table),n.rootElement.on("mousedown.handsontable",function(e){i.isTextSelectionAllowed(e.target)||(l(),e.preventDefault(),t.focus())}),r.on("keyup."+n.guid,function(e){n.selection.isInProgress()&&!e.shiftKey&&n.selection.finish()});var a;this.isMouseDown=function(){return a},r.on("mouseup."+n.guid,function(e){n.selection.isInProgress()&&1===e.which&&n.selection.finish(),a=!1,o.helper.isOutsideInput(document.activeElement)&&n.unlisten()}),r.on("mousedown."+n.guid,function(e){var t=e.target;if(!a){if(t!==i.wt.wtTable.spreader)for(;t!==document.documentElement;){if(null===t)return;if(t===n.rootElement[0])return;t=t.parentNode}i.settings.outsideClickDeselects?n.deselectCell():n.destroyEditor()}}),n.$table.on("selectstart",function(e){i.settings.fragmentSelection||e.preventDefault()});var l=function(){t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():document.selection&&document.selection.empty()},c=[new x({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return i.settings.fillHandle&&!i.isCellEdited()&&!n.selection.isMultiple()}}}),new x({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return i.settings.fillHandle&&!i.isCellEdited()&&n.selection.isMultiple()}}}),new x({className:"highlight",highlightRowClassName:i.settings.currentRowClassName,highlightColumnClassName:i.settings.currentColClassName}),new x({className:"fill",border:{width:1,color:"red"}})];c.current=c[0],c.area=c[1],c.highlight=c[2],c.fill=c[3];var u={debug:function(){return i.settings.debug},table:s,stretchH:this.settings.stretchH,data:n.getDataAtCell,totalRows:n.countRows,totalColumns:n.countCols,offsetRow:0,fixedColumnsLeft:function(){return i.settings.fixedColumnsLeft},fixedRowsTop:function(){return i.settings.fixedRowsTop},renderAllRows:i.settings.renderAllRows,rowHeaders:function(){var e=[];return n.hasRowHeaders()&&e.push(function(e,t){i.appendRowHeader(e,t)}),o.hooks.run(n,"afterGetRowHeaderRenderers",e),e},columnHeaders:function(){var e=[];return n.hasColHeaders()&&e.push(function(e,t){i.appendColHeader(e,t)}),o.hooks.run(n,"afterGetColumnHeaderRenderers",e),e},columnWidth:n.getColWidth,rowHeight:n.getRowHeight,cellRenderer:function(e,t,n){var r=i.instance.colToProp(t),s=i.instance.getCellMeta(e,t),a=i.instance.getCellRenderer(s),l=i.instance.getDataAtRowProp(e,r);a(i.instance,n,e,t,r,l,s),o.hooks.run(i.instance,"afterRenderer",n,e,t,r,l,s)},selections:c,hideBorderOnMouseDownOver:function(){return i.settings.fragmentSelection},onCellMouseDown:function(e,t,r,s){n.listen(),i.activeWt=s,a=!0,o.hooks.run(n,"beforeOnCellMouseDown",e,t,r),e.isImmediatePropagationStopped()||(2===e.button&&n.selection.inInSelection(t)||(e.shiftKey?t.row>=0&&t.col>=0&&n.selection.setRangeEnd(t):t.row<0||t.col<0?(t.row<0&&(n.selectCell(0,t.col,n.countRows()-1,t.col),n.selection.setSelectedHeaders(!1,!0)),t.col<0&&(n.selectCell(t.row,0,t.row,n.countCols()-1),n.selection.setSelectedHeaders(!0,!1))):n.selection.setRangeStart(t)),o.hooks.run(n,"afterOnCellMouseDown",e,t,r),i.activeWt=i.wt)},onCellMouseOver:function(e,t,r,s){i.activeWt=s,t.row>=0&&t.col>=0?a&&n.selection.setRangeEnd(t):a&&(t.row<0&&(n.selection.setRangeEnd(new f(n.countRows()-1,t.col)),n.selection.setSelectedHeaders(!1,!0)),t.col<0&&(n.selection.setRangeEnd(new f(t.row,n.countCols()-1)),n.selection.setSelectedHeaders(!0,!1))),o.hooks.run(n,"afterOnCellMouseOver",e,t,r),i.activeWt=i.wt},onCellCornerMouseDown:function(e){e.preventDefault(),o.hooks.run(n,"afterOnCellCornerMouseDown",e)},beforeDraw:function(e){i.beforeRender(e)},onDraw:function(e){i.onDraw(e)},onScrollVertically:function(){n.runHooks("afterScrollVertically")},onScrollHorizontally:function(){n.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(e,t){n.runHooks("beforeDrawBorders",e,t)}};o.hooks.run(n,"beforeInitWalkontable",u),this.wt=new w(u),this.activeWt=this.wt,e(i.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(e){e.target===i.wt.wtTable.spreader&&3===e.which&&e.stopPropagation()}),r.on("click."+n.guid,function(){i.settings.observeDOMVisibility&&i.wt.drawInterrupted&&(i.instance.forceFullRender=!0,i.render())})},o.TableView.prototype.isTextSelectionAllowed=function(e){return o.helper.isInput(e)?!0:this.settings.fragmentSelection&&o.Dom.isChildOf(e,this.TBODY)?!0:!1},o.TableView.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()},o.TableView.prototype.beforeRender=function(e){e&&o.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender)},o.TableView.prototype.onDraw=function(e){e&&o.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)},o.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.rootElement.triggerHandler("render.handsontable")},o.TableView.prototype.getCellAtCoords=function(e){var t=this.wt.wtTable.getCell(e);return 0>t?null:t},o.TableView.prototype.scrollViewport=function(e){this.wt.scrollViewport(e)},o.TableView.prototype.appendRowHeader=function(e,t){var n=document.createElement("DIV"),i=document.createElement("SPAN");n.className="relative",i.className="rowHeader",e>-1?o.Dom.fastInnerHTML(i,this.instance.getRowHeader(e)):o.Dom.fastInnerText(i," "),n.appendChild(i),o.Dom.empty(t),t.appendChild(n),o.hooks.run(this.instance,"afterGetRowHeader",e,t)},o.TableView.prototype.appendColHeader=function(e,t){var n=document.createElement("DIV"),i=document.createElement("SPAN");n.className="relative",i.className="colHeader",e>-1?o.Dom.fastInnerHTML(i,this.instance.getColHeader(e)):o.Dom.fastInnerText(i," "),n.appendChild(i),o.Dom.empty(t),t.appendChild(n),o.hooks.run(this.instance,"afterGetColHeader",e,t)},o.TableView.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth(),o=t-e;return o>0?o:0},o.TableView.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight(),o=t-e;return o>0?o:0},o.TableView.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},function(e){function t(e){var t,o;o={},t=e,this.getInstance=function(e){return e.guid in o||(o[e.guid]=new t(e)),o[e.guid]}}var o={},n=new WeakMap;e.editors={registerEditor:function(e,i){var r=new t(i);"string"==typeof e&&(o[e]=r),n.set(i,r)},getEditor:function(e,t){var i;if("function"==typeof e)n.get(e)||this.registerEditor(null,e),i=n.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter ');i=o[e]}if(!i)throw Error('No editor registered under name "'+e+'"');return i.getInstance(t)}}}(o),function(t){t.EditorManager=function(o,n,i){var r,s=this,a=e(document),l=t.helper.keyCode,c=!1,u=function(){function e(e){if(o.isListening()&&(t.hooks.run(o,"beforeKeyDown",e),!c&&!e.isImmediatePropagationStopped()&&(n.lastKeyCode=e.keyCode,i.isSelected()))){var a=(e.ctrlKey||e.metaKey)&&!e.altKey;if(!(r.isWaiting()||t.helper.isMetaKey(e.keyCode)||a||s.isEditorOpened()))return void s.openEditor("");var u=e.shiftKey?i.setRangeEnd:i.setRangeStart;switch(e.keyCode){case l.A:a&&(i.selectAll(),e.preventDefault(),e.stopPropagation());break;case l.ARROW_UP:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(a),d(e.shiftKey),e.preventDefault(),e.stopPropagation();break;case l.ARROW_DOWN:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(a),p(e.shiftKey),e.preventDefault(),e.stopPropagation();break;case l.ARROW_RIGHT:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(a),g(e.shiftKey),e.preventDefault(),e.stopPropagation();break;case l.ARROW_LEFT:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(a),m(e.shiftKey),e.preventDefault(),e.stopPropagation();break;case l.TAB:var w="function"==typeof n.settings.tabMoves?n.settings.tabMoves(e):n.settings.tabMoves;e.shiftKey?i.transformStart(-w.row,-w.col):i.transformStart(w.row,w.col,!0),e.preventDefault(),e.stopPropagation();break;case l.BACKSPACE:case l.DELETE:i.empty(e),s.prepareEditor(),e.preventDefault();break;case l.F2:s.openEditor(),e.preventDefault();break;case l.ENTER:s.isEditorOpened()?(r.state!==t.EditorState.WAITING&&s.closeEditorAndSaveChanges(a),h(e.shiftKey)):o.getSettings().enterBeginsEditing?s.openEditor():h(e.shiftKey),e.preventDefault(),e.stopImmediatePropagation();break;case l.ESCAPE:s.isEditorOpened()&&s.closeEditorAndRestoreOriginalValue(a),e.preventDefault();break;case l.HOME:u(e.ctrlKey||e.metaKey?new f(0,n.selRange.from.col):new f(n.selRange.from.row,0)),e.preventDefault(),e.stopPropagation();break;case l.END:u(e.ctrlKey||e.metaKey?new f(o.countRows()-1,n.selRange.from.col):new f(n.selRange.from.row,o.countCols()-1)),e.preventDefault(),e.stopPropagation();break;case l.PAGE_UP:i.transformStart(-o.countVisibleRows(),0),o.view.wt.scrollVertical(-o.countVisibleRows()),o.view.render(),e.preventDefault(),e.stopPropagation();break;case l.PAGE_DOWN:i.transformStart(o.countVisibleRows(),0),o.view.wt.scrollVertical(o.countVisibleRows()),o.view.render(),e.preventDefault(),e.stopPropagation()}}}function u(e,t,o){"TD"==o.nodeName&&s.openEditor()}function h(e){var t="function"==typeof n.settings.enterMoves?n.settings.enterMoves(event):n.settings.enterMoves;e?i.transformStart(-t.row,-t.col):i.transformStart(t.row,t.col,!0)}function d(e){e?i.transformEnd(-1,0):i.transformStart(-1,0)}function p(e){e?i.transformEnd(1,0):i.transformStart(1,0)}function g(e){e?i.transformEnd(0,1):i.transformStart(0,1)}function m(e){e?i.transformEnd(0,-1):i.transformStart(0,-1)}o.addHook("afterDocumentKeyDown",function(t){e(t)}),a.on("keydown."+o.guid,function(e){o.runHooks("afterDocumentKeyDown",e)}),o.view.wt.update("onCellDblClick",u),o.addHook("afterDestroy",function(){c=!0})};this.destroyEditor=function(e){this.closeEditor(e)},this.getActiveEditor=function(){return r},this.prepareEditor=function(){if(r&&r.isWaiting())return void this.closeEditor(!1,!1,function(e){e&&s.prepareEditor()});var e=n.selRange.highlight.row,i=n.selRange.highlight.col,a=o.colToProp(i),l=o.getCell(e,i),c=o.getDataAtCell(e,i),u=o.getCellMeta(e,i),h=o.getCellEditor(u);r=t.editors.getEditor(h,o),r.prepare(e,i,a,l,c,u)},this.isEditorOpened=function(){return r.isOpened()},this.openEditor=function(e){r.cellProperties.readOnly||r.beginEditing(e)},this.closeEditor=function(e,t,o){r?r.finishEditing(e,t,o):o&&o(!1)},this.closeEditorAndSaveChanges=function(e){return this.closeEditor(!1,e)},this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(!0,e)},u()}}(o),function(e){var t={};e.renderers={registerRenderer:function(e,o){t[e]=o},getRenderer:function(e){if("function"==typeof e)return e;if("string"!=typeof e)throw Error('Only strings and functions can be passed as "renderer" parameter ');if(!(e in t))throw Error('No editor registered under name "'+e+'"');return t[e]}}}(o),o.helper.isPrintableChar=function(e){return 32==e||e>=48&&57>=e||e>=96&&111>=e||e>=186&&192>=e||e>=219&&222>=e||e>=226||e>=65&&90>=e},o.helper.isMetaKey=function(e){var t=o.helper.keyCode,n=[t.ARROW_DOWN,t.ARROW_UP,t.ARROW_LEFT,t.ARROW_RIGHT,t.HOME,t.END,t.DELETE,t.BACKSPACE,t.F1,t.F2,t.F3,t.F4,t.F5,t.F6,t.F7,t.F8,t.F9,t.F10,t.F11,t.F12,t.TAB,t.PAGE_DOWN,t.PAGE_UP,t.ENTER,t.ESCAPE,t.SHIFT,t.CAPS_LOCK,t.ALT];return-1!=n.indexOf(e)},o.helper.isCtrlKey=function(e){var t=o.helper.keyCode;return-1!=[t.CONTROL_LEFT,224,t.COMMAND_LEFT,t.COMMAND_RIGHT].indexOf(e)},o.helper.stringify=function(e){switch(typeof e){case"string":case"number":return e+"";case"object":return null===e?"":e.toString();case"undefined":return"";default:return e.toString()}},o.helper.spreadsheetColumnLabel=function(e){for(var t,o=e+1,n="";o>0;)t=(o-1)%26,n=String.fromCharCode(65+t)+n,o=parseInt((o-t)/26,10);return n},o.helper.isNumeric=function(e){var t=typeof e;return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?e.length?1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e):!1:"object"==t?!(!e||"number"!=typeof e.valueOf()||e instanceof Date):!1},o.helper.isDescendant=function(e,t){for(var o=t.parentNode;null!=o;){if(o==e)return!0;o=o.parentNode}return!1},o.helper.randomString=function(){return C()},o.helper.inherit=function(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e},o.helper.extend=function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},o.helper.getPrototypeOf=function(e){var t;if("object"==typeof e.__proto__)t=e.__proto__;else{var o,n=e.constructor;"function"==typeof e.constructor&&(o=n,delete e.constructor&&(n=e.constructor,e.constructor=o)),t=n?n.prototype:null}return t},o.helper.columnFactory=function(e,t){function n(){}o.helper.inherit(n,e);for(var i=0,r=t.length;r>i;i++)n.prototype[t[i]]=void 0;return n},o.helper.translateRowsToColumns=function(e){var t,o,n,i,r=[],s=0;
for(t=0,o=e.length;o>t;t++)for(n=0,i=e[t].length;i>n;n++)n==s&&(r.push([]),s++),r[n].push(e[t][n]);return r},o.helper.to2dArray=function(e){for(var t=0,o=e.length;o>t;)e[t]=[e[t]],t++},o.helper.extendArray=function(e,t){for(var o=0,n=t.length;n>o;)e.push(t[o]),o++},o.helper.isInput=function(e){var t=["INPUT","SELECT","TEXTAREA"];return t.indexOf(e.nodeName)>-1},o.helper.isOutsideInput=function(e){return o.helper.isInput(e)&&-1==e.className.indexOf("handsontableInput")},o.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86},o.helper.isObject=function(e){return"[object Object]"==Object.prototype.toString.call(e)},o.helper.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"==Object.prototype.toString.call(e)},o.helper.pivot=function(e){var t=[];if(!e||0==e.length||!e[0]||0==e[0].length)return t;for(var o=e.length,n=e[0].length,i=0;o>i;i++)for(var r=0;n>r;r++)t[r]||(t[r]=[]),t[r][i]=e[i][r];return t},o.helper.proxy=function(e,t){return function(){return e.apply(t,arguments)}},o.helper.cellMethodLookupFactory=function(e,t){function n(e){var t=o.cellTypes[e];if("undefined"==typeof t)throw new Error('You declared cell type "'+e+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return t}return t="undefined"==typeof t?!0:t,function(i,r){return function s(i){if(i){if(i.hasOwnProperty(e)&&void 0!==i[e])return i[e];if(i.hasOwnProperty("type")&&i.type){var r;if("string"!=typeof i.type)throw new Error("Cell type must be a string ");if(r=n(i.type),r.hasOwnProperty(e))return r[e];if(t)return}return s(o.helper.getPrototypeOf(i))}}("number"==typeof i?this.getCellMeta(i,r):i)}},o.helper.toString=function(e){return""+e},function(t){t.DataMap=function(e,t,o){this.instance=e,this.priv=t,this.GridSettings=o,this.dataSource=this.instance.getSettings().data,this.duckSchema=this.dataSource[0]?this.recursiveDuckSchema(this.dataSource[0]):{},this.createMap()},t.DataMap.prototype.DESTINATION_RENDERER=1,t.DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,t.DataMap.prototype.recursiveDuckSchema=function(t){var o;if(e.isPlainObject(t)){o={};for(var n in t)t.hasOwnProperty(n)&&(o[n]=e.isPlainObject(t[n])?this.recursiveDuckSchema(t[n]):null)}else o=[];return o},t.DataMap.prototype.recursiveDuckColumns=function(t,o,n){var i,r;if("undefined"==typeof o&&(o=0,n=""),e.isPlainObject(t))for(r in t)t.hasOwnProperty(r)&&(null===t[r]?(i=n+r,this.colToPropCache.push(i),this.propToColCache.set(i,o),o++):o=this.recursiveDuckColumns(t[r],o,r+"."));return o},t.DataMap.prototype.createMap=function(){if("undefined"==typeof this.getSchema())throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");var e,t,o=this.getSchema();this.colToPropCache=[],this.propToColCache=new MultiMap;var n=this.instance.getSettings().columns;if(n)for(e=0,t=n.length;t>e;e++)"undefined"!=typeof n[e].data&&(this.colToPropCache[e]=n[e].data,this.propToColCache.set(n[e].data,e));else this.recursiveDuckColumns(o)},t.DataMap.prototype.colToProp=function(e){return e=t.hooks.execute(this.instance,"modifyCol",e),this.colToPropCache&&"undefined"!=typeof this.colToPropCache[e]?this.colToPropCache[e]:e},t.DataMap.prototype.propToCol=function(e){var o;return o="undefined"!=typeof this.propToColCache.get(e)?this.propToColCache.get(e):e,o=t.hooks.execute(this.instance,"modifyCol",o)},t.DataMap.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;return e?"function"==typeof e?e():e:this.duckSchema},t.DataMap.prototype.createRow=function(o,n,i){var r,s,a=this.instance.countCols(),l=0;n||(n=1),("number"!=typeof o||o>=this.instance.countRows())&&(o=this.instance.countRows()),s=o;for(var c=this.instance.getSettings().maxRows;n>l&&this.instance.countRows()<c;){if("array"===this.instance.dataType){r=[];for(var u=0;a>u;u++)r.push(null)}else r="function"===this.instance.dataType?this.instance.getSettings().dataSchema(o):e.extend(!0,{},this.getSchema());o===this.instance.countRows()?this.dataSource.push(r):this.dataSource.splice(o,0,r),l++,s++}return t.hooks.run(this.instance,"afterCreateRow",o,l,i),this.instance.forceFullRender=!0,l},t.DataMap.prototype.createCol=function(e,o,n){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var i,r,s=this.instance.countRows(),a=this.dataSource,l=0;o||(o=1),r=e;for(var c=this.instance.getSettings().maxCols;o>l&&this.instance.countCols()<c;){if(i=t.helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof e||e>=this.instance.countCols()){for(var u=0;s>u;u++)"undefined"==typeof a[u]&&(a[u]=[]),a[u].push(null);this.priv.columnSettings.push(i)}else{for(var u=0;s>u;u++)a[u].splice(r,0,null);this.priv.columnSettings.splice(r,0,i)}l++,r++}return t.hooks.run(this.instance,"afterCreateCol",e,l,n),this.instance.forceFullRender=!0,l},t.DataMap.prototype.removeRow=function(e,o){o||(o=1),"number"!=typeof e&&(e=-o),e=(this.instance.countRows()+e)%this.instance.countRows();var n=this.physicalRowsToLogical(e,o),i=t.hooks.execute(this.instance,"beforeRemoveRow",e,o);if(i!==!1){var r=this.dataSource,s=r.filter(function(e,t){return-1==n.indexOf(t)});r.length=0,Array.prototype.push.apply(r,s),t.hooks.run(this.instance,"afterRemoveRow",e,o),this.instance.forceFullRender=!0}},t.DataMap.prototype.removeCol=function(e,o){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");o||(o=1),"number"!=typeof e&&(e=-o),e=(this.instance.countCols()+e)%this.instance.countCols();var n=t.hooks.execute(this.instance,"beforeRemoveCol",e,o);if(n!==!1){for(var i=this.dataSource,r=0,s=this.instance.countRows();s>r;r++)i[r].splice(e,o);this.priv.columnSettings.splice(e,o),t.hooks.run(this.instance,"afterRemoveCol",e,o),this.instance.forceFullRender=!0}},t.DataMap.prototype.spliceCol=function(e,o,n){var i=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getDataAtCol(e),s=r.slice(o,o+n),a=r.slice(o+n);t.helper.extendArray(i,a);for(var l=0;n>l;)i.push(null),l++;return t.helper.to2dArray(i),this.instance.populateFromArray(o,e,i,null,null,"spliceCol"),s},t.DataMap.prototype.spliceRow=function(e,o,n){var i=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getSourceDataAtRow(e),s=r.slice(o,o+n),a=r.slice(o+n);t.helper.extendArray(i,a);for(var l=0;n>l;)i.push(null),l++;return this.instance.populateFromArray(e,o,[i],null,null,"spliceRow"),s},t.DataMap.prototype.get=function(e,o){if(e=t.hooks.execute(this.instance,"modifyRow",e),"string"==typeof o&&o.indexOf(".")>-1){var n=o.split("."),i=this.dataSource[e];if(!i)return null;for(var r=0,s=n.length;s>r;r++)if(i=i[n[r]],"undefined"==typeof i)return null;return i}return"function"==typeof o?o(this.dataSource.slice(e,e+1)[0]):this.dataSource[e]?this.dataSource[e][o]:null};var o=t.helper.cellMethodLookupFactory("copyable",!1);t.DataMap.prototype.getCopyable=function(e,t){return o.call(this.instance,e,this.propToCol(t))?this.get(e,t):""},t.DataMap.prototype.set=function(e,o,n,i){if(e=t.hooks.execute(this.instance,"modifyRow",e,i||"datamapGet"),"string"==typeof o&&o.indexOf(".")>-1){for(var r=o.split("."),s=this.dataSource[e],a=0,l=r.length-1;l>a;a++)"undefined"==typeof s[r[a]]&&(s[r[a]]={}),s=s[r[a]];s[r[a]]=n}else"function"==typeof o?o(this.dataSource.slice(e,e+1)[0],n):this.dataSource[e][o]=n},t.DataMap.prototype.physicalRowsToLogical=function(e,o){for(var n,i=this.instance.countRows(),r=(i+e)%i,s=[],a=o;i>r&&a;)n=t.hooks.execute(this.instance,"modifyRow",r),s.push(n),a--,r++;return s},t.DataMap.prototype.clear=function(){for(var e=0;e<this.instance.countRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")},t.DataMap.prototype.getAll=function(){return this.dataSource},t.DataMap.prototype.getRange=function(e,t,o){var n,i,r,s,a,l=[],c=o===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(i=Math.max(e.row,t.row),s=Math.max(e.col,t.col),n=Math.min(e.row,t.row);i>=n;n++){for(a=[],r=Math.min(e.col,t.col);s>=r;r++)a.push(c.call(this,n,this.colToProp(r)));l.push(a)}return l},t.DataMap.prototype.getText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))},t.DataMap.prototype.getCopyableText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))}}(o),function(e){e.renderers.cellDecorator=function(t,o,n,i,r,s,a){a.className&&(o.className=o.className?o.className+" "+a.className:a.className),a.readOnly&&e.Dom.addClass(o,a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName&&e.Dom.addClass(o,a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&e.Dom.addClass(o,a.noWordWrapClassName),!s&&a.placeholder&&e.Dom.addClass(o,a.placeholderCellClassName)}}(o),function(e){var t=function(t,o,n,i,r,s,a){e.renderers.cellDecorator.apply(this,arguments),!s&&a.placeholder&&(s=a.placeholder);var l=e.helper.stringify(s);if(a.rendererTemplate){e.Dom.empty(o);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=t.getSourceDataAtRow(n),o.appendChild(c)}else e.Dom.fastInnerText(o,l)};e.renderers.TextRenderer=t,e.renderers.registerRenderer("text",t)}(o),function(e){var t=document.createElement("DIV");t.className="htAutocompleteWrapper";var o=document.createElement("DIV");o.className="htAutocompleteArrow",o.appendChild(document.createTextNode("▼"));var n=function(n,i,r,s,a,l,c){var u=(t.cloneNode(!0),o.cloneNode(!0));e.renderers.TextRenderer(n,i,r,s,a,l,c),i.appendChild(u),e.Dom.addClass(i,"htAutocomplete"),i.firstChild||i.appendChild(document.createTextNode(" ")),n.acArrowListener||(n.acArrowListener=function(){n.view.wt.getSetting("onCellDblClick",null,new f(r,s),i)},n.rootElement.on("mousedown.htAutocompleteArrow",".htAutocompleteArrow",n.acArrowListener),n.addHookOnce("afterDestroy",function(){this.rootElement.off("mousedown.htAutocompleteArrow")}))};e.AutocompleteRenderer=n,e.renderers.AutocompleteRenderer=n,e.renderers.registerRenderer("autocomplete",n)}(o),function(t){var o=document.createElement("INPUT");o.className="htCheckboxRendererInput",o.type="checkbox",o.setAttribute("autocomplete","off");var n=function(n,i,r,s,a,l,c){"undefined"==typeof c.checkedTemplate&&(c.checkedTemplate=!0),"undefined"==typeof c.uncheckedTemplate&&(c.uncheckedTemplate=!1),t.Dom.empty(i);var u=o.cloneNode(!1);l===c.checkedTemplate||l===t.helper.stringify(c.checkedTemplate)?(u.checked=!0,i.appendChild(u)):l===c.uncheckedTemplate||l===t.helper.stringify(c.uncheckedTemplate)?i.appendChild(u):null===l?(u.className+=" noValue",i.appendChild(u)):t.Dom.fastInnerText(i,"#bad value#");var h=e(u);c.readOnly?h.on("click",function(e){e.preventDefault()}):(h.on("mousedown",function(e){e.stopPropagation()}),h.on("mouseup",function(e){e.stopPropagation()}),h.on("change",function(){this.checked?n.setDataAtRowProp(r,a,c.checkedTemplate):n.setDataAtRowProp(r,a,c.uncheckedTemplate)})),n.CheckboxRenderer&&n.CheckboxRenderer.beforeKeyDownHookBound||(n.CheckboxRenderer={beforeKeyDownHookBound:!0},n.addHook("beforeKeyDown",function(o){if(o.keyCode==t.helper.keyCode.SPACE)for(var i,r,s,a=n.getSelectedRange(),l=a.getTopLeftCorner(),c=a.getBottomRightCorner(),u=l.row;u<=c.row;u++)for(var h=l.col;h<=c.col;h++)if(i=n.getCell(u,h),s=n.getCellMeta(u,h),r=i.querySelectorAll("input[type=checkbox]"),r.length>0&&!s.readOnly){o.isImmediatePropagationStopped()||(o.stopImmediatePropagation(),o.preventDefault());for(var d=0,f=r.length;f>d;d++)r[d].checked=!r[d].checked,e(r[d]).trigger("change")}}))};t.CheckboxRenderer=n,t.renderers.CheckboxRenderer=n,t.renderers.registerRenderer("checkbox",n)}(o),function(e){var t=function(t,o,n,i,r,s,a){e.helper.isNumeric(s)&&("undefined"!=typeof a.language&&numeral.language(a.language),s=numeral(s).format(a.format||"0"),e.Dom.addClass(o,"htNumeric")),e.renderers.TextRenderer(t,o,n,i,r,s,a)};e.NumericRenderer=t,e.renderers.NumericRenderer=t,e.renderers.registerRenderer("numeric",t)}(o),function(e){var t=function(e,t,n,i,r,s,a){o.renderers.TextRenderer.apply(this,arguments),s=t.innerHTML;var l,c=a.hashLength||s.length,u=a.hashSymbol||"*";for(l="";l.split(u).length-1<c;l+=u);o.Dom.fastInnerHTML(t,l)};e.PasswordRenderer=t,e.renderers.PasswordRenderer=t,e.renderers.registerRenderer("password",t)}(o),function(e){function t(t,o,n,i,r,s){e.renderers.cellDecorator.apply(this,arguments),e.Dom.fastInnerHTML(o,s)}e.renderers.registerRenderer("html",t),e.renderers.HtmlRenderer=t}(o),function(e){function t(t){this.instance=t,this.state=e.EditorState.VIRGIN,this._opened=!1,this._closeCallback=null,this.init()}e.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},t.prototype._fireCallbacks=function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)},t.prototype.init=function(){},t.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},t.prototype.setValue=function(){throw Error("Editor setValue() method unimplemented")},t.prototype.open=function(){throw Error("Editor open() method unimplemented")},t.prototype.close=function(){throw Error("Editor close() method unimplemented")},t.prototype.prepare=function(t,o,n,i,r,s){this.TD=i,this.row=t,this.col=o,this.prop=n,this.originalValue=r,this.cellProperties=s,this.state=e.EditorState.VIRGIN},t.prototype.extend=function(){function e(){o.apply(this,arguments)}function t(e,t){function o(){}return o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e,e}var o=this.constructor;return t(e,o)},t.prototype.saveValue=function(e,t){if(t){var o,n=this.instance.getSelected();n[0]>n[2]&&(o=n[0],n[0]=n[2],n[2]=o),n[1]>n[3]&&(o=n[1],n[1]=n[3],n[3]=o),this.instance.populateFromArray(n[0],n[1],e,n[2],n[3],"edit")}else this.instance.populateFromArray(this.row,this.col,e,null,null,"edit")},t.prototype.beginEditing=function(t){this.state==e.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new f(this.row,this.col)),this.instance.view.render(),this.state=e.EditorState.EDITING,t="string"==typeof t?t:this.originalValue,this.setValue(e.helper.stringify(t)),this.open(),this._opened=!0,this.focus(),this.instance.view.render())},t.prototype.finishEditing=function(t,o,n){if(n){var i=this._closeCallback;this._closeCallback=function(e){i&&i(e),n(e)}}if(!this.isWaiting()){if(this.state==e.EditorState.VIRGIN){var r=this;return void this.instance._registerTimeout(setTimeout(function(){r._fireCallbacks(!0)},0))}if(this.state==e.EditorState.EDITING){if(t)return void this.cancelChanges();var s=[[String.prototype.trim.call(this.getValue())]];if(this.state=e.EditorState.WAITING,this.saveValue(s,o),this.instance.getCellValidator(this.cellProperties)){var r=this;this.instance.addHookOnce("afterValidate",function(t){r.state=e.EditorState.FINISHED,r.discardEditor(t)})}else this.state=e.EditorState.FINISHED,this.discardEditor(!0)}}},t.prototype.cancelChanges=function(){this.state=e.EditorState.FINISHED,this.discardEditor()},t.prototype.discardEditor=function(t){this.state===e.EditorState.FINISHED&&(t===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=e.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=e.EditorState.VIRGIN,this._fireCallbacks(!0)))},t.prototype.isOpened=function(){return this._opened},t.prototype.isWaiting=function(){return this.state===e.EditorState.WAITING},e.editors.BaseEditor=t}(o),function(t){var o=t.editors.BaseEditor.prototype.extend();o.prototype.init=function(){this.createElements(),this.bindEvents(),this.autoResize=I()},o.prototype.getValue=function(){return this.TEXTAREA.value},o.prototype.setValue=function(e){this.TEXTAREA.value=e};var n=function(e){var o=this,n=o.getActiveEditor(),i=t.helper.keyCode,r=(e.ctrlKey||e.metaKey)&&!e.altKey;if(e.target===n.TEXTAREA&&!e.isImmediatePropagationStopped()){if(17===e.keyCode||224===e.keyCode||91===e.keyCode||93===e.keyCode)return void e.stopImmediatePropagation();switch(e.keyCode){case i.ARROW_RIGHT:t.Dom.getCaretPosition(n.TEXTAREA)!==n.TEXTAREA.value.length&&e.stopImmediatePropagation();break;case i.ARROW_LEFT:0!==t.Dom.getCaretPosition(n.TEXTAREA)&&e.stopImmediatePropagation();break;case i.ENTER:var s=n.instance.getSelected(),a=!(s[0]===s[2]&&s[1]===s[3]);(r&&!a||e.altKey)&&(n.isOpened()?(n.setValue(n.getValue()+"\n"),n.focus()):n.beginEditing(n.originalValue+"\n"),e.stopImmediatePropagation()),e.preventDefault();break;case i.A:case i.X:case i.C:case i.V:r&&e.stopImmediatePropagation();break;case i.BACKSPACE:case i.DELETE:case i.HOME:case i.END:e.stopImmediatePropagation()}}};o.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",n)},o.prototype.close=function(){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",n)},o.prototype.focus=function(){this.TEXTAREA.focus(),t.Dom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},o.prototype.createElements=function(){this.$body=e(document.body),this.TEXTAREA=document.createElement("TEXTAREA"),this.$textarea=e(this.TEXTAREA),t.Dom.addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),t.Dom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT);var o=this;this.instance._registerTimeout(setTimeout(function(){o.refreshDimensions()},0))},o.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0},o.prototype.getEditedCell=function(){var e,t=this.checkEditorSection();switch(t){case"top":e=this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"corner":e=this.instance.view.wt.wtScrollbars.corner.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":e=this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:e=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=e&&-2!=e?e:void 0},o.prototype.refreshDimensions=function(){if(this.state===t.EditorState.EDITING&&(this.TD=this.getEditedCell(),this.TD)){{var o=e(this.TD),n=t.Dom.offset(this.TD),i=t.Dom.offset(this.instance.rootElement[0]),r=n.top-i.top-1,s=n.left-i.left-1,a=this.instance.getSettings(),l=a.rowHeaders===!1?0:1,c=a.colHeaders===!1?0:1;this.checkEditorSection()}0>r&&(r=0),0>s&&(s=0),l>0&&parseInt(o.css("border-top-width"),10)>0&&(r+=1),c>0&&parseInt(o.css("border-left-width"),10)>0&&(s+=1),this.textareaParentStyle.top=r+"px",this.textareaParentStyle.left=s+"px";var u=this.TD.offsetTop-this.instance.view.wt.wtScrollbars.vertical.getScrollPosition(),h=this.TD.offsetLeft-this.instance.view.wt.wtScrollbars.horizontal.getScrollPosition(),d=o.width(),f=this.instance.view.maximumVisibleElementWidth(h)-10,p=o.outerHeight()-4,g=this.instance.view.maximumVisibleElementHeight(u)-2;parseInt(o.css("border-top-width"),10)>0&&(p-=1),parseInt(o.css("border-left-width"),10)>0&&l>0&&(d-=1),this.TEXTAREA.style.fontSize=t.Dom.getComputedStyle(this.TD).fontSize,this.TEXTAREA.style.fontFamily=t.Dom.getComputedStyle(this.TD).fontFamily,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(p,g),maxHeight:g,minWidth:Math.min(d,f),maxWidth:f}),this.textareaParentStyle.display="block"}},o.prototype.bindEvents=function(){var e=this;this.$textarea.on("cut.editor",function(e){e.stopPropagation()}),this.$textarea.on("paste.editor",function(e){e.stopPropagation()}),this.instance.addHook("afterScrollVertically",function(){e.refreshDimensions()})},t.editors.TextEditor=o,t.editors.registerEditor("text",t.editors.TextEditor)}(o),function(t){var o=t.editors.BaseEditor.prototype.extend();o.prototype.beginEditing=function(){var t=this.TD.querySelector('input[type="checkbox"]');t&&e(t).trigger("click")},o.prototype.finishEditing=function(){},o.prototype.init=function(){},o.prototype.open=function(){},o.prototype.close=function(){},o.prototype.getValue=function(){},o.prototype.setValue=function(){},o.prototype.focus=function(){},t.editors.CheckboxEditor=o,t.editors.registerEditor("checkbox",o)}(o),function(t){var o=t.editors.TextEditor.prototype.extend();o.prototype.init=function(){if(!e.datepicker)throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?");t.editors.TextEditor.prototype.init.apply(this,arguments),this.isCellEdited=!1;var o=this;this.instance.addHook("afterDestroy",function(){o.destroyElements()})},o.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments),this.datePicker=document.createElement("DIV"),t.Dom.addClass(this.datePicker,"htDatepickerHolder"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=99,document.body.appendChild(this.datePicker),this.$datePicker=e(this.datePicker);var o=this,n={dateFormat:"yy-mm-dd",showButtonPanel:!0,changeMonth:!0,changeYear:!0,onSelect:function(e){o.setValue(e),o.finishEditing(!1)}};this.$datePicker.datepicker(n),this.$datePicker.on("mousedown",function(e){e.stopPropagation()}),this.hideDatepicker()},o.prototype.destroyElements=function(){this.$datePicker.datepicker("destroy"),this.$datePicker.remove()},o.prototype.open=function(){t.editors.TextEditor.prototype.open.call(this),this.showDatepicker()},o.prototype.finishEditing=function(){this.hideDatepicker(),t.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},o.prototype.showDatepicker=function(){var t=e(this.TD),o=t.offset();this.datePickerStyle.top=o.top+t.height()+"px",this.datePickerStyle.left=o.left+"px";var n={defaultDate:this.originalValue||void 0};e.extend(n,this.cellProperties),this.$datePicker.datepicker("option",n),this.originalValue&&this.$datePicker.datepicker("setDate",this.originalValue),this.datePickerStyle.display="block"},o.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"},t.editors.DateEditor=o,t.editors.registerEditor("date",o)}(o),function(t){var o=t.editors.TextEditor.prototype.extend();o.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments);var o=document.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.$htContainer=e(o),this.$htContainer.handsontable()},o.prototype.prepare=function(o,n,i,r,s,a){t.editors.TextEditor.prototype.prepare.apply(this,arguments);var l=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var e=this.getValue();void 0!==e&&l.setValue(e),l.instance.destroyEditor()}};this.cellProperties.handsontable&&(c=e.extend(c,a.handsontable)),this.$htContainer.handsontable("destroy"),this.$htContainer.handsontable(c)};var n=function(e){if(!e.isImmediatePropagationStopped()){var o,n=this.getActiveEditor(),i=n.$htContainer.handsontable("getInstance");if(e.keyCode==t.helper.keyCode.ARROW_DOWN)if(i.getSelected()){var r=i.getSelected()[0],s=i.countRows()-1;o=Math.min(s,r+1)}else o=0;else if(e.keyCode==t.helper.keyCode.ARROW_UP&&i.getSelected()){var r=i.getSelected()[0];o=r-1}void 0!==o&&(0>o?i.deselectCell():i.selectCell(o,0),e.preventDefault(),e.stopImmediatePropagation(),n.instance.listen(),n.TEXTAREA.focus())}};o.prototype.open=function(){this.instance.addHook("beforeKeyDown",n),t.editors.TextEditor.prototype.open.apply(this,arguments),this.$htContainer.handsontable("render"),this.cellProperties.strict?(this.$htContainer.handsontable("selectCell",0,0),this.TEXTAREA.style.visibility="hidden"):(this.$htContainer.handsontable("deselectCell"),this.TEXTAREA.style.visibility="visible"),t.Dom.setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length)},o.prototype.close=function(){this.instance.removeHook("beforeKeyDown",n),this.instance.listen(),t.editors.TextEditor.prototype.close.apply(this,arguments)},o.prototype.focus=function(){this.instance.listen(),t.editors.TextEditor.prototype.focus.apply(this,arguments)},o.prototype.beginEditing=function(){var e=this.instance.getSettings().onBeginEditing;e&&e()===!1||t.editors.TextEditor.prototype.beginEditing.apply(this,arguments)},o.prototype.finishEditing=function(){if(this.$htContainer.handsontable("isListening")&&this.instance.listen(),this.$htContainer.handsontable("getSelected")){var e=this.$htContainer.handsontable("getInstance").getValue();void 0!==e&&this.setValue(e)}return t.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},t.editors.HandsontableEditor=o,t.editors.registerEditor("handsontable",o)}(o),function(e){var o=e.editors.HandsontableEditor.prototype.extend();o.prototype.init=function(){e.editors.HandsontableEditor.prototype.init.apply(this,arguments);var t=this.$htContainer.handsontable("getInstance");t.updateSettings({height:1}),this.query=null,this.choices=[]},o.prototype.createElements=function(){e.editors.HandsontableEditor.prototype.createElements.apply(this,arguments);var o=function(){return-1!=t.navigator.platform.indexOf("Mac")?"htMacScroll":""};this.$htContainer.addClass("autocompleteEditor"),this.$htContainer.addClass(o())};var n=!1,i=function(t){n=!1;var o=this.getActiveEditor(),i=e.helper.keyCode;(e.helper.isPrintableChar(t.keyCode)||t.keyCode===i.BACKSPACE||t.keyCode===i.DELETE||t.keyCode===i.INSERT)&&o.instance._registerTimeout(setTimeout(function(){o.queryChoices(o.TEXTAREA.value),n=!0},0))};o.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",i),e.editors.HandsontableEditor.prototype.prepare.apply(this,arguments)},o.prototype.open=function(){e.editors.HandsontableEditor.prototype.open.apply(this,arguments),this.TEXTAREA.style.visibility="visible",this.focus();var t=this.$htContainer.handsontable("getInstance"),o=this;t.updateSettings({colWidths:[e.Dom.outerWidth(this.TEXTAREA)-2],afterRenderer:function(e,t,n,i,r){var s=this.getCellMeta(t,n).filteringCaseSensitive===!0,a=s?r.indexOf(this.query):r.toLowerCase().indexOf(o.query.toLowerCase());if(-1!=a){var l=r.substr(a,o.query.length);e.innerHTML=r.replace(l,"<strong>"+l+"</strong>")}}}),n&&(n=!1),o.instance._registerTimeout(setTimeout(function(){o.queryChoices(o.TEXTAREA.value)},0))},o.prototype.close=function(){e.editors.HandsontableEditor.prototype.close.apply(this,arguments)},o.prototype.queryChoices=function(t){if(this.query=t,"function"==typeof this.cellProperties.source){var o=this;this.cellProperties.source(t,function(e){o.updateChoicesList(e)})}else if(e.helper.isArray(this.cellProperties.source)){var n;if(t&&this.cellProperties.filter!==!1){var i=this.cellProperties.filteringCaseSensitive===!0,r=t.toLowerCase();n=this.cellProperties.source.filter(function(e){return i?-1!=e.indexOf(t):-1!=e.toLowerCase().indexOf(r)})}else n=this.cellProperties.source;this.updateChoicesList(n)}else this.updateChoicesList([])},o.prototype.updateChoicesList=function(t){var n,i=e.Dom.getCaretPosition(this.TEXTAREA),r=e.Dom.getSelectionEndPosition(this.TEXTAREA),s=o.sortByRelevance(this.getValue(),t,this.cellProperties.filteringCaseSensitive);if(0!=this.cellProperties.filter){for(var a=[],l=0,c=s.length;c>l;l++)a.push(t[s[l]]);n=0,t=a}else n=s[0];this.choices=t,this.$htContainer.handsontable("loadData",e.helper.pivot([t])),this.$htContainer.handsontable("updateSettings",{height:this.getDropdownHeight()}),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(n),this.instance.listen(),this.TEXTAREA.focus(),e.Dom.setCaretPosition(this.TEXTAREA,i,i!=r?r:void 0)},o.prototype.finishEditing=function(t){t||this.instance.removeHook("beforeKeyDown",i),e.editors.HandsontableEditor.prototype.finishEditing.apply(this,arguments)},o.prototype.highlightBestMatchingChoice=function(e){"number"==typeof e?this.$htContainer.handsontable("selectCell",e,0):this.$htContainer.handsontable("deselectCell")},o.sortByRelevance=function(e,t,o){var n,i,r,s,a,l=[],c=e.length,u=[];if(0===c){for(s=0,a=t.length;a>s;s++)u.push(s);return u}for(s=0,a=t.length;a>s;s++)n=t[s],i=o?n.indexOf(e):n.toLowerCase().indexOf(e.toLowerCase()),-1!=i&&(r=n.length-i-c,l.push({baseIndex:s,index:i,charsLeft:r,value:n}));for(l.sort(function(e,t){return-1===t.index?-1:-1===e.index?1:e.index<t.index?-1:t.index<e.index?1:e.index===t.index?e.charsLeft<t.charsLeft?-1:e.charsLeft>t.charsLeft?1:0:void 0}),s=0,a=l.length;a>s;s++)u.push(l[s].baseIndex);return u},o.prototype.getDropdownHeight=function(){var e=this.$htContainer.handsontable("getInstance").getRowHeight(0)||23;return this.choices.length>=10?10*e:this.choices.length*e+8},e.editors.AutocompleteEditor=o,e.editors.registerEditor("autocomplete",o)}(o),function(t){var o=t.editors.TextEditor.prototype.extend();o.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.$textarea=e(this.TEXTAREA),t.Dom.empty(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)},t.editors.PasswordEditor=o,t.editors.registerEditor("password",o)}(o),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){this.select=document.createElement("SELECT"),e.Dom.addClass(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement[0].appendChild(this.select)},t.prototype.prepare=function(){e.editors.BaseEditor.prototype.prepare.apply(this,arguments);var t,o=this.cellProperties.selectOptions;t=this.prepareOptions("function"==typeof o?o(this.row,this.col,this.prop):o),e.Dom.empty(this.select);for(var n in t)if(t.hasOwnProperty(n)){var i=document.createElement("OPTION");i.value=n,e.Dom.fastInnerHTML(i,t[n]),this.select.appendChild(i)}},t.prototype.prepareOptions=function(t){var o={};if(e.helper.isArray(t))for(var n=0,i=t.length;i>n;n++)o[t[n]]=t[n];else"object"==typeof t&&(o=t);return o},t.prototype.getValue=function(){return this.select.value},t.prototype.setValue=function(e){this.select.value=e};var o=function(t){var o=this,n=o.getActiveEditor();switch(t.keyCode){case e.helper.keyCode.ARROW_UP:var i=n.select.find("option:selected").prev();1==i.length&&i.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault();break;case e.helper.keyCode.ARROW_DOWN:var r=n.select.find("option:selected").next();1==r.length&&r.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault()}};t.prototype.open=function(){var t=e.Dom.outerWidth(this.TD),n=e.Dom.outerHeight(this.TD),i=e.Dom.offset(this.instance.rootElement[0]),r=e.Dom.offset(this.TD);
this.select.style.height=n+"px",this.select.style.minWidth=t+"px",this.select.style.top=r.top-i.top+"px",this.select.style.left=r.left-i.left+"px",this.select.style.margin="0px",this.select.style.display="",this.instance.addHook("beforeKeyDown",o)},t.prototype.close=function(){this.select.style.display="none",this.instance.removeHook("beforeKeyDown",o)},t.prototype.focus=function(){this.select.focus()},e.editors.SelectEditor=t,e.editors.registerEditor("select",t)}(o),function(e){var t=e.editors.AutocompleteEditor.prototype.extend();t.prototype.prepare=function(){e.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments),this.cellProperties.filter=!1,this.cellProperties.strict=!0},e.editors.DropdownEditor=t,e.editors.registerEditor("dropdown",t)}(o),o.NumericValidator=function(e,t){null===e&&(e=""),t(/^-?\d*(\.|\,)?\d*$/.test(e))};var N=function(e,t){var o=e,n="string"==typeof o?o.toLowerCase():null;return function(e){for(var i=!1,r=0,s=e.length;s>r;r++){if(o===e[r]){i=!0;break}if(n===e[r].toLowerCase()){i=!0;break}}t(i)}};o.AutocompleteValidator=function(e,t){this.strict&&this.source?"function"==typeof this.source?this.source(e,N(e,t)):N(e,t)(this.source):t(!0)},o.AutocompleteCell={editor:o.editors.AutocompleteEditor,renderer:o.renderers.AutocompleteRenderer,validator:o.AutocompleteValidator},o.CheckboxCell={editor:o.editors.CheckboxEditor,renderer:o.renderers.CheckboxRenderer},o.TextCell={editor:o.editors.TextEditor,renderer:o.renderers.TextRenderer},o.NumericCell={editor:o.editors.TextEditor,renderer:o.renderers.NumericRenderer,validator:o.NumericValidator,dataType:"number"},o.DateCell={editor:o.editors.DateEditor,renderer:o.renderers.AutocompleteRenderer},o.HandsontableCell={editor:o.editors.HandsontableEditor,renderer:o.renderers.AutocompleteRenderer},o.PasswordCell={editor:o.editors.PasswordEditor,renderer:o.renderers.PasswordRenderer,copyable:!1},o.DropdownCell={editor:o.editors.DropdownEditor,renderer:o.renderers.AutocompleteRenderer,validator:o.AutocompleteValidator},o.cellTypes={text:o.TextCell,date:o.DateCell,numeric:o.NumericCell,checkbox:o.CheckboxCell,autocomplete:o.AutocompleteCell,handsontable:o.HandsontableCell,password:o.PasswordCell,dropdown:o.DropdownCell},o.cellLookup={validator:{numeric:o.NumericValidator,autocomplete:o.AutocompleteValidator}};var I=function(){var e,n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},i=document.body,r=document.createTextNode(""),s=document.createElement("SPAN"),a=function(e,o,n){t.attachEvent?e.attachEvent("on"+o,n):e.addEventListener(o,n,!1)},l=function(e,o,n){t.detachEvent?e.detachEvent("on"+o,n):e.removeEventListener(o,n,!1)},c=function(){void 0!==r.textContent?r.textContent=e.value:r.data=e.value,s.style.fontSize=o.Dom.getComputedStyle(e).fontSize,s.style.fontFamily=o.Dom.getComputedStyle(e).fontFamily,i.appendChild(s);var t=s.clientWidth;i.removeChild(s),e.style.height=n.minHeight+"px",e.style.width=n.minWidth>t?n.minWidth+"px":t>n.maxWidth?n.maxWidth+"px":t+"px";var a=e.scrollHeight;n.minHeight>a?e.style.height=n.minHeight+"px":n.maxHeight<a?(e.style.height=n.maxHeight+"px",e.style.overflowY="visible"):e.style.height=a+"px"},u=function(){t.setTimeout(c,0)},h=function(t){if(t&&t.minHeight)if("inherit"==t.minHeight)n.minHeight=e.clientHeight;else{var o=parseInt(t.minHeight);isNaN(o)||(n.minHeight=o)}if(t&&t.maxHeight)if("inherit"==t.maxHeight)n.maxHeight=e.clientHeight;else{var i=parseInt(t.maxHeight);isNaN(i)||(n.maxHeight=i)}if(t&&t.minWidth)if("inherit"==t.minWidth)n.minWidth=e.clientWidth;else{var a=parseInt(t.minWidth);isNaN(a)||(n.minWidth=a)}if(t&&t.maxWidth)if("inherit"==t.maxWidth)n.maxWidth=e.clientWidth;else{var l=parseInt(t.maxWidth);isNaN(l)||(n.maxWidth=l)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(r))},d=function(t,o){e=t,h(o),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=n.minHeight+"px",e.style.minWidth=n.minWidth+"px",e.style.maxWidth=n.maxWidth+"px",e.style.overflowY="hidden"),a(e,"change",c),a(e,"cut",u),a(e,"paste",u),a(e,"drop",u),a(e,"keydown",u),c()};return{init:function(e,t){d(e,t)},unObserve:function(){l(e,"change",c),l(e,"cut",u),l(e,"paste",u),l(e,"drop",u),l(e,"keydown",u)}}};!function(e){function t(e){return e.split('"').length-1}e.SheetClip={parse:function(e){var o,n,i,r,s,a,l,c=[],u=0;for(i=e.split("\n"),i.length>1&&""===i[i.length-1]&&i.pop(),o=0,n=i.length;n>o;o+=1){for(i[o]=i[o].split("	"),r=0,s=i[o].length;s>r;r+=1)c[u]||(c[u]=[]),a&&0===r?(l=c[u].length-1,c[u][l]=c[u][l]+"\n"+i[o][0],a&&1&t(i[o][0])&&(a=!1,c[u][l]=c[u][l].substring(0,c[u][l].length-1).replace(/""/g,'"'))):r===s-1&&0===i[o][r].indexOf('"')?(c[u].push(i[o][r].substring(1).replace(/""/g,'"')),a=!0):(c[u].push(i[o][r].replace(/""/g,'"')),a=!1);a||(u+=1)}return c},stringify:function(e){var t,o,n,i,r,s="";for(t=0,o=e.length;o>t;t+=1){for(n=0,i=e[t].length;i>n;n+=1)n>0&&(s+="	"),r=e[t][n],s+="string"==typeof r?r.indexOf("\n")>-1?'"'+r.replace(/"/g,'""')+'"':r:null===r||void 0===r?"":r;o-1>t&&(s+="\n")}return s}}}(t);var L=function(){var e;return{getInstance:function(){return e?e.hasBeenDestroyed()&&e.init():e=new n,e.refCounter++,e}}}();n.prototype.init=function(){var e,t,o=this;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],this.listenerElement=document.documentElement,t=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("DIV"),this.elDiv.id="CopyPasteDiv",e=this.elDiv.style,e.position="fixed",e.top="-10000px",e.left="-10000px",t.appendChild(this.elDiv),this.elTextarea=document.createElement("TEXTAREA"),this.elTextarea.className="copyPaste",e=this.elTextarea.style,e.width="10000px",e.height="10000px",e.overflow="hidden",this.elDiv.appendChild(this.elTextarea),"undefined"!=typeof e.opacity&&(e.opacity=0)),this.keydownListener=function(e){var t=!1;if(e.metaKey?t=!0:e.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(t=!0),t){if(document.activeElement!==o.elTextarea&&(""!=o.getSelectionText()||-1!=["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)))return;o.selectNodeText(o.elTextarea),setTimeout(function(){o.selectNodeText(o.elTextarea)},0)}!t||67!==e.keyCode&&86!==e.keyCode&&88!==e.keyCode||(88===e.keyCode?setTimeout(function(){o.triggerCut(e)},0):86===e.keyCode&&setTimeout(function(){o.triggerPaste(e)},0))},this._bindEvent(this.listenerElement,"keydown",this.keydownListener)},n.prototype.selectNodeText=function(e){e.select()},n.prototype.getSelectionText=function(){var e="";return t.getSelection?e=t.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(e=document.selection.createRange().text),e},n.prototype.copyable=function(e){if("string"!=typeof e&&void 0===e.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=e},n.prototype.onCut=function(e){this.cutCallbacks.push(e)},n.prototype.onPaste=function(e){this.pasteCallbacks.push(e)},n.prototype.removeCallback=function(e){var t,o;for(t=0,o=this.copyCallbacks.length;o>t;t++)if(this.copyCallbacks[t]===e)return this.copyCallbacks.splice(t,1),!0;for(t=0,o=this.cutCallbacks.length;o>t;t++)if(this.cutCallbacks[t]===e)return this.cutCallbacks.splice(t,1),!0;for(t=0,o=this.pasteCallbacks.length;o>t;t++)if(this.pasteCallbacks[t]===e)return this.pasteCallbacks.splice(t,1),!0;return!1},n.prototype.triggerCut=function(e){var t=this;t.cutCallbacks&&setTimeout(function(){for(var o=0,n=t.cutCallbacks.length;n>o;o++)t.cutCallbacks[o](e)},50)},n.prototype.triggerPaste=function(e,t){var o=this;o.pasteCallbacks&&setTimeout(function(){for(var n=(t||o.elTextarea.value).replace(/\n$/,""),i=0,r=o.pasteCallbacks.length;r>i;i++)o.pasteCallbacks[i](n,e)},50)},n.prototype.destroy=function(){this.hasBeenDestroyed()||0!=--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&(this.elDiv.parentNode.removeChild(this.elDiv),this.elDiv=null,this.elTextarea=null),this._unbindEvent(this.listenerElement,"keydown",this.keydownListener))},n.prototype.hasBeenDestroyed=function(){return!this.refCounter},n.prototype._bindEvent=function(){return t.jQuery?function(t,o,n){e(t).on(o+".copypaste",n)}:function(e,t,o){e.addEventListener(t,o,!1)}}(),n.prototype._unbindEvent=function(){return t.jQuery?function(t,o,n){e(t).off(o+".copypaste",n)}:function(e,t,o){e.removeEventListener(t,o,!1)}}();var B;!function(e){function o(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function n(e,t){var i;for(var r in e)if(e.hasOwnProperty(r)){if(e[r]===t)return o(r)+"/";if("object"==typeof e[r]&&(i=n(e[r],t),""!=i))return o(r)+"/"+i}return""}function i(e,t){if(e===t)return"/";var o=n(e,t);if(""===o)throw new Error("Object not found in root");return"/"+o}function r(e){for(var t=0,o=v.length;o>t;t++)if(v[t].obj===e)return v[t]}function s(e,t){for(var o=0,n=e.observers.length;n>o;o++)if(e.observers[o].callback===t)return e.observers[o].observer}function a(e,t){for(var o=0,n=e.observers.length;n>o;o++)if(e.observers[o].observer===t)return void e.observers.splice(o,1)}function l(e,t){d(t),Object.observe?h(t,e):clearTimeout(t.next);var o=r(e);a(o,t)}function c(e,o){var n,a=[],l=e,c=r(e);if(c?n=s(c,o):(c=new y(e),v.push(c)),n)return n;if(Object.observe)n=function(t){h(n,e),u(n,e);for(var r=0,s=t.length;s>r;){if(("length"!==t[r].name||!S(t[r].object))&&"__Jasmine_been_here_before__"!==t[r].name){var c=t[r].type;switch(c){case"new":c="add";break;case"deleted":c="delete";break;case"updated":c="update"}w[c].call(t[r],a,i(l,t[r].object))}r++}a&&o&&o(a),n.patches=a,a=[]};else if(n={},c.value=JSON.parse(JSON.stringify(e)),o){n.callback=o,n.next=null;var f=this.intervals||[100,1e3,1e4,6e4],p=0,g=function(){d(n)},m=function(){clearTimeout(n.next),n.next=setTimeout(function(){g(),p=0,n.next=setTimeout(b,f[p++])},0)},b=function(){g(),p==f.length&&(p=f.length-1),n.next=setTimeout(b,f[p++])};"undefined"!=typeof t&&(t.addEventListener?(t.addEventListener("mousedown",m),t.addEventListener("mouseup",m),t.addEventListener("keydown",m)):(t.attachEvent("onmousedown",m),t.attachEvent("onmouseup",m),t.attachEvent("onkeydown",m))),n.next=setTimeout(b,f[p++])}return n.patches=a,n.object=e,c.observers.push(new C(o,n)),u(n,e)}function u(e,t){if(Object.observe){Object.observe(t,e);for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];n&&"object"==typeof n&&u(e,n)}}return e}function h(e,t){if(Object.observe){Object.unobserve(t,e);for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];n&&"object"==typeof n&&h(e,n)}}return e}function d(e){if(Object.observe)Object.deliverChangeRecords(e);else{for(var t,o=0,n=v.length;n>o;o++)if(v[o].obj===e.object){t=v[o];break}f(t.value,e.object,e.patches,"")}var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function f(e,t,n,i){for(var r=b(t),s=b(e),a=!1,l=!1,c=s.length-1;c>=0;c--){var u=s[c],h=e[u];if(t.hasOwnProperty(u)){var d=t[u];h instanceof Object?f(h,d,n,i+"/"+o(u)):h!=d&&(a=!0,n.push({op:"replace",path:i+"/"+o(u),value:d}),e[u]=d)}else n.push({op:"remove",path:i+"/"+o(u)}),delete e[u],l=!0}if(l||r.length!=s.length)for(var c=0;c<r.length;c++){var u=r[c];e.hasOwnProperty(u)||(n.push({op:"add",path:i+"/"+o(u),value:t[u]}),e[u]=JSON.parse(JSON.stringify(t[u])))}}function p(e,t){for(var o,n=!1,i=0,r=t.length;r>i;){o=t[i];for(var s=o.path.split("/"),a=e,l=1,c=s.length;;)if(S(a)){var u=parseInt(s[l],10);if(l++,l>=c){n=m[o.op].call(o,a,u,e);break}a=a[u]}else{var h=s[l];if(-1!=h.indexOf("~")&&(h=h.replace(/~1/g,"/").replace(/~0/g,"~")),l++,l>=c){n=g[o.op].call(o,a,h,e);break}a=a[h]}i++}return n}var g={add:function(e,t){return e[t]=this.value,!0},remove:function(e,t){return delete e[t],!0},replace:function(e,t){return e[t]=this.value,!0},move:function(e,t,o){var n={op:"_get",path:this.from};return p(o,[n]),p(o,[{op:"remove",path:this.from}]),p(o,[{op:"add",path:this.path,value:n.value}]),!0},copy:function(e,t,o){var n={op:"_get",path:this.from};return p(o,[n]),p(o,[{op:"add",path:this.path,value:n.value}]),!0},test:function(e,t){return JSON.stringify(e[t])===JSON.stringify(this.value)},_get:function(e,t){this.value=e[t]}},m={add:function(e,t){return e.splice(t,0,this.value),!0},remove:function(e,t){return e.splice(t,1),!0},replace:function(e,t){return e[t]=this.value,!0},move:g.move,copy:g.copy,test:g.test,_get:g._get},w={add:function(e,t){var n={op:"add",path:t+o(this.name),value:this.object[this.name]};e.push(n)},"delete":function(e,t){var n={op:"remove",path:t+o(this.name)};e.push(n)},update:function(e,t){var n={op:"replace",path:t+o(this.name),value:this.object[this.name]};e.push(n)}},v=[];e.intervals;var y=function(){function e(e){this.observers=[],this.obj=e}return e}(),C=function(){function e(e,t){this.callback=e,this.observer=t}return e}();e.unobserve=l,e.observe=c,e.generate=d;var b;b=Object.keys?Object.keys:function(e){var t=[];for(var o in e)e.hasOwnProperty(o)&&t.push(o);return t};var S;S=Array.isArray?Array.isArray:function(e){return e.push&&"number"==typeof e.length},e.apply=p}(B||(B={})),"undefined"!=typeof exports&&(exports.apply=B.apply,exports.observe=B.observe,exports.unobserve=B.unobserve,exports.generate=B.generate),o.PluginHookClass=function(){function e(){this.hooks=t(),this.globalBucket={},this.legacy=n}var t=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeSetRangeEnd:[],beforeDrawBorders:[],beforeChange:[],beforeChangeRender:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],beforeOnCellMouseDown:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterSetCellMeta:[],afterGetColHeader:[],afterGetRowHeader:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterOnCellMouseDown:[],afterOnCellMouseOver:[],afterOnCellCornerMouseDown:[],afterScrollVertically:[],afterScrollHorizontally:[],afterCellMetaReset:[],afterIsMultipleSelectionCheck:[],afterDocumentKeyDown:[],modifyColWidth:[],modifyRowHeight:[],modifyRow:[],modifyCol:[]}},n={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};return e.prototype.getBucket=function(e){return e?(e.pluginHookBucket||(e.pluginHookBucket={}),e.pluginHookBucket):this.globalBucket},e.prototype.add=function(e,t,i){if(o.helper.isArray(t))for(var r=0,s=t.length;s>r;r++)this.add(e,t[r]);else{e in n&&(e=n[e]);var a=this.getBucket(i);"undefined"==typeof a[e]&&(a[e]=[]),t.skip=!1,-1==a[e].indexOf(t)&&a[e].push(t)}return this},e.prototype.once=function(e,t,n){if(o.helper.isArray(t))for(var i=0,r=t.length;r>i;i++)t[i].runOnce=!0,this.add(e,t[i],n);else t.runOnce=!0,this.add(e,t,n)},e.prototype.remove=function(e,t,o){var i=!1;e in n&&(e=n[e]);var r=this.getBucket(o);if("undefined"!=typeof r[e])for(var s=0,a=r[e].length;a>s;s++)if(r[e][s]==t){r[e][s].skip=!0,i=!0;break}return i},e.prototype.run=function(e,t,o,i,r,s,a,l){t in n&&(t=n[t]),this._runBucket(this.globalBucket,e,t,o,i,r,s,a,l),this._runBucket(this.getBucket(e),e,t,o,i,r,s,a,l)},e.prototype._runBucket=function(e,t,o,n,i,r,s,a,l){var c=e[o];if(c)for(var u=0,h=c.length;h>u;u++)c[u].skip||(c[u].call(t,n,i,r,s,a,l),c[u].runOnce&&this.remove(o,c[u],e===this.globalBucket?null:t))},e.prototype.destroy=function(e){var t=this.getBucket(e);for(var o in t)if(t.hasOwnProperty(o))for(var n=0,i=t[o].length;i>n;n++)this.remove(o,t[o],e)},e.prototype.execute=function(e,t,o,i,r,s,a,l){return t in n&&(t=n[t]),o=this._executeBucket(this.globalBucket,e,t,o,i,r,s,a,l),o=this._executeBucket(this.getBucket(e),e,t,o,i,r,s,a,l)},e.prototype._executeBucket=function(e,t,o,n,i,r,s,a,l){var c,u=e[o];if(u)for(var h=0,d=u.length;d>h;h++)if(!u[h].skip&&(c=u[h].call(t,n,i,r,s,a,l),void 0!==c&&(n=c),u[h].runOnce&&this.remove(o,u[h],e===this.globalBucket?null:t),c===!1))return!1;return n},e.prototype.register=function(e){this.isRegistered(e)||(this.hooks[e]=[])},e.prototype.deregister=function(e){delete this.hooks[e]},e.prototype.isRegistered=function(e){return"undefined"!=typeof this.hooks[e]},e.prototype.getRegistered=function(){return Object.keys(this.hooks)},e}(),o.hooks=new o.PluginHookClass,o.PluginHooks=o.hooks,function(e){function t(){function t(e){var t=document,o=this;o.table=t.createElement("table"),o.theadTh=t.createElement("th"),o.table.appendChild(t.createElement("thead")).appendChild(t.createElement("tr")).appendChild(o.theadTh),o.tableStyle=o.table.style,o.tableStyle.tableLayout="auto",o.tableStyle.width="auto",o.tbody=t.createElement("tbody"),o.table.appendChild(o.tbody),o.container=t.createElement("div"),o.container.className=e.rootElement[0].className+" hidden",o.containerStyle=o.container.style,o.container.appendChild(o.table)}var n=this,i=5;this.beforeInit=function(){var e=this;e.autoColumnWidths=[],e.getSettings().autoColumnSize!==!1?e.autoColumnSizeTmp||(e.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},e.addHook("beforeRender",o.determineIfChanged),e.addHook("modifyColWidth",o.modifyColWidth),e.addHook("afterDestroy",o.afterDestroy),e.determineColumnWidth=n.determineColumnWidth):e.autoColumnSizeTmp&&(e.removeHook("beforeRender",o.determineIfChanged),e.removeHook("modifyColWidth",o.modifyColWidth),e.removeHook("afterDestroy",o.afterDestroy),delete e.determineColumnWidth,n.afterDestroy.call(e))},this.determineIfChanged=function(e){e&&o.determineColumnsWidth.apply(this,arguments)},this.determineColumnWidth=function(o){var n=this,r=n.autoColumnSizeTmp;r.container||t.call(r,n),r.container.className=n.rootElement[0].className+" htAutoColumnSize",r.table.className=n.$table[0].className;for(var s=n.countRows(),a={},l=0,c=0;s>c;c++){var u=e.helper.stringify(n.getDataAtCell(c,o)),h=u.length;h>l&&(l=h),a[h]||(a[h]={needed:i,strings:[]}),a[h].needed&&(a[h].strings.push({value:u,row:c}),a[h].needed--)}var d=n.getSettings();d.colHeaders&&n.view.appendColHeader(o,r.theadTh),e.Dom.empty(r.tbody);for(var f in a)if(a.hasOwnProperty(f))for(var p=0,g=a[f].strings.length;g>p;p++){var m=a[f].strings[p].row,w=n.getCellMeta(m,o);w.col=o,w.row=m;var v=n.getCellRenderer(w),y=document.createElement("tr"),C=document.createElement("td");v(n,C,m,o,n.colToProp(o),a[f].strings[p].value,w),c++,y.appendChild(C),r.tbody.appendChild(y)}var b=n.rootElement[0].parentNode;b.appendChild(r.container);var S=e.Dom.outerWidth(r.table);return b.removeChild(r.container),S},this.determineColumnsWidth=function(){var e=this,t=this.getSettings();if(t.autoColumnSize||!t.colWidths)for(var o=this.countCols(),i=0;o>i;i++)e._getColWidthFromSettings(i)||(this.autoColumnWidths[i]=n.determineColumnWidth.call(e,i))},this.modifyColWidth=function(e,t){return this.autoColumnWidths[t]&&this.autoColumnWidths[t]>e?this.autoColumnWidths[t]:e},this.afterDestroy=function(){var e=this;e.autoColumnSizeTmp&&e.autoColumnSizeTmp.container&&e.autoColumnSizeTmp.container.parentNode&&e.autoColumnSizeTmp.container.parentNode.removeChild(e.autoColumnSizeTmp.container),e.autoColumnSizeTmp=null}}var o=new t;e.hooks.add("beforeInit",o.beforeInit),e.hooks.add("afterUpdateSettings",o.beforeInit)}(o);var W=new i;o.hooks.add("afterInit",function(){W.init.call(this,"afterInit")}),o.hooks.add("afterUpdateSettings",function(){W.init.call(this,"afterUpdateSettings")}),o.hooks.add("modifyRow",W.translateRow),o.hooks.add("afterGetColHeader",W.getColHeader),o.hooks.register("beforeColumnSort"),o.hooks.register("afterColumnSort"),function(t){function o(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),e+=" "+t)}function n(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),e+=" "+t)}function i(e,t,i,r){var s=this.getCellMeta(e,t),a=r;s.className&&(a="vertical"===i?o(s.className,r):n(s.className,r)),this.setCellMeta(e,t,"className",a),this.render()}function r(e,t,o){if(e.from.row==e.to.row&&e.from.col==e.to.col)i.call(this,e.from.row,e.from.col,t,o);else for(var n=e.from.row;n<=e.to.row;n++)for(var r=e.from.col;r<=e.to.col;r++)i.call(this,n,r,t,o)}function s(e){this.instance=e;var o=this;o.menus=[],o.triggerRows=[],this.enabled=!0,this.instance.addHook("afterDestroy",function(){o.destroy()}),this.defaultOptions={items:[{key:"row_above",name:"Insert row above",callback:function(e,t){this.alter("insert_row",t.start.row)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.view.wt.wtTable.getRowStrategy().cellCount-1,e[1]],o=t.join(",")==e.join(",");return e[0]<0||this.countRows()>=this.getSettings().maxRows||o}},{key:"row_below",name:"Insert row below",callback:function(e,t){this.alter("insert_row",t.end.row+1)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.view.wt.wtTable.getRowStrategy().cellCount-1,e[1]],o=t.join(",")==e.join(",");return this.getSelected()[0]<0||this.countRows()>=this.getSettings().maxRows||o}},s.SEPARATOR,{key:"col_left",name:"Insert column on the left",callback:function(e,t){this.alter("insert_col",t.start.col)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.view.wt.wtTable.getColumnStrategy().cellCount-1],o=t.join(",")==e.join(",");return this.getSelected()[1]<0||this.countCols()>=this.getSettings().maxCols||o}},{key:"col_right",name:"Insert column on the right",callback:function(e,t){this.alter("insert_col",t.end.col+1)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.view.wt.wtTable.getColumnStrategy().cellCount-1],o=t.join(",")==e.join(",");return e[1]<0||this.countCols()>=this.getSettings().maxCols||o}},s.SEPARATOR,{key:"remove_row",name:"Remove row",callback:function(e,t){var o=t.end.row-t.start.row+1;this.alter("remove_row",t.start.row,o)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.view.wt.wtTable.getRowStrategy().cellCount-1,e[1]],o=t.join(",")==e.join(",");return e[0]<0||o}},{key:"remove_col",name:"Remove column",callback:function(e,t){var o=t.end.col-t.start.col+1;this.alter("remove_col",t.start.col,o)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.view.wt.wtTable.getColumnStrategy().cellCount-1],o=t.join(",")==e.join(",");return e[1]<0||o}},s.SEPARATOR,{key:"undo",name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},{key:"redo",name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}},s.SEPARATOR,{key:"make_read_only",name:function(){var e="Read only",t=o.checkSelectionReadOnlyConsistency(this);return t&&(e=o.markSelected(e)),e},callback:function(){var e=o.checkSelectionReadOnlyConsistency(this),t=this;this.getSelectedRange().forAll(function(o,n){t.getCellMeta(o,n).readOnly=e?!1:!0}),this.render()}},s.SEPARATOR,{key:"alignment",name:"Alignment",submenu:{items:[{name:function(){var e="Left",t=o.checkSelectionAlignment(this,"htLeft");return t&&(e=o.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htLeft")},disabled:!1},{name:function(){var e="Center",t=o.checkSelectionAlignment(this,"htCenter");return t&&(e=o.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htCenter")},disabled:!1},{name:function(){var e="Right",t=o.checkSelectionAlignment(this,"htRight");return t&&(e=o.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htRight")},disabled:!1},{name:function(){var e="Justify",t=o.checkSelectionAlignment(this,"htJustify");return t&&(e=o.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htJustify")},disabled:!1},s.SEPARATOR,{name:function(){var e="Top",t=o.checkSelectionAlignment(this,"htTop");return t&&(e=o.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"vertical","htTop")},disabled:!1},{name:function(){var e="Middle",t=o.checkSelectionAlignment(this,"htMiddle");return t&&(e=o.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"vertical","htMiddle")},disabled:!1},{name:function(){var e="Bottom",t=o.checkSelectionAlignment(this,"htBottom");return t&&(e=o.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"vertical","htBottom")},disabled:!1}]}}]},o.options={},t.helper.extend(o.options,this.options),this.bindMouseEvents(),this.markSelected=function(e){return"<span class='selected'>✓</span>"+e},this.checkSelectionAlignment=function(e,t){var o=!1;return e.getSelectedRange().forAll(function(n,i){var r=e.getCellMeta(n,i).className;return r&&-1!=r.indexOf(t)?(o=!0,!1):void 0}),o},this.checkSelectionReadOnlyConsistency=function(e){var t=!1;return e.getSelectedRange().forAll(function(o,n){return e.getCellMeta(o,n).readOnly?(t=!0,!1):void 0}),t},t.hooks.run(e,"afterContextMenuDefaultOptions",this.defaultOptions)}function a(e,t){for(var o=0,n=e.length;n>o;o++)if(e[o].key===t)return e[o]}function l(){if(!this.rootElement[0].className.indexOf("htContextMenu")){for(var e=0,t=0,o=this.getSettings().data.length,n=0;o>n;n++)this.getSettings().data[n].name==s.SEPARATOR.name?e+=2:t+=26;this.view.wt.wtScrollbars.vertical.fixedContainer.style.height=t+e+"px"}}function c(){var e=this,o=e.getSettings().contextMenu,n=t.helper.isObject(o)?o:{};o?(e.contextMenu||(e.contextMenu=new s(e,n)),e.contextMenu.enable()):e.contextMenu&&(e.contextMenu.destroy(),delete e.contextMenu)}s.prototype.createMenu=function(o,n){o&&(o=o.replace(/ /g,"_"),o="htContextSubMenu_"+o);var i;return i=o?e("body > .htContextMenu."+o)[0]:e("body > .htContextMenu")[0],i||(i=document.createElement("DIV"),t.Dom.addClass(i,"htContextMenu"),o&&t.Dom.addClass(i,o),document.getElementsByTagName("body")[0].appendChild(i)),this.menus.indexOf(i)<0&&(this.menus.push(i),n=n||0,this.triggerRows.push(n)),i},s.prototype.bindMouseEvents=function(){function o(o){var n=this.instance.getSettings();this.closeAll(),o.preventDefault(),o.stopPropagation();var i=this.instance.getSettings().rowHeaders,r=this.instance.getSettings().colHeaders;if(i||r||"TD"==o.target.nodeName||t.Dom.hasClass(o.target,"current")&&t.Dom.hasClass(o.target,"wtBorder")){var a=this.createMenu(),l=this.getItems(n.contextMenu);this.show(a,l),this.setMenuPosition(o,a),e(document).on("mousedown.htContextMenu",t.helper.proxy(s.prototype.closeAll,this))}}this.instance.rootElement.on("contextmenu.htContextMenu",t.helper.proxy(o,this))},s.prototype.bindTableEvents=function(){this._afterScrollCallback=function(){},this.instance.addHook("afterScrollVertically",this._afterScrollCallback),this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)},s.prototype.unbindTableEvents=function(){this._afterScrollCallback&&(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},s.prototype.performAction=function(t,o){var n=this,i=e(o).handsontable("getInstance"),r=i.getSelected()[0],a=i.getData()[r];if(a.disabled!==!0&&("function"!=typeof a.disabled||a.disabled.call(this.instance)!==!0)&&!a.hasOwnProperty("submenu")){if("function"!=typeof a.callback)return;var l=this.instance.getSelectedRange(),c=s.utils.normalizeSelection(l);a.callback.call(this.instance,a.key,c,t),n.closeAll()}},s.prototype.unbindMouseEvents=function(){this.instance.rootElement.off("contextmenu.htContextMenu"),e(document).off("mousedown.htContextMenu")},s.prototype.show=function(o,n){o.removeAttribute("style"),o.style.display="block";var i=this;e(o).off("mousedown.htContextMenu").on("mousedown.htContextMenu",function(e){i.performAction(e,o)}),e(o).handsontable({data:n,colHeaders:!1,colWidths:[200],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:t.helper.proxy(this.renderer,this)}],beforeKeyDown:function(e){i.onBeforeKeyDown(e,o)},afterOnCellMouseOver:function(e,t,n){i.onCellMouseOver(e,t,n,o)},renderAllRows:!0}),this.bindTableEvents(),e(o).handsontable("listen")},s.prototype.close=function(t){this.hide(t),e(document).off("mousedown.htContextMenu"),this.unbindTableEvents(),this.instance.listen()},s.prototype.closeAll=function(){for(;this.menus.length>0;){var e=this.menus.pop();e&&this.close(e)}this.triggerRows=[]},s.prototype.closeLastOpenedSubMenu=function(){var e=this.menus.pop();e&&this.hide(e)},s.prototype.hide=function(t){t.style.display="none",e(t).handsontable("destroy")},s.prototype.renderer=function(o,n,i,r,a,l){function c(e){return e.hasOwnProperty("submenu")}function u(e){return new RegExp(s.SEPARATOR.name,"i").test(e.name)}function h(e){return e.disabled===!0||"function"==typeof e.disabled&&e.disabled.call(d.instance)===!0}var d=this,f=o.getData()[i],p=document.createElement("DIV");"function"==typeof l&&(l=l.call(this.instance)),t.Dom.empty(n),n.appendChild(p),u(f)?t.Dom.addClass(n,"htSeparator"):t.Dom.fastInnerHTML(p,l),h(f)?(t.Dom.addClass(n,"htDisabled"),e(p).on("mouseenter",function(){o.deselectCell()})):c(f)?(t.Dom.addClass(n,"htSubmenu"),e(p).on("mouseenter",function(){o.selectCell(i,r)})):(t.Dom.removeClass(n,"htSubmenu"),t.Dom.removeClass(n,"htDisabled"),e(p).on("mouseenter",function(){o.selectCell(i,r)}))},s.prototype.onCellMouseOver=function(t,o,n,i){var r=e(i).handsontable("getInstance"),s=this.menus.length;if(s>0){var a=this.menus[s-1];a.id!=i.id&&this.closeLastOpenedSubMenu()}else this.closeLastOpenedSubMenu();if(-1!=n.className.indexOf("htSubmenu")){var l=r.getData()[o.row],c=this.getItems(l.submenu),u=this.createMenu(l.name,o.row),h=n.getBoundingClientRect();this.show(u,c),this.setSubMenuPosition(h,u)}},s.prototype.onBeforeKeyDown=function(o,n){function i(e){var t=e.getCell(0,0);s.utils.isSeparator(t)||s.utils.isDisabled(t)?a(0,0,e):e.selectCell(0,0)}function r(e){var t=e.countRows()-1,o=e.getCell(t,0);s.utils.isSeparator(o)||s.utils.isDisabled(o)?l(t,0,e):e.selectCell(t,0)}function a(e,t,o){var n=e+1,i=n<o.countRows()?o.getCell(n,t):null;i&&(s.utils.isSeparator(i)||s.utils.isDisabled(i)?a(n,t,o):o.selectCell(n,t))}function l(e,t,o){var n=e-1,i=n>=0?o.getCell(n,t):null;i&&(s.utils.isSeparator(i)||s.utils.isDisabled(i)?l(n,t,o):o.selectCell(n,t))}function c(t,o,n,i){var r=t.getData()[i],s=o.getItems(r.submenu),a=o.createMenu(r.name,i),l=n.getBoundingClientRect();o.show(a,s),o.setSubMenuPosition(l,a);var c=e(a).handsontable("getInstance");c.selectCell(0,0)}var u=this,h=e(n).handsontable("getInstance"),d=h.getSelected();switch(o.keyCode){case t.helper.keyCode.ESCAPE:u.closeAll(),o.preventDefault(),o.stopImmediatePropagation();break;case t.helper.keyCode.ENTER:d&&u.performAction(o,n);break;case t.helper.keyCode.ARROW_DOWN:d?a(d[0],d[1],h,u):i(h,u),o.preventDefault(),o.stopImmediatePropagation();break;case t.helper.keyCode.ARROW_UP:d?l(d[0],d[1],h,u):r(h,u),o.preventDefault(),o.stopImmediatePropagation();break;case t.helper.keyCode.ARROW_RIGHT:if(d){var f=d[0],p=h.getCell(d[0],0);s.utils.hasSubMenu(p)&&c(h,u,p,f)}o.preventDefault(),o.stopImmediatePropagation();break;case t.helper.keyCode.ARROW_LEFT:if(d){if(-1!=n.className.indexOf("htContextSubMenu_")){u.closeLastOpenedSubMenu();var g=u.menus.length;if(g>0){n=u.menus[g-1];var m=u.triggerRows.pop();h=e(n).handsontable("getInstance"),h.selectCell(m,0)}}o.preventDefault(),o.stopImmediatePropagation()}}},s.prototype.getItems=function(e){function o(e){"string"==typeof e?this.name=e:t.helper.extend(this,e)}var n,i;o.prototype=e,e&&e.items&&(e=e.items),e===!0&&(e=this.defaultOptions.items),n=[];for(var r in e)e.hasOwnProperty(r)&&(i="string"==typeof e[r]?a(this.defaultOptions.items,e[r]):a(this.defaultOptions.items,r),i||(i=e[r]),i=new o(i),"object"==typeof e[r]&&t.helper.extend(i,e[r]),i.key||(i.key=r),n.push(i));
return n},s.prototype.setSubMenuPosition=function(e,o){var n=t.Dom.getWindowScrollTop(),i=t.Dom.getWindowScrollLeft(),r={top:n+e.top,topRelative:e.top,left:e.left,leftRelative:e.left-i,scrollTop:n,scrollLeft:i,cellHeight:e.height,cellWidth:e.width};this.menuFitsBelowCursor(r,o)?this.positionMenuBelowCursor(r,o,!0):this.menuFitsAboveCursor(r,o)?this.positionMenuAboveCursor(r,o,!0):this.positionMenuBelowCursor(r,o,!0),this.menuFitsOnRightOfCursor(r,o)?this.positionMenuOnRightOfCursor(r,o,!0):this.positionMenuOnLeftOfCursor(r,o,!0)},s.prototype.setMenuPosition=function(e,o){var n=e.pageY,i=e.pageX,r=t.Dom.getWindowScrollTop(),s=t.Dom.getWindowScrollLeft(),a={top:n,topRelative:n-r,left:i,leftRelative:i-s,scrollTop:r,scrollLeft:s,cellHeight:e.target.clientHeight,cellWidth:e.target.clientWidth};this.menuFitsBelowCursor(a,o)?this.positionMenuBelowCursor(a,o):this.menuFitsAboveCursor(a,o)?this.positionMenuAboveCursor(a,o):this.positionMenuBelowCursor(a,o),this.menuFitsOnRightOfCursor(a,o)?this.positionMenuOnRightOfCursor(a,o):this.positionMenuOnLeftOfCursor(a,o)},s.prototype.menuFitsAboveCursor=function(e,t){return e.topRelative>=t.offsetHeight},s.prototype.menuFitsBelowCursor=function(e,t){return e.topRelative+t.offsetHeight<=e.scrollTop+document.body.clientHeight},s.prototype.menuFitsOnRightOfCursor=function(e,t){return e.leftRelative+t.offsetWidth<=e.scrollLeft+document.body.clientWidth},s.prototype.positionMenuBelowCursor=function(e,t){t.style.top=e.top+"px"},s.prototype.positionMenuAboveCursor=function(e,t,o){t.style.top=o?e.top+e.cellHeight-t.offsetHeight+"px":e.top-t.offsetHeight+"px"},s.prototype.positionMenuOnRightOfCursor=function(e,t,o){t.style.left=o?1+e.left+e.cellWidth+"px":1+e.left+"px"},s.prototype.positionMenuOnLeftOfCursor=function(e,t,o){t.style.left=o?e.left-t.offsetWidth+"px":e.left-t.offsetWidth+"px"},s.utils={},s.utils.normalizeSelection=function(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}},s.utils.isSeparator=function(e){return t.Dom.hasClass(e,"htSeparator")},s.utils.hasSubMenu=function(e){return t.Dom.hasClass(e,"htSubmenu")},s.utils.isDisabled=function(e){return t.Dom.hasClass(e,"htDisabled")},s.prototype.enable=function(){this.enabled||(this.enabled=!0,this.bindMouseEvents())},s.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.closeAll(),this.unbindMouseEvents(),this.unbindTableEvents())},s.prototype.destroy=function(){for(this.closeAll();this.menus.length>0;){var e=this.menus.pop();this.triggerRows.pop(),e&&(this.close(e),this.isMenuEnabledByOtherHotInstance()||this.removeMenu(e))}this.unbindMouseEvents(),this.unbindTableEvents()},s.prototype.isMenuEnabledByOtherHotInstance=function(){for(var t=e(".handsontable"),o=!1,n=0,i=t.length;i>n;n++){var r=e(t[n]).handsontable("getInstance");if(r&&r.getSettings().contextMenu){o=!0;break}}return o},s.prototype.removeMenu=function(e){e.parentNode&&this.menu.parentNode.removeChild(e)},s.SEPARATOR={name:"---------"},t.hooks.add("afterInit",c),t.hooks.add("afterUpdateSettings",c),t.hooks.add("afterInit",l),t.PluginHooks.register("afterContextMenuDefaultOptions"),t.ContextMenu=s}(o);var V=function(){var e=this,t=e.getSettings().comments;t&&(o.Comments=new r(e),o.Comments.init())},_=function(e,t,n,i,r,s){s.comment&&o.Dom.addClass(e,s.commentedCellClassName)},F=function(e){var t=this;t.getSettings().comments&&(e.items.push(o.ContextMenu.SEPARATOR),e.items.push({key:"commentsAddEdit",name:function(){var e=o.Comments.checkSelectionCommentsConsistency();return e?"Edit Comment":"Add Comment"},callback:function(){o.Comments.showComment(this.getSelectedRange())},disabled:function(){return!1}}),e.items.push({key:"commentsRemove",name:function(){return"Delete Comment"},callback:function(e,t){o.Comments.removeComment(t.start.row,t.start.col)},disabled:function(){var e=o.Comments.checkSelectionCommentsConsistency();return!e}}))};o.hooks.add("beforeInit",V),o.hooks.add("afterContextMenuDefaultOptions",F),o.hooks.add("afterRenderer",_),function(o){function n(){function n(e){f=this,p=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){d=t;var o=p.getBoundingClientRect();h=o.left,g.style.top=o.top+"px",g.style.left=h+"px",f.rootElement[0].appendChild(g)}}function i(e){var t=e.getBoundingClientRect();g.style.left=t.left+"px"}function r(){var e=this;o.Dom.addClass(g,"active"),o.Dom.addClass(m,"active");var t=p.getBoundingClientRect();m.style.width=t.width+"px",m.style.height=e.view.maximumVisibleElementHeight(0)+"px",m.style.top=g.style.top,m.style.left=h+"px",e.rootElement[0].appendChild(m)}function s(e){m.style.left=h+e+"px"}function a(){o.Dom.removeClass(g,"active"),o.Dom.removeClass(m,"active")}var l,c,u,h,d,f,p,g=document.createElement("DIV"),m=document.createElement("DIV"),w=e(t);g.className="manualColumnMover",m.className="manualColumnMoverGuide";var v=function(){var e=this;o.hooks.run(e,"persistentStateSave","manualColumnPositions",e.manualColumnPositions)},y=function(){var e=this,t={};return o.hooks.run(e,"persistentStateLoad","manualColumnPositions",t),t.value},C=function(){var e,t=this;t.rootElement.on("mouseenter.manualColumnMove."+t.guid,"table thead tr > th",function(o){e?(c=t.view.wt.wtTable.getCoords(o.currentTarget).col,i(o.currentTarget)):n.call(t,o.currentTarget)}),t.rootElement.on("mousedown.manualColumnMove."+t.guid,".manualColumnMover",function(o){u=o.pageX,r.call(t),e=t,l=d,c=d}),w.on("mousemove.manualColumnMove."+t.guid,function(t){e&&s(t.pageX-u)}),w.on("mouseup.manualColumnMove."+t.guid,function(){e&&(a(),e=!1,c>l&&c--,S(t.manualColumnPositions,t.countCols()),t.manualColumnPositions.splice(c,0,t.manualColumnPositions.splice(l,1)[0]),t.forceFullRender=!0,t.view.render(),v.call(t),o.hooks.run(t,"afterColumnMove",l,c),n.call(t,p))}),t.addHook("afterDestroy",b)},b=function(){var e=this;e.rootElement.off("mouseenter.manualColumnMove."+e.guid,"table thead tr > th"),e.rootElement.off("mousedown.manualColumnMove."+e.guid,".manualColumnMover"),w.off("mousemove.manualColumnMove."+e.guid),w.off("mouseup.manualColumnMove."+e.guid)},S=function(e,t){if(e.length<t)for(var o=e.length;t>o;o++)e[o]=o};this.beforeInit=function(){this.manualColumnPositions=[]},this.init=function(e){var t=this,o=!!this.getSettings().manualColumnMove;if(o){var n=this.getSettings().manualColumnMove,i=y.call(t);this.manualColumnPositions="undefined"!=typeof i?i:n instanceof Array?n:[],"afterInit"==e&&(C.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))}else b.call(this),this.manualColumnPositions=[]},this.modifyCol=function(e){return this.getSettings().manualColumnMove?("undefined"==typeof this.manualColumnPositions[e]&&S(this.manualColumnPositions,e+1),this.manualColumnPositions[e]):e}}var i=new n;o.hooks.add("beforeInit",i.beforeInit),o.hooks.add("afterInit",function(){i.init.call(this,"afterInit")}),o.hooks.add("afterUpdateSettings",function(){i.init.call(this,"afterUpdateSettings")}),o.hooks.add("modifyCol",i.modifyCol),o.hooks.register("afterColumnMove")}(o),function(o){function n(){function n(e){h=this,l=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){c=t;var o=l.getBoundingClientRect();g=o.left-6,p=parseInt(o.width,10),m.style.top=o.top+"px",m.style.left=g+p+"px",h.rootElement[0].appendChild(m)}}function i(){m.style.left=g+u+"px"}function r(){var e=this;o.Dom.addClass(m,"active"),o.Dom.addClass(w,"active"),w.style.top=m.style.top,w.style.left=m.style.left,w.style.height=e.view.maximumVisibleElementHeight(0)+"px",e.rootElement[0].appendChild(w)}function s(){w.style.left=m.style.left}function a(){o.Dom.removeClass(m,"active"),o.Dom.removeClass(w,"active")}var l,c,u,h,d,f,p,g,m=document.createElement("DIV"),w=document.createElement("DIV"),v=e(t);m.className="manualColumnResizer",w.className="manualColumnResizerGuide";var y=function(){var e=this;o.hooks.run(e,"persistentStateSave","manualColumnWidths",e.manualColumnWidths)},C=function(){var e=this,t={};return o.hooks.run(e,"persistentStateLoad","manualColumnWidths",t),t.value},b=function(){var e,t=this,h=0,g=null;t.rootElement.on("mouseenter.manualColumnResize."+t.guid,"table thead tr > th",function(o){e||n.call(t,o.currentTarget)}),t.rootElement.on("mousedown.manualColumnResize."+t.guid,".manualColumnResizer",function(n){r.call(t),e=t,null==g&&(g=setTimeout(function(){h>=2&&(d=t.determineColumnWidth.call(t,c),R(c,d),t.forceFullRender=!0,t.view.render(),o.hooks.run(t,"afterColumnResize",c,d)),h=0,g=null},500),t._registerTimeout(g)),h++,f=n.pageX,d=p}),v.on("mousemove.manualColumnResize."+t.guid,function(t){e&&(u=p+(t.pageX-f),d=R(c,u),i(),s())}),v.on("mouseup.manualColumnResize."+t.guid,function(){e&&(a(),e=!1,d!=p&&(t.forceFullRender=!0,t.view.render(),y.call(t),o.hooks.run(t,"afterColumnResize",c,d)),n.call(t,l))}),t.addHook("afterDestroy",S)},S=function(){var e=this;e.rootElement.off("mouseenter.manualColumnResize."+e.guid,"table thead tr > th"),e.rootElement.off("mousedown.manualColumnResize."+e.guid,".manualColumnResizer"),v.off("mousemove.manualColumnResize."+e.guid),v.off("mouseup.manualColumnResize."+e.guid)};this.beforeInit=function(){this.manualColumnWidths=[]},this.init=function(e){var t=this,o=!!this.getSettings().manualColumnResize;if(o){var n=this.getSettings().manualColumnResize,i=C.call(t);this.manualColumnWidths="undefined"!=typeof i?i:n instanceof Array?n:[],"afterInit"==e&&(b.call(this),this.manualColumnWidths.length>0&&(this.forceFullRender=!0,this.render()))}else S.call(this),this.manualColumnWidths=[]};var R=function(e,t){return t=Math.max(t,20),e=o.hooks.execute(h,"modifyCol",e),h.manualColumnWidths[e]=t,t};this.modifyColWidth=function(e,t){return t=this.runHooksAndReturn("modifyCol",t),this.getSettings().manualColumnResize&&this.manualColumnWidths[t]?this.manualColumnWidths[t]:e}}var i=new n;o.hooks.add("beforeInit",i.beforeInit),o.hooks.add("afterInit",function(){i.init.call(this,"afterInit")}),o.hooks.add("afterUpdateSettings",function(){i.init.call(this,"afterUpdateSettings")}),o.hooks.add("modifyColWidth",i.modifyColWidth),o.hooks.register("afterColumnResize")}(o),function(o){function n(){function n(e){h=this,l=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){c=t;var o=l.getBoundingClientRect();g=o.top-6,p=parseInt(o.height,10),m.style.left=o.left+"px",m.style.top=g+p+"px",h.rootElement[0].appendChild(m)}}function i(){m.style.top=g+u+"px"}function r(){var e=this;o.Dom.addClass(m,"active"),o.Dom.addClass(w,"active"),w.style.top=m.style.top,w.style.left=m.style.left,w.style.width=e.view.maximumVisibleElementWidth(0)+"px",e.rootElement[0].appendChild(w)}function s(){w.style.top=m.style.top}function a(){o.Dom.removeClass(m,"active"),o.Dom.removeClass(w,"active")}var l,c,u,h,d,f,p,g,m=document.createElement("DIV"),w=document.createElement("DIV"),v=e(t);m.className="manualRowResizer",w.className="manualRowResizerGuide";var y=function(){var e=this;o.hooks.run(e,"persistentStateSave","manualRowHeights",e.manualRowHeights)},C=function(){var e=this,t={};return o.hooks.run(e,"persistentStateLoad","manualRowHeights",t),t.value},b=function(){var e,t=this,h=0,g=null;t.rootElement.on("mouseenter.manualRowResize."+t.guid,"table tbody tr > th",function(o){e||n.call(t,o.currentTarget)}),t.rootElement.on("mousedown.manualRowResize."+t.guid,".manualRowResizer",function(n){r.call(t),e=t,null==g&&(g=setTimeout(function(){h>=2&&(R(c,null),t.forceFullRender=!0,t.view.render(),o.hooks.run(t,"afterRowResize",c,d)),h=0,g=null},500),t._registerTimeout(g)),h++,f=n.pageY,d=p}),v.on("mousemove.manualRowResize."+t.guid,function(t){e&&(u=p+(t.pageY-f),d=R(c,u),i(),s())}),v.on("mouseup.manualRowResize."+t.guid,function(){e&&(a(),e=!1,d!=p&&(t.forceFullRender=!0,t.view.render(),y.call(t),o.hooks.run(t,"afterRowResize",c,d)),n.call(t,l))}),t.addHook("afterDestroy",S)},S=function(){var e=this;e.rootElement.off("mouseenter.manualRowResize."+e.guid,"table tbody tr > th"),e.rootElement.off("mousedown.manualRowResize."+e.guid,".manualRowResizer"),v.off("mousemove.manualRowResize."+e.guid),v.off("mouseup.manualRowResize."+e.guid)};this.beforeInit=function(){this.manualRowHeights=[]},this.init=function(e){var t=this,o=!!this.getSettings().manualRowResize;if(o){var n=this.getSettings().manualRowResize,i=C.call(t);this.manualRowHeights="undefined"!=typeof i?i:n instanceof Array?n:[],"afterInit"===e?(b.call(this),this.manualRowHeights.length>0&&(this.forceFullRender=!0,this.render())):(this.forceFullRender=!0,this.render())}else S.call(this),this.manualRowHeights=[]};var R=function(e,t){return e=o.hooks.execute(h,"modifyRow",e),h.manualRowHeights[e]=t,t};this.modifyRowHeight=function(e,t){return this.getSettings().manualRowResize&&(t=this.runHooksAndReturn("modifyRow",t),void 0!==this.manualRowHeights[t])?this.manualRowHeights[t]:e}}var i=new n;o.hooks.add("beforeInit",i.beforeInit),o.hooks.add("afterInit",function(){i.init.call(this,"afterInit")}),o.hooks.add("afterUpdateSettings",function(){i.init.call(this,"afterUpdateSettings")}),o.hooks.add("modifyRowHeight",i.modifyRowHeight),o.hooks.register("afterRowResize")}(o),function(){function e(){var e=this,o=e.getSettings().observeChanges;o?(e.observer&&i.call(e),t.call(e),s.call(e)):o||i.call(e)}function t(){var e=this;e.observeChangesActive=!0,e.pauseObservingChanges=function(){e.observeChangesActive=!1},e.resumeObservingChanges=function(){e.observeChangesActive=!0},e.observedData=e.getData(),e.observer=B.observe(e.observedData,function(t){e.observeChangesActive&&(n.call(e,t),e.render()),e.runHooks("afterChangesObserved")})}function n(e){function t(e){var t;return t=n(e),t=o(t)}function o(e){var t=[];return e.filter(function(e){var o=i(e.path);if(-1!=["add","remove"].indexOf(e.op)&&!isNaN(o.col)){if(-1!=t.indexOf(o.col))return!1;t.push(o.col)}return!0})}function n(e){return e.filter(function(e){return!/[/]length/gi.test(e.path)})}function i(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}for(var r=this,s=t(e),a=0,l=s.length;l>a;a++){var c=s[a],u=i(c.path);switch(c.op){case"add":isNaN(u.col)?r.runHooks("afterCreateRow",u.row):r.runHooks("afterCreateCol",u.col);break;case"remove":isNaN(u.col)?r.runHooks("afterRemoveRow",u.row,1):r.runHooks("afterRemoveCol",u.col,1);break;case"replace":r.runHooks("afterChange",[u.row,u.col,null,c.value],"external")}}}function i(){var e=this;e.observer&&(r.call(e),a.call(e))}function r(){var e=this;B.unobserve(e.observedData,e.observer),delete e.observeChangesActive,delete e.pauseObservingChanges,delete e.resumeObservingChanges}function s(){var e=this;e.addHook("afterDestroy",i),e.addHook("afterCreateRow",l),e.addHook("afterRemoveRow",l),e.addHook("afterCreateCol",l),e.addHook("afterRemoveCol",l),e.addHook("afterChange",function(e,t){"loadData"!=t&&l.call(this)})}function a(){var e=this;e.removeHook("afterDestroy",i),e.removeHook("afterCreateRow",l),e.removeHook("afterRemoveRow",l),e.removeHook("afterCreateCol",l),e.removeHook("afterRemoveCol",l),e.removeHook("afterChange",l)}function l(){var e=this;e.pauseObservingChanges(),e.addHookOnce("afterChangesObserved",function(){e.resumeObservingChanges()})}o.hooks.add("afterLoadData",e),o.hooks.add("afterUpdateSettings",e),o.hooks.register("afterChangesObserved")}(),function(e){function t(){function t(){var e=this;for(var t in r)r.hasOwnProperty(t)&&e.addHook(t,r[t])}function n(){var e=this;for(var t in r)r.hasOwnProperty(t)&&e.removeHook(t,r[t])}var i=this;this.init=function(){var o=this,r=o.getSettings().persistentState;return i.enabled=!!r,i.enabled?(o.storage||(o.storage=new e(o.rootElement[0].id)),o.resetState=i.resetValue,void t.call(o)):void n.call(o)},this.saveValue=function(e,t){var o=this;o.storage.saveValue(e,t)},this.loadValue=function(e,t){var o=this;t.value=o.storage.loadValue(e)},this.resetValue=function(e){var t=this;"undefined"!=typeof e?t.storage.reset(e):t.storage.resetAll()};var r={persistentStateSave:i.saveValue,persistentStateLoad:i.loadValue,persistentStateReset:i.resetValue};for(var s in r)r.hasOwnProperty(s)&&o.hooks.register(s)}var n=new t;o.hooks.add("beforeInit",n.init),o.hooks.add("afterUpdateSettings",n.init)}(s),function(t){t.UndoRedo=function(e){var o=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,e.addHook("afterChange",function(e){if(e){var n=new t.UndoRedo.ChangeAction(e);o.done(n)}}),e.addHook("afterCreateRow",function(e,n,i){if(!i){var r=new t.UndoRedo.CreateRowAction(e,n);o.done(r)}}),e.addHook("beforeRemoveRow",function(e,n){var i=o.instance.getData();e=(i.length+e)%i.length;var r=i.slice(e,e+n),s=new t.UndoRedo.RemoveRowAction(e,r);o.done(s)}),e.addHook("afterCreateCol",function(e,n,i){if(!i){var r=new t.UndoRedo.CreateColumnAction(e,n);o.done(r)}}),e.addHook("beforeRemoveCol",function(n,i){var r=o.instance.getData();n=(o.instance.countCols()+n)%o.instance.countCols();for(var s=[],a=0,l=r.length;l>a;a++)s[a]=r[a].slice(n,n+i);var c;t.helper.isArray(e.getSettings().colHeaders)&&(c=e.getSettings().colHeaders.slice(n,n+s.length));var u=new t.UndoRedo.RemoveColumnAction(n,s,c);o.done(u)})},t.UndoRedo.prototype.done=function(e){this.ignoreNewActions||(this.doneActions.push(e),this.undoneActions.length=0)},t.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop();this.ignoreNewActions=!0;var t=this;e.undo(this.instance,function(){t.ignoreNewActions=!1,t.undoneActions.push(e)})}},t.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop();this.ignoreNewActions=!0;var t=this;e.redo(this.instance,function(){t.ignoreNewActions=!1,t.doneActions.push(e)})}},t.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},t.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},t.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},t.UndoRedo.Action=function(){},t.UndoRedo.Action.prototype.undo=function(){},t.UndoRedo.Action.prototype.redo=function(){},t.UndoRedo.ChangeAction=function(e){this.changes=e},t.helper.inherit(t.UndoRedo.ChangeAction,t.UndoRedo.Action),t.UndoRedo.ChangeAction.prototype.undo=function(t,o){for(var n=e.extend(!0,[],this.changes),i=t.countEmptyRows(!0),r=t.countEmptyCols(!0),s=0,a=n.length;a>s;s++)n[s].splice(3,1);t.addHookOnce("afterChange",o),t.setDataAtRowProp(n,null,null,"undo");for(var s=0,a=n.length;a>s;s++)t.getSettings().minSpareRows&&n[s][0]+1+t.getSettings().minSpareRows===t.countRows()&&i==t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(n[s][0]+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&n[s][1]+1+t.getSettings().minSpareCols===t.countCols()&&r==t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(n[s][1]+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())},t.UndoRedo.ChangeAction.prototype.redo=function(t,o){for(var n=e.extend(!0,[],this.changes),i=0,r=n.length;r>i;i++)n[i].splice(2,1);t.addHookOnce("afterChange",o),t.setDataAtRowProp(n,null,null,"redo")},t.UndoRedo.CreateRowAction=function(e,t){this.index=e,this.amount=t},t.helper.inherit(t.UndoRedo.CreateRowAction,t.UndoRedo.Action),t.UndoRedo.CreateRowAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount)},t.UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index+1,this.amount)},t.UndoRedo.RemoveRowAction=function(e,t){this.index=e,this.data=t},t.helper.inherit(t.UndoRedo.RemoveRowAction,t.UndoRedo.Action),t.UndoRedo.RemoveRowAction.prototype.undo=function(e,t){var o=[this.index,0];Array.prototype.push.apply(o,this.data),Array.prototype.splice.apply(e.getData(),o),e.addHookOnce("afterRender",t),e.render()},t.UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length)},t.UndoRedo.CreateColumnAction=function(e,t){this.index=e,this.amount=t},t.helper.inherit(t.UndoRedo.CreateColumnAction,t.UndoRedo.Action),t.UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)},t.UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index+1,this.amount)},t.UndoRedo.RemoveColumnAction=function(e,t,o){this.index=e,this.data=t,this.amount=this.data[0].length,this.headers=o},t.helper.inherit(t.UndoRedo.RemoveColumnAction,t.UndoRedo.Action),t.UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){for(var o,n,i=0,r=e.getData().length;r>i;i++)o=e.getSourceDataAtRow(i),n=[this.index,0],Array.prototype.push.apply(n,this.data[i]),Array.prototype.splice.apply(o,n);"undefined"!=typeof this.headers&&(n=[this.index,0],Array.prototype.push.apply(n,this.headers),Array.prototype.splice.apply(e.getSettings().colHeaders,n)),e.addHookOnce("afterRender",t),e.render()},t.UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)}}(o),function(e){function t(){var t=this,s="undefined"==typeof t.getSettings().undo||t.getSettings().undo;s?t.undoRedo||(t.undoRedo=new e.UndoRedo(t),i(t),t.addHook("beforeKeyDown",o),t.addHook("afterChange",n)):t.undoRedo&&(delete t.undoRedo,r(t),t.removeHook("beforeKeyDown",o),t.removeHook("afterChange",n))}function o(e){var t=this,o=(e.ctrlKey||e.metaKey)&&!e.altKey;o&&(89===e.keyCode||e.shiftKey&&90===e.keyCode?(t.undoRedo.redo(),e.stopImmediatePropagation()):90===e.keyCode&&(t.undoRedo.undo(),e.stopImmediatePropagation()))}function n(e,t){var o=this;return"loadData"==t?o.undoRedo.clear():void 0}function i(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function r(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}e.hooks.add("afterInit",t),e.hooks.add("afterUpdateSettings",t)}(o),a.prototype.setBoundaries=function(e){this.boundaries=e},a.prototype.setCallback=function(e){this.callback=e},a.prototype.check=function(e,t){var o=0,n=0;t<this.boundaries.top?n=t-this.boundaries.top:t>this.boundaries.bottom&&(n=t-this.boundaries.bottom),e<this.boundaries.left?o=e-this.boundaries.left:e>this.boundaries.right&&(o=e-this.boundaries.right),this.callback(o,n)};var z,G;if("undefined"!=typeof o){var j=function(e){e.dragToScrollListening=!1;var o=e.view.wt.wtScrollbars.vertical.scrollHandler;z=new a,o!==t&&(z.setBoundaries(o?o.getBoundingClientRect():e.$table[0].getBoundingClientRect()),z.setCallback(function(t,n){0>t?o?o.scrollLeft-=50:e.view.wt.scrollHorizontal(-1).draw():t>0&&(o?o.scrollLeft+=50:e.view.wt.scrollHorizontal(1).draw()),0>n?o?o.scrollTop-=20:e.view.wt.scrollVertical(-1).draw():n>0&&(o?o.scrollTop+=20:e.view.wt.scrollVertical(1).draw())}),e.dragToScrollListening=!0)};o.hooks.add("afterInit",function(){var t=this;e(document).on("mouseup."+this.guid,function(){t.dragToScrollListening=!1}),e(document).on("mousemove."+this.guid,function(e){t.dragToScrollListening&&z.check(e.clientX,e.clientY)})}),o.hooks.add("afterDestroy",function(){e(document).off("."+this.guid)}),o.hooks.add("afterOnCellMouseDown",function(){j(this)}),o.hooks.add("afterOnCellCornerMouseDown",function(){j(this)}),o.plugins.DragToScroll=a}if(function(e,t,o){function n(n){function i(){n.isListening()&&n.selection.empty()}function r(e){if(n.isListening()&&n.selection.isSelected()){var t=e.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),i=o.parse(t),r=n.getSelected(),s=new f(r[0],r[1]),a=new f(r[2],r[3]),l=new p(s,s,a),c=l.getTopLeftCorner(),u=l.getBottomRightCorner(),h=c,d=new f(Math.max(u.row,i.length-1+c.row),Math.max(u.col,i[0].length-1+c.col));n.addHookOnce("afterChange",function(e){e&&e.length&&this.selectCell(h.row,h.col,d.row,d.col)}),n.populateFromArray(h.row,h.col,i,d.row,d.col,"paste",n.getSettings().pasteMode)}}function s(t){if(n.getSelected()){if(e.helper.isCtrlKey(t.keyCode))return a.setCopyableText(),void t.stopImmediatePropagation();var o=(t.ctrlKey||t.metaKey)&&!t.altKey;t.keyCode==e.helper.keyCode.A&&o&&n._registerTimeout(setTimeout(e.helper.proxy(a.setCopyableText,a),0))}}this.copyPasteInstance=t.getInstance(),this.copyPasteInstance.onCut(i),this.copyPasteInstance.onPaste(r);var a=this;n.addHook("beforeKeyDown",s),this.destroy=function(){this.copyPasteInstance.removeCallback(i),this.copyPasteInstance.removeCallback(r),this.copyPasteInstance.destroy(),n.removeHook("beforeKeyDown",s)},n.addHook("afterDestroy",e.helper.proxy(this.destroy,this)),this.triggerPaste=e.helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=e.helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var t=n.getSettings(),o=t.copyRowsLimit,i=t.copyColsLimit,r=n.getSelectedRange(),s=r.getTopLeftCorner(),a=r.getBottomRightCorner(),l=s.row,c=s.col,u=a.row,h=a.col,d=Math.min(u,l+o-1),f=Math.min(h,c+i-1);n.copyPaste.copyPasteInstance.copyable(n.getCopyableData(l,c,d,f)),(u!==d||h!==f)&&e.hooks.run(n,"afterCopyLimit",u-l+1,h-c+1,o,i)}}function i(){var e=this,t=e.getSettings().copyPaste!==!1;t&&!e.copyPaste?e.copyPaste=new n(e):!t&&e.copyPaste&&(e.copyPaste.destroy(),delete e.copyPaste)}e.hooks.add("afterInit",i),e.hooks.add("afterUpdateSettings",i),e.hooks.register("afterCopyLimit")}(o,L,SheetClip),function(e){function t(){var t=this,o=!!t.getSettings().search;o?t.search=new e.Search(t):delete t.search}e.Search=function(t){this.query=function(o,n,i){var r=t.countRows(),s=t.countCols(),a=[];n||(n=e.Search.global.getDefaultCallback()),i||(i=e.Search.global.getDefaultQueryMethod());for(var l=0;r>l;l++)for(var c=0;s>c;c++){var u=t.getDataAtCell(l,c),h=t.getCellMeta(l,c),d=h.search.callback||n,f=h.search.queryMethod||i,p=f(o,u);if(p){var g={row:l,col:c,data:u};a.push(g)}d&&d(t,l,c,u,p)}return a}},e.Search.DEFAULT_CALLBACK=function(e,t,o,n,i){e.getCellMeta(t,o).isSearchResult=i},e.Search.DEFAULT_QUERY_METHOD=function(e,t){return"undefined"!=typeof e&&null!=e&&e.toLowerCase&&0!=e.length?"undefined"==typeof t||null==t?!1:-1!=t.toString().toLowerCase().indexOf(e.toLowerCase()):!1},e.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",e.Search.global=function(){var t=e.Search.DEFAULT_CALLBACK,o=e.Search.DEFAULT_QUERY_METHOD,n=e.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return t},setDefaultCallback:function(e){t=e},getDefaultQueryMethod:function(){return o},setDefaultQueryMethod:function(e){o=e},getDefaultSearchResultClass:function(){return n},setDefaultSearchResultClass:function(e){n=e}}}(),e.SearchCellDecorator=function(t,o,n,i,r,s,a){var l="object"==typeof a.search&&a.search.searchResultClass||e.Search.global.getDefaultSearchResultClass();a.isSearchResult?e.Dom.addClass(o,l):e.Dom.removeClass(o,l)};var o=e.renderers.cellDecorator;e.renderers.cellDecorator=function(){o.apply(this,arguments),e.SearchCellDecorator.apply(this,arguments)},e.hooks.add("afterInit",t),e.hooks.add("afterUpdateSettings",t)}(o),c.prototype.canMergeRange=function(e){return!e.isSingle()},c.prototype.mergeRange=function(e){if(this.canMergeRange(e)){var t=e.getTopLeftCorner(),o=e.getBottomRightCorner(),n={};n.row=t.row,n.col=t.col,n.rowspan=o.row-t.row+1,n.colspan=o.col-t.col+1,this.mergedCellInfoCollection.setInfo(n)}},c.prototype.mergeOrUnmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.from.row,e.from.col);t?this.unmergeSelection(e.from):this.mergeSelection(e)},c.prototype.mergeSelection=function(e){this.mergeRange(e)},c.prototype.unmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.row,e.col);this.mergedCellInfoCollection.removeInfo(t.row,t.col)},c.prototype.applySpanProperties=function(e,t,o){var n=this.mergedCellInfoCollection.getInfo(t,o);n?n.row===t&&n.col===o?(e.setAttribute("rowspan",n.rowspan),e.setAttribute("colspan",n.colspan)):e.style.display="none":(e.removeAttribute("rowspan"),e.removeAttribute("colspan"))},c.prototype.modifyTransform=function(e,t,o){var n=function(e,t){return t.row>=e.row&&t.row<=e.row+e.rowspan-1?!0:!1},i=function(e,t){return t.col>=e.col&&t.col<=e.col+e.colspan-1?!0:!1},r=function(e){return new f(t.to.row+e.row,t.to.col+e.col)},s={row:o.row,col:o.col};if("modifyTransformStart"==e){this.lastDesiredCoords||(this.lastDesiredCoords=new f(null,null));for(var a,l=new f(t.highlight.row,t.highlight.col),c=this.mergedCellInfoCollection.getInfo(l.row,l.col),u=0,h=this.mergedCellInfoCollection.length;h>u;u++){var d=this.mergedCellInfoCollection[u];if(d=new f(d.row+d.rowspan-1,d.col+d.colspan-1),t.includes(d)){a=!0;break}}if(c){var g=new f(c.row,c.col),m=new f(c.row+c.rowspan-1,c.col+c.colspan-1),w=new p(g,g,m);w.includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new f(null,null)),s.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-l.row:s.row,s.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-l.col:s.col,o.row>0?s.row=c.row+c.rowspan-1-l.row+o.row:o.row<0&&(s.row=l.row-c.row+o.row),o.col>0?s.col=c.col+c.colspan-1-l.col+o.col:o.col<0&&(s.col=l.col-c.col+o.col)}var v=new f(t.highlight.row+s.row,t.highlight.col+s.col),y=this.mergedCellInfoCollection.getInfo(v.row,v.col);y&&(this.lastDesiredCoords=v,s={row:y.row-l.row,col:y.col-l.col})}else if("modifyTransformEnd"==e)for(var u=0,h=this.mergedCellInfoCollection.length;h>u;u++){var C=this.mergedCellInfoCollection[u],g=new f(C.row,C.col),m=new f(C.row+C.rowspan-1,C.col+C.colspan-1),b=new p(g,g,m),S=t.getBordersSharedWith(b);if(b.isEqual(t))t.setDirection("NW-SE");else if(S.length>0){var R=t.highlight.isEqual(b.from);S.indexOf("top")>-1?t.to.isSouthEastOf(b.from)&&R?t.setDirection("NW-SE"):t.to.isSouthWestOf(b.from)&&R&&t.setDirection("NE-SW"):S.indexOf("bottom")>-1&&(t.to.isNorthEastOf(b.from)&&R?t.setDirection("SW-NE"):t.to.isNorthWestOf(b.from)&&R&&t.setDirection("SE-NW"))}var v=r(s),T=n(C,v),E=i(C,v);t.includesRange(b)&&(b.includes(v)||T||E)&&(T&&(s.row<0?s.row-=C.rowspan-1:s.row>0&&(s.row+=C.rowspan-1)),E&&(s.col<0?s.col-=C.colspan-1:s.col>0&&(s.col+=C.colspan-1)))}0!=s.row&&(o.row=s.row),0!=s.col&&(o.col=s.col)},"undefined"==typeof o)throw new Error("Handsontable is not defined");var U=function(){var e=this,t=e.getSettings().mergeCells;t&&(e.mergeCells||(e.mergeCells=new c(t)))},$=function(){var e=this;e.mergeCells&&(e.view.wt.wtTable.getCell=function(t){if(e.getSettings().mergeCells){var o=e.mergeCells.mergedCellInfoCollection.getInfo(t.row,t.col);o&&(t=o)}return H.prototype.getCell.call(this,t)})},K=function(e){if(this.mergeCells){var t=(e.ctrlKey||e.metaKey)&&!e.altKey;t&&77===e.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),e.stopImmediatePropagation())}},X=function(e){this.getSettings().mergeCells&&(e.items.push(o.ContextMenu.SEPARATOR),e.items.push({key:"mergeCells",name:function(){var e=this.getSelected(),t=this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1]);return t?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render()},disabled:function(){return!1}}))},_=function(e,t,o){this.mergeCells&&this.mergeCells.applySpanProperties(e,t,o)},q=function(e){return function(t){var o=this.getSettings().mergeCells;if(o){var n=this.getSelectedRange();if(this.mergeCells.modifyTransform(e,n,t),"modifyTransformEnd"===e){var i=this.countRows(),r=this.countCols();n.from.row<0?n.from.row=0:n.from.row>0&&n.from.row>=i&&(n.from.row=n.from-1),n.from.col<0?n.from.col=0:n.from.col>0&&n.from.col>=r&&(n.from.col=r-1)}}}},Y=function(e){this.lastDesiredCoords=null;var t=this.getSettings().mergeCells;if(t){var o=this.getSelectedRange();o.highlight=new f(o.highlight.row,o.highlight.col),o.to=e;var n=!1;do{n=!1;for(var i=0,r=this.mergeCells.mergedCellInfoCollection.length;r>i;i++){var s=this.mergeCells.mergedCellInfoCollection[i],a=new f(s.row,s.col),l=new f(s.row+s.rowspan-1,s.col+s.colspan-1),c=new p(a,a,l);
o.expandByRange(c)&&(e.row=o.to.row,e.col=o.to.col,n=!0)}}while(n)}},Q=function(e,t){if(t&&"area"==t){var o=this.getSettings().mergeCells;if(o)for(var n=this.getSelectedRange(),i=new p(n.from,n.from,n.from),r=new p(n.to,n.to,n.to),s=0,a=this.mergeCells.mergedCellInfoCollection.length;a>s;s++){var l=this.mergeCells.mergedCellInfoCollection[s],c=new f(l.row,l.col),u=new f(l.row+l.rowspan-1,l.col+l.colspan-1),h=new p(c,c,u);i.expandByRange(h)&&(e[0]=i.from.row,e[1]=i.from.col),r.expandByRange(h)&&(e[2]=r.from.row,e[3]=r.from.col)}}},J=function(e,t,o){var n=this.getSettings().mergeCells;if(n){var i=this.mergeCells.mergedCellInfoCollection.getInfo(e,t);!i||i.row==e&&i.col==t||(o.copyable=!1)}},Z=function(e){if(e&&this.mergeCells){var t=this.mergeCells.mergedCellInfoCollection,o=this.getSelectedRange();for(var n in t)if(o.highlight.row==t[n].row&&o.highlight.col==t[n].col&&o.to.row==t[n].row+t[n].rowspan-1&&o.to.col==t[n].col+t[n].colspan-1)return!1}return e};o.hooks.add("beforeInit",U),o.hooks.add("afterInit",$),o.hooks.add("beforeKeyDown",K),o.hooks.add("modifyTransformStart",q("modifyTransformStart")),o.hooks.add("modifyTransformEnd",q("modifyTransformEnd")),o.hooks.add("beforeSetRangeEnd",Y),o.hooks.add("beforeDrawBorders",Q),o.hooks.add("afterIsMultipleSelection",Z),o.hooks.add("afterRenderer",_),o.hooks.add("afterContextMenuDefaultOptions",X),o.hooks.add("afterGetCellMeta",J),o.MergeCells=c,function(){function e(){}var t,n=function(e){return"boolean"==typeof e&&1==e?!0:"object"==typeof e&&e.length>0?!0:!1},i=function(){n(this.getSettings().customBorders)&&(this.customBorders||(t=this,this.customBorders=new e))},r=function(e){for(var o=0;o<t.view.wt.selections.length;o++)if(t.view.wt.selections[o].settings.className==e)return o;return-1},s=function(e){var o={row:e.row,col:e.col},n=new x(e,new p(o,o,o)),i=r(e.className);i>=0?t.view.wt.selections[i]=n:t.view.wt.selections.push(n)},a=function(e,t,o){var n=f(e,t);n=g(n,o),this.setCellMeta(e,t,"borders",n),s(n)},l=function(e){for(var t=e.range,o=t.from.row;o<=t.to.row;o++)for(var n=t.from.col;n<=t.to.col;n++){var i=f(o,n),r=0;o==t.from.row&&(r++,e.hasOwnProperty("top")&&(i.top=e.top)),o==t.to.row&&(r++,e.hasOwnProperty("bottom")&&(i.bottom=e.bottom)),n==t.from.col&&(r++,e.hasOwnProperty("left")&&(i.left=e.left)),n==t.to.col&&(r++,e.hasOwnProperty("right")&&(i.right=e.right)),r>0&&(this.setCellMeta(o,n,"borders",i),s(i))}},c=function(e,t){return"border_row"+e+"col"+t},u=function(){return{width:1,color:"#000"}},h=function(){return{hide:!0}},d=function(){return{width:1,color:"#000",cornerVisible:!1}},f=function(e,t){return{className:c(e,t),border:d(),row:e,col:t,top:h(),right:h(),bottom:h(),left:h()}},g=function(e,t){return t.hasOwnProperty("border")&&(e.border=t.border),t.hasOwnProperty("top")&&(e.top=t.top),t.hasOwnProperty("right")&&(e.right=t.right),t.hasOwnProperty("bottom")&&(e.bottom=t.bottom),t.hasOwnProperty("left")&&(e.left=t.left),e},m=function(e){for(var t=document.getElementsByClassName(e),o=0;o<t.length;o++)if(t[o]&&"TD"!=t[o].nodeName){var n=t[o].parentNode;n.parentNode.removeChild(n)}},w=function(e,t){var o=c(e,t);m(o),this.removeCellMeta(e,t,"borders")},v=function(e,t,o,n){var i=this.getCellMeta(e,t).borders;i&&void 0!=i.border||(i=f(e,t)),i[o]=n?h():u(),this.setCellMeta(e,t,"borders",i);var r=c(e,t);m(r),s(i),this.render()},y=function(e,t,o){if(e.from.row==e.to.row&&e.from.col==e.to.col)"noBorders"==t?w.call(this,e.from.row,e.from.col):v.call(this,e.from.row,e.from.col,t,o);else switch(t){case"noBorders":for(var n=e.from.col;n<=e.to.col;n++)for(var i=e.from.row;i<=e.to.row;i++)w.call(this,i,n);break;case"top":for(var r=e.from.col;r<=e.to.col;r++)v.call(this,e.from.row,r,t,o);break;case"right":for(var s=e.from.row;s<=e.to.row;s++)v.call(this,s,e.to.col,t);break;case"bottom":for(var a=e.from.col;a<=e.to.col;a++)v.call(this,e.to.row,a,t);break;case"left":for(var l=e.from.row;l<=e.to.row;l++)v.call(this,l,e.from.col,t)}},C=function(e,t){var o=!1;return e.getSelectedRange().forAll(function(n,i){var r=e.getCellMeta(n,i).borders;if(r){if(!t)return o=!0,!1;if(!r[t].hasOwnProperty("hide"))return o=!0,!1}}),o},b=function(e){return"<span class='selected'>✓</span>"+e},S=function(e){this.getSettings().customBorders&&(e.items.push(o.ContextMenu.SEPARATOR),e.items.push({key:"borders",name:"Borders",submenu:{items:{top:{name:function(){var e="Top",t=C(this,"top");return t&&(e=b(e)),e},callback:function(){var e=C(this,"top");y.call(this,this.getSelectedRange(),"top",e)},disabled:!1},right:{name:function(){var e="Right",t=C(this,"right");return t&&(e=b(e)),e},callback:function(){var e=C(this,"right");y.call(this,this.getSelectedRange(),"right",e)},disabled:!1},bottom:{name:function(){var e="Bottom",t=C(this,"bottom");return t&&(e=b(e)),e},callback:function(){var e=C(this,"bottom");y.call(this,this.getSelectedRange(),"bottom",e)},disabled:!1},left:{name:function(){var e="Left",t=C(this,"left");return t&&(e=b(e)),e},callback:function(){var e=C(this,"left");y.call(this,this.getSelectedRange(),"left",e)},disabled:!1},remove:{name:"Remove border(s)",callback:function(){y.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!C(this)}}}}}))};o.hooks.add("beforeInit",i),o.hooks.add("afterContextMenuDefaultOptions",S),o.hooks.add("afterInit",function(){var e=this.getSettings().customBorders;if(e){for(var t=0;t<e.length;t++)e[t].range?l.call(this,e[t]):a.call(this,e[t].row,e[t].col,e[t]);this.render(),this.view.wt.draw(!0)}}),o.CustomBorders=e}(),function(o){function n(){function n(e){G=this,f=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){d=t;var o=f.getBoundingClientRect();h=o.top,p.style.top=h+"px",p.style.left=o.left+"px",G.rootElement[0].appendChild(p)}}function i(e){var t=e.getBoundingClientRect();p.style.top=t.top+"px"}function r(){var e=this;o.Dom.addClass(p,"active"),o.Dom.addClass(g,"active");var t=f.getBoundingClientRect();g.style.width=e.view.maximumVisibleElementWidth(0)+"px",g.style.height=t.height+"px",g.style.top=h+"px",g.style.left=p.style.left,e.rootElement[0].appendChild(g)}function s(e){g.style.top=h+e+"px"}function a(){o.Dom.removeClass(p,"active"),o.Dom.removeClass(g,"active")}var l,c,u,h,d,f,p=document.createElement("DIV"),g=document.createElement("DIV"),m=e(t);p.className="manualRowMover",g.className="manualRowMoverGuide";var w=function(){var e=this;o.hooks.run(e,"persistentStateSave","manualRowPositions",e.manualRowPositions)},v=function(){var e=this,t={};return o.hooks.run(e,"persistentStateLoad","manualRowPositions",t),t.value},y=function(){var e,t=this;t.rootElement.on("mouseenter.manualRowMove."+t.guid,"table tbody tr > th",function(o){e?(c=t.view.wt.wtTable.getCoords(o.currentTarget).row,i(o.currentTarget)):n.call(t,o.currentTarget)}),t.rootElement.on("mousedown.manualRowMove."+t.guid,".manualRowMover",function(o){u=o.pageY,r.call(t),e=t,l=d,c=d}),m.on("mousemove.manualRowMove."+t.guid,function(t){e&&s(t.pageY-u)}),m.on("mouseup.manualRowMove."+t.guid,function(){e&&(a(),e=!1,c>l&&c--,b(t.manualRowPositions,t.countRows()),t.manualRowPositions.splice(c,0,t.manualRowPositions.splice(l,1)[0]),t.forceFullRender=!0,t.view.render(),w.call(t),o.hooks.run(t,"afterRowMove",l,c),n.call(t,f))}),t.addHook("afterDestroy",C)},C=function(){var e=this;e.rootElement.off("mouseenter.manualRowMove."+e.guid,"table tbody tr > th"),e.rootElement.off("mousedown.manualRowMove."+e.guid,".manualRowMover"),m.off("mousemove.manualRowMove."+e.guid),m.off("mouseup.manualRowMove."+e.guid)},b=function(e,t){if(e.length<t)for(var o=e.length;t>o;o++)e[o]=o};this.beforeInit=function(){this.manualRowPositions=[]},this.init=function(e){var t=this,o=!!t.getSettings().manualRowMove;if(o){var n=t.getSettings().manualRowMove,i=v.call(t);this.manualRowPositions="undefined"!=typeof i?i:n instanceof Array?n:[],"afterInit"===e&&(y.call(this),this.manualRowPositions.length>0&&(t.forceFullRender=!0,t.render()))}else C.call(this),t.manualRowPositions=[]},this.modifyRow=function(e){var t=this;return t.getSettings().manualRowMove?("undefined"==typeof t.manualRowPositions[e]&&b(this.manualRowPositions,e+1),t.manualRowPositions[e]):e}}var i=new n;o.hooks.add("beforeInit",i.beforeInit),o.hooks.add("afterInit",function(){i.init.call(this,"afterInit")}),o.hooks.add("afterUpdateSettings",function(){i.init.call(this,"afterUpdateSettings")}),o.hooks.add("modifyRow",i.modifyRow),o.hooks.register("afterRowMove")}(o),function(o){function n(n){this.instance=n,this.addingStarted=!1;var i,r,s=(e(document),!1),a=this,l=function(){return n.autofill?void(n.autofill.handle&&n.autofill.handle.isDragged&&(n.autofill.handle.isDragged>1&&n.autofill.apply(),n.autofill.handle.isDragged=0,s=!1)):!0};e(document).off("mouseup.autofill."+n.guid,this.instance.rootElement).on("mouseup.autofill."+n.guid,this.instance.rootElement,function(e){l(e)}),e(document).off("mousemove.moveOutside_"+n.guid).on("mousemove.moveOutside_"+n.guid,function(e){if(!a.instance.autofill)return 0;var n=o.Dom.offset(a.instance.$table[0]).top-(t.pageYOffset||document.documentElement.scrollTop)+o.Dom.outerHeight(a.instance.$table[0]),i=o.Dom.offset(a.instance.$table[0]).left-(t.pageXOffset||document.documentElement.scrollLeft)+o.Dom.outerWidth(a.instance.$table[0]);a.addingStarted===!1&&a.instance.autofill.handle.isDragged>0&&e.clientY>n&&e.clientX<=i?(this.mouseDragOutside=!0,a.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&setTimeout(function(){a.addingStarted=!1,a.instance.alter("insert_row")},200)}),i=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown,this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(e){n.autofill.handle.isDragged=1,s=!0,i(e)},r=this.instance.view.wt.wtSettings.settings.onCellMouseOver,this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(e,t,o,i){n.autofill&&s&&!n.view.isMouseDown()&&n.autofill.handle&&n.autofill.handle.isDragged&&(n.autofill.handle.isDragged++,n.autofill.showBorder(t),n.autofill.checkIfNewRowNeeded()),r(e,t,o,i)},this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){n.autofill.selectAdjacent()}}n.prototype.init=function(){this.handle={}},n.prototype.disable=function(){this.handle.disabled=!0},n.prototype.selectAdjacent=function(){var e,t,o,n,i;e=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),t=this.instance.getData();e:for(o=e[2]+1;o<this.instance.countRows();o++){for(i=e[1];i<=e[3];i++)if(t[o][i])break e;(t[o][e[1]-1]||t[o][e[3]+1])&&(n=o)}n&&(this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(new f(e[0],e[1])),this.instance.view.wt.selections.fill.add(new f(n,e[3])),this.apply())},n.prototype.apply=function(){var e,t,n,i,r;if(this.handle.isDragged=0,e=this.instance.view.wt.selections.fill.getCorners())if(this.instance.view.wt.selections.fill.clear(),t=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),e[0]===t[0]&&e[1]<t[1]?(n=new f(e[0],e[1]),i=new f(e[2],t[1]-1)):e[0]===t[0]&&e[3]>t[3]?(n=new f(e[0],t[3]+1),i=new f(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(n=new f(e[0],e[1]),i=new f(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(n=new f(t[2]+1,e[1]),i=new f(e[2],e[3])),n&&n.row>-1&&n.col>-1){var s={from:this.instance.getSelectedRange().from,to:this.instance.getSelectedRange().to};r=this.instance.getData(s.from.row,s.from.col,s.to.row,s.to.col),o.hooks.run(this.instance,"beforeAutofill",n,i,r),this.instance.populateFromArray(n.row,n.col,r,i.row,i.col,"autofill"),this.instance.selection.setRangeStart(new f(e[0],e[1])),this.instance.selection.setRangeEnd(new f(e[2],e[3]))}else this.instance.selection.refreshBorders()},n.prototype.showBorder=function(e){var t=this.instance.getSelectedRange().getTopLeftCorner(),o=this.instance.getSelectedRange().getBottomRightCorner();if("horizontal"!==this.instance.getSettings().fillHandle&&(o.row<e.row||t.row>e.row))e=new f(e.row,o.col);else{if("vertical"===this.instance.getSettings().fillHandle)return;e=new f(o.row,e.col)}this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to),this.instance.view.wt.selections.fill.add(e),this.instance.view.render()},n.prototype.checkIfNewRowNeeded=function(){var e,t,o=this.instance.countRows(),n=this;this.instance.view.wt.selections.fill.cellRange&&this.addingStarted===!1&&(t=this.instance.getSelected(),e=this.instance.view.wt.selections.fill.getCorners(),t[2]<o-1&&e[2]===o-1&&(this.addingStarted=!0,this.instance._registerTimeout(setTimeout(function(){n.instance.alter("insert_row"),n.addingStarted=!1},200))))},o.hooks.add("afterInit",function(){var e=new n(this);"undefined"!=typeof this.getSettings().fillHandle&&(e.handle&&this.getSettings().fillHandle===!1?e.disable():e.handle||this.getSettings().fillHandle===!1||(this.autofill=e,this.autofill.init()))}),o.Autofill=n}(o);var et=function(e){var t=[],n={rows:0,cols:0},i={rows:0,cols:0},r=[],s=[],a={groupIndicatorContainer:"htGroupIndicatorContainer",groupIndicator:function(e){return"ht"+e+"Group"},groupStart:"htGroupStart",collapseButton:"htCollapseButton",expandButton:"htExpandButton",collapseGroupId:function(e){return"htCollapse-"+e},collapseFromLevel:function(e,t){return"htCollapse"+e+"FromLevel-"+t},clickable:"clickable",levelTrigger:"htGroupLevelTrigger"},l=function(e,t){return function(o,n){return"undefined"==typeof t||"asc"===t?o[e]-n[e]:n[e]-o[e]}},c=function(e,t){for(var o=[];t>=e;)o.push(e++);return o},u=function(e,t,o){var n=[],i={row:null,col:null};if("cols"==e)for(;o>=t;)i={row:-1,col:t++},n.push(i);else for(;o>=t;)i={row:t++,col:-1},n.push(i);for(var r=h(n),s=0,a=0,l=0;l<r.length;l++)s+=r[l].filter(function(e){return e.rows}).length,a+=r[l].filter(function(e){return e.cols}).length;return{total:{rows:s,cols:a},groups:r}},h=function(e){for(var t=[],o=0;o<e.length;o++)t.push(d(e[o]));return t},d=function(e,o,n){for(var i=e.row,r=e.col,s=-1===i?0:i,a=-1===r?0:r,l=[],c=0;c<t.length;c++){var u=t[c],h=u.id,d=(u.level,u.rows||[]),f=u.cols||[];-1===l.indexOf(h)&&(-1!==d.indexOf(s)||-1!==f.indexOf(a))&&l.push(u)}-1===r?l=l.concat(w()):-1===i&&(l=l.concat(y())),o&&(l=l.filter(function(e){return e.level===o})),n&&("cols"===n?l=l.filter(function(e){return e.cols}):"rows"===n&&(l=l.filter(function(e){return e.rows})));var p=[];return l.filter(function(e){return-1===p.indexOf(e.id)?(p.push(e.id),e):void 0})},p=function(e){for(var o=0,n=t.length;n>o;o++)if(t[o].id==e)return t[o];return!1},g=function(e,o){for(var n=0,i=t.length;i>n;n++)if(t[n].level==o&&t[n].rows&&t[n].rows.indexOf(e)>-1)return t[n];return!1},m=function(e,o){for(var n=0,i=t.length;i>n;n++)if(t[n].level==o&&t[n].cols&&t[n].cols.indexOf(e)>-1)return t[n];return!1},w=function(){for(var e=[],o=0,n=t.length;n>o;o++)t[o].cols instanceof Array&&e.push(t[o]);return e},v=function(e){for(var o=[],n=0,i=t.length;i>n;n++)t[n].cols&&t[n].level===e&&o.push(t[n]);return o},y=function(){for(var e=[],o=0,n=t.length;n>o;o++)t[o].rows instanceof Array&&e.push(t[o]);return e},C=function(e){for(var o=[],n=0,i=t.length;i>n;n++)t[n].rows&&t[n].level===e&&o.push(t[n]);return o},b=function(e){var t=0;return e.length&&e.forEach(function(e){if(e=e.filter(function(e){return e.cols}),e.length){var o=e.sort(l("level","desc")),n=o[0].level;n>t&&(t=n)}}),t},S=function(e){var t=0;return e.length&&e.forEach(function(e){if(e=e.filter(function(e){return e.rows}),e.length){var o=e.sort(l("level","desc")),n=o[0].level;n>t&&(t=n)}}),t},R=function(e,o){var r=u("cols",e,o),s=b(r.groups);s===i.cols?i.cols++:s>i.cols&&(i.cols=s+1),n.cols||(n.cols=w().length),n.cols++,t.push({id:"c"+n.cols,level:s+1,cols:c(e,o),hidden:0})},T=function(e,o){var r=u("rows",e,o),s=S(r.groups);i.rows=Math.max(i.rows,s+1),n.rows||(n.rows=y().length),n.rows++,t.push({id:"r"+n.rows,level:s+1,rows:c(e,o),hidden:0})},E=function(e,t){for(var o,n=0,i=t.length;i>n;n++)if(t[n].hidden=e,o=t[n].level,r[o]||(r[o]=[]),s[o]||(s[o]=[]),t[n].rows)for(var a=0,l=t[n].rows.length;l>a;a++)r[o][t[n].rows[a]]=e>0?!0:void 0;else if(t[n].cols)for(var a=0,c=t[n].cols.length;c>a;a++)s[o][t[n].cols[a]]=e>0?!0:void 0},k=function(e,t,n,i){var r,s;switch(e){case"rows":r=g(t+1,n).id,s=o.Grouping.getGroupLevelsByRows();break;case"cols":r=m(t+1,n).id,s=o.Grouping.getGroupLevelsByCols()}return!!(s[t+1]&&s[t+1].indexOf(n)>-1&&i==r)},D=function(e,t,n,i){var r,s;switch(e){case"rows":r=g(t-1,n).id,s=o.Grouping.getGroupLevelsByRows();break;case"cols":r=m(t-1,n).id,s=o.Grouping.getGroupLevelsByCols()}return!!(s[t-1]&&s[t-1].indexOf(n)>-1&&i==r)},x=function(t,n,a,l){if(0===n)return!1;var c,u,h=D(t,n,a,l),d=k(t,n,a,l),f=!1;switch(t){case"rows":c=o.Grouping.getGroupLevelsByRows(),u=e.countRows();for(var p=0;p<=i.rows;p++)if(r[p]&&r[p][n+1]){f=!0;break}break;case"cols":c=o.Grouping.getGroupLevelsByCols(),u=e.countCols();for(var p=0;p<=i.cols;p++)if(s[p]&&s[p][n+1]){f=!0;break}}if(h){if(n==u-1)return!0;if(!d||d&&f)return!0;if(!c[n+1])return!0}return!1},A=function(t){var o;switch(t){case"rows":o=i.rows;for(var n=0;o>=n;n++)if(r[n]&&r[n][e.countRows()-1])return!0;break;case"cols":o=i.cols;for(var n=0;o>=n;n++)if(s[n]&&s[n][e.countCols()-1])return!0}return!1},H=function(t,n,a,l){var c,u,h,d=p(l),f=!1,g=function(e){for(var t=!1,o="rows"==e?r:s,a=0;a<=i[e];a++){for(h=n;d[e].indexOf(h)>-1;)t=!(!o[a]||!o[a][h]),h--;if(t)break}return t},m=D(t,n,a,l),w=k(t,n,a,l);switch(t){case"rows":c=o.Grouping.getGroupLevelsByRows(),u=e.countRows(),f=g(t);break;case"cols":c=o.Grouping.getGroupLevelsByCols(),u=e.countCols(),f=g(t)}if(n==u-1)return!1;if(0==n){if(w)return!0}else if(!m||m&&f){if(w)return!0}else if(!c[n-1]&&w)return!0;return!1},O=function(e,t,n,i,r){var s;switch(e){case"rows":s=g(t-1,n).id;break;case"cols":s=m(t-1,n).id}if(!s)return null;if(t>0&&D(e,t-1,n,s)&&s!=i){var l=document.createElement("DIV");return o.Dom.addClass(l,a.expandButton),l.id="htExpand-"+s,l.appendChild(document.createTextNode("+")),l.setAttribute("data-level",n),l.setAttribute("data-type",e),l.setAttribute("data-hidden","1"),r.appendChild(l),l}return null},M=function(e){for(var t=y(),o=w(),n=0,i=t.length;i>n;n++)if(t[n].rows.indexOf(e.row)>-1&&t[n].hidden)return!0;if(null===e.col)return!1;for(var n=0,r=o.length;r>n;n++)if(o[n].cols.indexOf(e.col)>-1&&o[n].hidden)return!0;return!1};return{getGroups:function(){return t},getLevels:function(){return i},instance:e,baseSpareRows:e.getSettings().minSpareRows,baseSpareCols:e.getSettings().minSpareCols,getRowGroups:y,getColGroups:w,init:function(){var t=e.getSettings().groups;t&&t instanceof Array&&o.Grouping.initGroups(t)},initGroups:function(e){t=[],e.forEach(function(e){var t=[],o=!1,n=!1;e.rows instanceof Array?(t=e.rows,o=!0):e.cols instanceof Array&&(t=e.cols,n=!0);var i=t[0],r=t[t.length-1];o?T(i,r):n&&R(i,r)})},resetGroups:function(){t=[],n={rows:0,cols:0},i={rows:0,cols:0};var e;for(var r in a)if("function"!=typeof a[r]){e=document.querySelectorAll("."+a[r]);for(var s=0,l=e.length;l>s;s++)o.Dom.removeClass(e[s],a[r])}for(var c=["htGroupColClosest","htGroupCol"],r=0,u=c.length;u>r;r++){e=document.querySelectorAll("."+c[r]);for(var s=0,l=e.length;l>s;s++)o.Dom.removeClass(e[s],c[r])}},updateGroups:function(){var e=this.getSettings().groups;o.Grouping.resetGroups(),o.Grouping.initGroups(e)},afterGetRowHeader:function(e,t){for(var n=!1,i=0,s=r.length;s>i;i++)r[i]&&r[i][e]===!0&&(n=!0);n?o.Dom.addClass(t.parentNode,"hidden"):!n&&o.Dom.hasClass(t.parentNode,"hidden")&&o.Dom.removeClass(t.parentNode,"hidden")},afterGetColHeader:function(t){var n=this.view.wt.wtSettings.getSetting("rowHeaders").length,i=e.rootElement[0].querySelectorAll("colgroup col:nth-child("+parseInt(t+n+1,10)+")");if(0!==i.length){for(var r=!1,a=0,l=s.length;l>a;a++)s[a]&&s[a][t]===!0&&(r=!0);if(r)for(var a=0,c=i.length;c>a;a++)o.Dom.addClass(i[a],"hidden");else if(!r&&o.Dom.hasClass(i[0],"hidden"))for(var a=0,c=i.length;c>a;a++)o.Dom.removeClass(i[a],"hidden")}},groupIndicatorsFactory:function(e,t){var r,s,l,c,u,h,d,f;switch(t){case"horizontal":r=o.Grouping.getGroupLevelsByCols(),s=function(e){return Array.prototype.indexOf.call(e.parentNode.parentNode.childNodes,e.parentNode)+1},l=function(e,t){return m(e,t).id},c="cols",u=function(e,t){return m(e-1,t)},h="columnHeaders",d=function(e){if(1===e.length){var t=e[0];e[0]=function(e,n,i){-1>e?w()(e,n,i):(o.Dom.removeClass(n,a.groupIndicatorContainer),t(e,n,i))}}return function(){return e}},f=!0;break;case"vertical":r=o.Grouping.getGroupLevelsByRows(),s=function(e){return o.Dom.index(e)+1},l=function(e,t){return g(e,t).id},c="rows",u=function(e,t){return g(e-1,t)},h="rowHeaders",d=function(e){return e}}var p=function(e){var t=document.createElement("div");return e.appendChild(t),{button:t,addClass:function(e){o.Dom.addClass(t,e)}}},w=function(){var e=t.charAt(0).toUpperCase()+t.slice(1);return function(t,n,i){i++;for(var s,h;s=n.lastChild;)n.removeChild(s);o.Dom.addClass(n,a.groupIndicatorContainer);var d=l(t,i);if(t>-1&&r[t]&&r[t].indexOf(i)>-1&&(h=p(n),h.addClass(a.groupIndicator(e)),H(c,t,i,d)&&h.addClass(a.groupStart),x(c,t,i,d)&&(h.button.appendChild(document.createTextNode("-")),h.addClass(a.collapseButton),h.button.id=a.collapseGroupId(d),h.button.setAttribute("data-level",i),h.button.setAttribute("data-type",c))),f){var g=o.Dom.index(n.parentNode);if(-1===t||-1>t&&g===o.Grouping.getLevels().cols+1||0==g&&0==o.Grouping.getLevels().cols)if(h=p(n),h.addClass(a.levelTrigger),-1===t)h.button.id=a.collapseFromLevel("Cols",i),h.button.appendChild(document.createTextNode(i));else if(-1>t&&g===o.Grouping.getLevels().cols+1||0==g&&0==o.Grouping.getLevels().cols){var m=o.Dom.index(n)+1;h.button.id=a.collapseFromLevel("Rows",m),h.button.appendChild(document.createTextNode(m))}}var w=O(c,t,i,d,n);if(t>0){var v=u(t-1,i);w&&v.hidden&&o.Dom.addClass(w,a.clickable)}tt()}};if(e=d(e),n[c]>0)for(var v=0;v<i[c]+1;v++)e instanceof Array||(e="function"==typeof e?e():new Array(e)),e.unshift(w())},getGroupLevelsByRows:function(){for(var e=y(),t=[],o=0,n=e.length;n>o;o++)if(e[o].rows)for(var i=0,r=e[o].rows.length;r>i;i++)t[e[o].rows[i]]||(t[e[o].rows[i]]=[]),t[e[o].rows[i]].push(e[o].level);return t},getGroupLevelsByCols:function(){for(var e=w(),t=[],o=0,n=e.length;n>o;o++)if(e[o].cols)for(var i=0,r=e[o].cols.length;r>i;i++)t[e[o].cols[i]]||(t[e[o].cols[i]]=[]),t[e[o].cols[i]].push(e[o].level);return t},toggleGroupVisibility:function(t){if(o.Dom.hasClass(t.target,a.expandButton)||o.Dom.hasClass(t.target,a.collapseButton)||o.Dom.hasClass(t.target,a.levelTrigger)){var n,r,s,l,c=t.target,u=c.id.split("-"),h=[],d=function(e){e&&(c=e),u=c.id.split("-"),n=u[1],r=parseInt(c.getAttribute("data-level"),10),s=c.getAttribute("data-type"),l=parseInt(c.getAttribute("data-hidden")),l=isNaN(l)?1:l?0:1,c.setAttribute("data-hidden",l.toString()),h.push(p(n))};if(c.className.indexOf(a.levelTrigger)>-1){for(var f,g=[],m=[],w=c.id.indexOf("Rows")>-1?"rows":"cols",y=1,b=i[w];b>=y;y++)if(f="rows"==w?C(y):v(y),y>=parseInt(u[1],10))for(var S=0,R=f.length;R>S;S++)m.push(f[S]);else for(var S=0,R=f.length;R>S;S++)g.push(f[S]);E(!0,m),E(!1,g)}else d(),E(l,h);s=s||w;var T=A(s),k=s.charAt(0).toUpperCase()+s.slice(1),D=o.Grouping["baseSpare"+k];T?0==D&&(e.alter("insert_"+s.slice(0,-1),e["count"+k]()),o.Grouping["dummy"+s.slice(0,-1)]=!0):0==D&&o.Grouping["dummy"+s.slice(0,-1)]&&(e.alter("remove_"+s.slice(0,-1),e["count"+k]()-1),o.Grouping["dummy"+s.slice(0,-1)]=!1),e.render(),t.stopImmediatePropagation()}},modifySelectionFactory:function(e){var t,o=this.instance,n=new f(0,0),i=function(e,t){var o=0;switch(e){case"down":for(;M(t);)o++,t.row+=1;break;case"up":for(;M(t);)o--,t.row-=1;break;case"right":for(;M(t);)o++,t.col+=1;break;case"left":for(;M(t);)o--,t.col-=1}return o},r=function(e,t){e.row>0?M(t)&&(e.row+=i("down",t)):e.row<0&&M(t)&&(e.row+=i("up",t)),e.col>0?M(t)&&(e.col+=i("right",t)):e.col<0&&M(t)&&(e.col+=i("left",t))};switch(e){case"start":return function(e){t=o.getSelected(),n.row=t[0]+e.row,n.col=t[1]+e.col,r(e,n)};case"end":return function(e){t=o.getSelected(),n.row=t[2]+e.row,n.col=t[3]+e.col,r(e,n)}}},modifyRowHeight:function(t,o){return e.view.wt.wtTable.rowFilter&&M({row:o,col:null})?0:void 0},validateGroups:function(){for(var t=function(e,t){return e[0]<t[0]&&e[1]<t[1]&&t[0]<=e[1]||e[0]>t[0]&&t[1]<e[1]&&e[0]<=t[1]?!0:void 0},o=e.getSettings().groups,n=[],i=[],r=0,s=o.length;s>r;r++)if(o[r].rows){if(1===o[r].rows.length)throw new Error("Grouping error:  Group {"+o[r].rows[0]+"} is invalid. Cannot define single-entry groups.");if(0===o[r].rows.length)throw new Error("Grouping error:  Cannot define empty groups.");i.push(o[r].rows);for(var a=0,l=i.length;l>a;a++)if(t(o[r].rows,i[a]))throw new Error("Grouping error:  ranges {"+o[r].rows[0]+", "+o[r].rows[1]+"} and {"+i[a][0]+", "+i[a][1]+"} are overlapping.")}else if(o[r].cols){if(1===o[r].cols.length)throw new Error("Grouping error:  Group {"+o[r].cols[0]+"} is invalid. Cannot define single-entry groups.");if(0===o[r].cols.length)throw new Error("Grouping error:  Cannot define empty groups.");n.push(o[r].cols);for(var a=0,c=n.length;c>a;a++)if(t(o[r].cols,n[a]))throw new Error("Grouping error:  ranges {"+o[r].cols[0]+", "+o[r].cols[1]+"} and {"+n[a][0]+", "+n[a][1]+"} are overlapping.")}return!0},afterGetRowHeaderRenderers:function(e){o.Grouping.groupIndicatorsFactory(e,"vertical")},afterGetColumnHeaderRenderers:function(e){o.Grouping.groupIndicatorsFactory(e,"horizontal")},hookProxy:function(t,n){return function(){return e.getSettings().groups?n?o.Grouping[t](n).apply(this,arguments):o.Grouping[t].apply(this,arguments):void 0}}}},V=function(){var e=this,t=!!e.getSettings().groups;if(t){var n={};o.Grouping=new et(e),e.getSettings().rowHeaders||(n.rowHeaders=!0),e.getSettings().colHeaders||(n.colHeaders=!0),(n.colHeaders||n.rowHeaders)&&e.updateSettings(n);var i=o.Grouping.validateGroups();if(!i)return;e.addHook("beforeInit",o.Grouping.hookProxy("init")),e.addHook("afterUpdateSettings",o.Grouping.hookProxy("updateGroups")),e.addHook("afterGetColumnHeaderRenderers",o.Grouping.hookProxy("afterGetColumnHeaderRenderers")),e.addHook("afterGetRowHeaderRenderers",o.Grouping.hookProxy("afterGetRowHeaderRenderers")),e.addHook("afterGetRowHeader",o.Grouping.hookProxy("afterGetRowHeader")),e.addHook("afterGetColHeader",o.Grouping.hookProxy("afterGetColHeader")),e.addHook("beforeOnCellMouseDown",o.Grouping.hookProxy("toggleGroupVisibility")),e.addHook("modifyTransformStart",o.Grouping.hookProxy("modifySelectionFactory","start")),e.addHook("modifyTransformEnd",o.Grouping.hookProxy("modifySelectionFactory","end")),e.addHook("modifyRowHeight",o.Grouping.hookProxy("modifyRowHeight"))}},tt=function(){for(var e=document.querySelectorAll("colgroup"),t=0,n=e.length;n>t;t++){var i=e[t].querySelectorAll("col.rowHeader");if(0==i.length)return;for(var r=0,s=i.length+1;s>r;r++){if(2==s)return;r<o.Grouping.getLevels().rows+1&&(r==o.Grouping.getLevels().rows?o.Dom.addClass(i[r],"htGroupColClosest"):o.Dom.addClass(i[r],"htGroupCol"))}}};if(o.hooks.add("beforeInit",V),o.hooks.add("afterUpdateSettings",function(){this.getSettings().groups&&!o.Grouping?V.call(this,arguments):!this.getSettings().groups&&o.Grouping&&(o.Grouping.resetGroups(),o.Grouping=void 0)}),o.plugins.Grouping=et,function(t){function o(){this.zeroClipboardInstance=null,this.instance=null}o.prototype.prepareZeroClipboard=function(){this.swfPath&&ZeroClipboard.config({swfPath:this.swfPath})},o.prototype.copy=function(){return this.instance.copyPaste.setCopyableText(),this.instance.copyPaste.copyPasteInstance.elTextarea.value},o.prototype.addToContextMenu=function(e){this.getSettings().contextMenuCopyPaste&&e.items.unshift({key:"copy",name:"Copy"},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()}},t.ContextMenu.SEPARATOR)},o.prototype.setupZeroClipboard=function(e){var o=this;if(this.cmInstance=e,t.Dom.hasClass(this.cmInstance.rootElement[0],"htContextMenu"))for(var i=e.getData(),r=0,s=i.length;s>r;r++)if("copy"===i[r].key){this.zeroClipboardInstance=new ZeroClipboard(e.getCell(r,0)),this.zeroClipboardInstance.off(),this.zeroClipboardInstance.on("copy",function(e){var t=e.clipboardData;t.setData("text/plain",o.copy()),o.instance.getSettings().outsideClickDeselects=o.outsideClickDeselectsCache}),n.bindEvents();break}},o.prototype.bindEvents=function(){var o=this;o.cmInstance&&(e(document).off("mouseenter."+o.cmInstance.guid).on("mouseenter."+o.cmInstance.guid,"#global-zeroclipboard-flash-bridge",function(){var e=o.cmInstance.rootElement[0].querySelector("td.current");e&&t.Dom.removeClass(e,"current"),o.outsideClickDeselectsCache=o.instance.getSettings().outsideClickDeselects,o.instance.getSettings().outsideClickDeselects=!1}),e(document).off("mouseleave."+o.cmInstance.guid).on("mouseleave."+o.cmInstance.guid,"#global-zeroclipboard-flash-bridge",function(){var e=o.cmInstance.rootElement[0].querySelector("td.zeroclipboard-is-hover");e&&t.Dom.removeClass(e,"zeroclipboard-is-hover"),o.instance.getSettings().outsideClickDeselects=o.outsideClickDeselectsCache}))},o.prototype.init=function(){if(this.getSettings().contextMenuCopyPaste){if("object"==typeof this.getSettings().contextMenuCopyPaste&&(n.swfPath=this.getSettings().contextMenuCopyPaste.swfPath),"undefined"==typeof ZeroClipboard)throw new Error("To be able to use the Copy/Paste feature from the context menu, you need to manualy include ZeroClipboard.js file to your website.");try{{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}}catch(e){if("undefined"==typeof navigator.mimeTypes["application/x-shockwave-flash"])throw new Error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.")}n.instance=this,n.prepareZeroClipboard()}};var n=new o;t.hooks.add("afterRender",function(){n.setupZeroClipboard(this)}),t.hooks.add("afterInit",n.init),t.hooks.add("afterContextMenuDefaultOptions",n.addToContextMenu),t.ContextMenuCopyPaste=o}(o),u.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE,this.fixed=this.instance.wtTable.hider,this.fixedContainer=this.instance.wtTable.holder,this.scrollHandler=this.getScrollableElement(this.TABLE),this.$scrollHandler=e(this.scrollHandler)},u.prototype.makeClone=function(e){var t=document.createElement("DIV");t.className="ht_clone_"+e+" handsontable",t.style.position="absolute",t.style.overflow="hidden";var o=document.createElement("TABLE");return o.className=this.instance.wtTable.TABLE.className,t.appendChild(o),this.instance.wtTable.holder.parentNode.appendChild(t),new w({cloneSource:this.instance,cloneOverlay:this,table:o})},u.prototype.getScrollableElement=function(e){for(var o=e.parentNode;o&&o.style;){if("visible"!==o.style.overflow&&""!==o.style.overflow)return o;if(this instanceof E&&"visible"!==o.style.overflowX&&""!==o.style.overflowX)return o;o=o.parentNode}return t},u.prototype.refresh=function(e){this.clone&&this.clone.draw(e)},u.prototype.destroy=function(){this.$scrollHandler.off("."+this.clone.guid),e(t).off("."+this.clone.guid),e(document).off("."+this.clone.guid),e(document.body).off("."+this.clone.guid)},h.prototype.getSize=function(e){return this.cellSizes[e]},h.prototype.getContainerSize=function(e){return"function"==typeof this.containerSizeFn?this.containerSizeFn(e):this.containerSizeFn},h.prototype.countVisible=function(){return this.cellCount},h.prototype.isLastIncomplete=function(){return this.remainingSize>0},d.prototype.appear=function(e){var t,n,i,r,s,a,l,c,u,h,d,p;if(!this.disabled){var g,m,w,v,y,C,b,S=this.instance;for(C=S.cloneOverlay instanceof k||S.cloneOverlay instanceof T?S.getSetting("fixedRowsTop"):S.wtTable.getRowStrategy().countVisible(),y=0;C>y;y++)if(b=S.wtTable.rowFilter.visibleToSource(y),b>=e[0]&&b<=e[2]){g=b;break}for(y=C-1;y>=0;y--)if(b=S.wtTable.rowFilter.visibleToSource(y),b>=e[0]&&b<=e[2]){w=b;break}for(C=S.cloneOverlay instanceof E||S.cloneOverlay instanceof T?S.getSetting("fixedColumnsLeft"):S.wtTable.getColumnStrategy().cellCount,y=0;C>y;y++)if(b=S.wtTable.columnFilter.visibleToSource(y),b>=e[1]&&b<=e[3]){m=b;
break}for(y=C-1;y>=0;y--)if(b=S.wtTable.columnFilter.visibleToSource(y),b>=e[1]&&b<=e[3]){v=b;break}if(void 0===g||void 0===m)return void this.disappear();t=g!==w||m!==v,n=S.wtTable.getCell(new f(g,m)),i=t?S.wtTable.getCell(new f(w,v)):n,r=o.Dom.offset(n),s=t?o.Dom.offset(i):r,a=o.Dom.offset(S.wtTable.TABLE),c=r.top,d=s.top+o.Dom.outerHeight(i)-c,h=r.left,p=s.left+o.Dom.outerWidth(i)-h,l=c-a.top-1,u=h-a.left-1;var R=o.Dom.getComputedStyle(n);parseInt(R.borderTopWidth,10)>0&&(l+=1,d=d>0?d-1:0),parseInt(R.borderLeftWidth,10)>0&&(u+=1,p=p>0?p-1:0),this.topStyle.top=l+"px",this.topStyle.left=u+"px",this.topStyle.width=p+"px",this.topStyle.display="block",this.leftStyle.top=l+"px",this.leftStyle.left=u+"px",this.leftStyle.height=d+"px",this.leftStyle.display="block";var D=Math.floor(this.settings.border.width/2);this.bottomStyle.top=l+d-D+"px",this.bottomStyle.left=u+"px",this.bottomStyle.width=p+"px",this.bottomStyle.display="block",this.rightStyle.top=l+"px",this.rightStyle.left=u+p-D+"px",this.rightStyle.height=d+1+"px",this.rightStyle.display="block",this.hasSetting(this.settings.border.cornerVisible)?(this.cornerStyle.top=l+d-4+"px",this.cornerStyle.left=u+p-4+"px",this.cornerStyle.display="block"):this.cornerStyle.display="none"}},d.prototype.disappear=function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none"},d.prototype.hasSetting=function(e){return"function"==typeof e?e():!!e},f.prototype.isValid=function(e){return this.row<0||this.col<0?!1:this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns")?!1:!0},f.prototype.isEqual=function(e){return e===this?!0:this.row===e.row&&this.col===e.col},f.prototype.isSouthEastOf=function(e){return this.row>=e.row&&this.col>=e.col},f.prototype.isNorthWestOf=function(e){return this.row<=e.row&&this.col<=e.col},f.prototype.isSouthWestOf=function(e){return this.row>=e.row&&this.col<=e.col},f.prototype.isNorthEastOf=function(e){return this.row<=e.row&&this.col>=e.col},t.WalkontableCellCoords=f,p.prototype.isValid=function(e){return this.from.isValid(e)&&this.to.isValid(e)},p.prototype.isSingle=function(){return this.from.row===this.to.row&&this.from.col===this.to.col},p.prototype.includes=function(e){var t=this.getTopLeftCorner(),o=this.getBottomRightCorner();return e.row<0&&(e.row=0),e.col<0&&(e.col=0),t.row<=e.row&&o.row>=e.row&&t.col<=e.col&&o.col>=e.col},p.prototype.includesRange=function(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())},p.prototype.isEqual=function(e){return Math.min(this.from.row,this.to.row)==Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(e.from.col,e.to.col)},p.prototype.overlaps=function(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())},p.prototype.isSouthEastOf=function(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)},p.prototype.isNorthWestOf=function(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)},p.prototype.expand=function(e){var t=this.getTopLeftCorner(),o=this.getBottomRightCorner();return e.row<t.row||e.col<t.col||e.row>o.row||e.col>o.col?(this.from=new f(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new f(Math.max(o.row,e.row),Math.max(o.col,e.col)),!0):!1},p.prototype.expandByRange=function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getTopLeftCorner(),o=this.getBottomRightCorner(),n=(this.getTopRightCorner(),this.getBottomLeftCorner(),e.getTopLeftCorner()),i=e.getBottomRightCorner(),r=Math.min(t.row,n.row),s=Math.min(t.col,n.col),a=Math.max(o.row,i.row),l=Math.max(o.col,i.col),c=new f(r,s),u=new f(a,l),h=new p(c,c,u).isCorner(this.from,e),d=e.isEqual(new p(c,c,u));return h&&!d&&(this.from.col>c.col&&(c.col=l,u.col=s),this.from.row>c.row&&(c.row=a,u.row=r)),this.from=c,this.to=u,!0},p.prototype.getDirection=function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0},p.prototype.setDirection=function(e){switch(e){case"NW-SE":this.from=this.getTopLeftCorner(),this.to=this.getBottomRightCorner();break;case"NE-SW":this.from=this.getTopRightCorner(),this.to=this.getBottomLeftCorner();break;case"SE-NW":this.from=this.getBottomRightCorner(),this.to=this.getTopLeftCorner();break;case"SW-NE":this.from=this.getBottomLeftCorner(),this.to=this.getTopRightCorner()}},p.prototype.getTopLeftCorner=function(){return new f(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},p.prototype.getBottomRightCorner=function(){return new f(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},p.prototype.getTopRightCorner=function(){return new f(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},p.prototype.getBottomLeftCorner=function(){return new f(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},p.prototype.isCorner=function(e,t){return t&&t.includes(e)&&(this.getTopLeftCorner().isEqual(new f(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new f(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new f(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new f(t.to.row,t.to.col)))?!0:e.isEqual(this.getTopLeftCorner())||e.isEqual(this.getTopRightCorner())||e.isEqual(this.getBottomLeftCorner())||e.isEqual(this.getBottomRightCorner())},p.prototype.getOppositeCorner=function(e,t){if(!(e instanceof f))return!1;if(t&&t.includes(e)){if(this.getTopLeftCorner().isEqual(new f(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new f(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new f(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new f(t.to.row,t.to.col)))return this.getTopLeftCorner()}return e.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():e.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():e.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():e.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0},p.prototype.getBordersSharedWith=function(e){if(!this.includesRange(e))return[];var t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},n=[];return t.top==o.top&&n.push("top"),t.right==o.right&&n.push("right"),t.bottom==o.bottom&&n.push("bottom"),t.left==o.left&&n.push("left"),n},p.prototype.getInner=function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),o=[],n=e.row;n<=t.row;n++)for(var i=e.col;i<=t.col;i++)this.from.row===n&&this.from.col===i||this.to.row===n&&this.to.col===i||o.push(new f(n,i));return o},p.prototype.getAll=function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),o=[],n=e.row;n<=t.row;n++)for(var i=e.col;i<=t.col;i++)o.push(e.row===n&&e.col===i?e:t.row===n&&t.col===i?t:new f(n,i));return o},p.prototype.forAll=function(e){for(var t=this.getTopLeftCorner(),o=this.getBottomRightCorner(),n=t.row;n<=o.row;n++)for(var i=t.col;i<=o.col;i++){var r=e(n,i);if(r===!1)return}},t.WalkontableCellRange=p,g.prototype.visibleToSource=function(e){return e},g.prototype.sourceToVisible=function(e){return e},g.prototype.offsettedTH=function(e){return e-this.countTH},g.prototype.unOffsettedTH=function(e){return e+this.countTH},g.prototype.visibleRowHeadedColumnToSourceColumn=function(e){return this.visibleToSource(this.offsettedTH(e))},g.prototype.sourceColumnToVisibleRowHeadedColumn=function(e){return this.unOffsettedTH(this.sourceToVisible(e))},m.prototype=new h,m.prototype.getSize=function(e){return this.cellSizes[e]+(this.cellStretch[e]||0)},m.prototype.stretch=function(){var e,t=0;if(e=this.instance.wtTable.allRowsInViewport()?this.getContainerSize():this.getContainerSize(1/0),this.remainingSize=this.cellSizesSum-e,this.cellStretch.length=0,"all"===this.strategy){if(this.remainingSize<0){for(var o,n=e/this.cellSizesSum;t<this.cellCount-1;)o=Math.floor(n*this.cellSizes[t]),this.remainingSize+=o-this.cellSizes[t],this.cellStretch[t]=o-this.cellSizes[t],t++;this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0}}else"last"===this.strategy&&this.remainingSize<0&&1/0!==e&&(this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0)},m.prototype.countVisible=function(){return this.visibleCellCount},m.prototype.isLastIncomplete=function(){var e=this.instance.wtTable.getFirstVisibleRow(),t=this.instance.wtTable.getLastVisibleColumn(),n=this.instance.wtTable.getCell(new f(e,t)),i=o.Dom.offset(n),r=o.Dom.outerWidth(n),s=i.left+r,a=this.instance.wtScrollbars.vertical.getScrollPosition(),l=this.instance.wtViewport.getViewportWidth(),c=a+l;return c>=s},w.prototype.draw=function(e){if(this.drawInterrupted=!1,!e&&!o.Dom.isVisible(this.wtTable.TABLE))return void(this.drawInterrupted=!0);e=e&&this.getSetting("offsetRow")===this.lastOffsetRow,this.lastOffsetRow=this.getSetting("offsetRow");var t=this.getSetting("totalRows");return this.lastOffsetRow>t&&t>0&&(this.scrollVertical(-1/0),this.scrollViewport(new f(t-1,0))),this.wtTable.draw(e),this},w.prototype.update=function(e,t){return this.wtSettings.update(e,t)},w.prototype.scrollVertical=function(e){var t=this.wtScroll.scrollVertical(e);return this.getSetting("onScrollVertically"),t},w.prototype.scrollHorizontal=function(e){var t=this.wtScroll.scrollHorizontal(e);return this.getSetting("onScrollHorizontally"),t},w.prototype.scrollViewport=function(e){return this.wtScroll.scrollViewport(e),this},w.prototype.getViewport=function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},w.prototype.getSetting=function(e,t,o,n,i){return this.wtSettings.getSetting(e,t,o,n,i)},w.prototype.hasSetting=function(e){return this.wtSettings.has(e)},w.prototype.destroy=function(){e(t).off("."+this.guid),e(document.body).off("."+this.guid),this.wtScrollbars.destroy(),this.wtEvent&&this.wtEvent.destroy()},v.prototype=new u,v.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=this.instance.wtTable.holder.getBoundingClientRect();e.style.top=Math.ceil(t.top,10)+"px",e.style.left=Math.ceil(t.left,10)+"px"}},v.prototype.destroy=function(){u.prototype.destroy.call(this),clearTimeout(this.lastTimeout)},y.prototype.parentCell=function(e){var t={},n=this.instance.wtTable.TABLE,i=o.Dom.closest(e,["TD","TH"],n);return i&&o.Dom.isChildOf(i,n)?(t.coords=this.instance.wtTable.getCoords(i),t.TD=i):o.Dom.hasClass(e,"wtBorder")&&o.Dom.hasClass(e,"current")?(t.coords=this.instance.selections[0].cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)):o.Dom.hasClass(e,"wtBorder")&&o.Dom.hasClass(e,"area")&&(t.coords=this.instance.selections[1].cellRange.to,t.TD=this.instance.wtTable.getCell(t.coords)),t},y.prototype.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1])},t.requestAnimFrame=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){return t.setTimeout(e,1e3/60)}}(),t.cancelRequestAnimFrame=function(){return t.cancelAnimationFrame||t.webkitCancelRequestAnimationFrame||t.mozCancelRequestAnimationFrame||t.oCancelRequestAnimationFrame||t.msCancelRequestAnimationFrame||clearTimeout}(),t.getComputedStyle||!function(){var e,o={getPropertyValue:function(t){return"float"==t&&(t="styleFloat"),e.currentStyle[t.toUpperCase()]||null}};t.getComputedStyle=function(t){return e=t,o}}(),!String.prototype.trim){var ot=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(ot,"")}}b.prototype.offsetted=function(e){return e+this.offset},b.prototype.unOffsetted=function(e){return e-this.offset},b.prototype.visibleToSource=function(e){return this.offsetted(e)},b.prototype.sourceToVisible=function(e){return this.unOffsetted(e)},b.prototype.offsettedTH=function(e){return e-this.countTH},b.prototype.visibleColHeadedRowToSourceRow=function(e){return this.visibleToSource(this.offsettedTH(e))},b.prototype.sourceRowToVisibleColHeadedRow=function(e){return this.unOffsettedTH(this.sourceToVisible(e))},S.prototype=new h,S.prototype.add=function(e,t){if(!this.canRenderMoreRows())return!1;var o=this.sizeAtIndex(e,t);if(void 0===o)return!1;var n=this.getContainerSize(this.cellSizesSum+o);return this.cellSizes.push(o),this.cellSizesSum+=o,this.cellCount++,this.remainingSize=this.cellSizesSum-n,this.remainingSize<=o&&this.visiblCellCount++,!0},S.prototype.canRenderMoreRows=function(){return this.remainingSize<=0||this.cellCount-this.visiblCellCount<this.curOuts},S.prototype.remove=function(){var e=this.cellSizes.pop();this.cellSizesSum-=e,this.cellCount--,this.remainingSize-=e},S.prototype.removeOutstanding=function(){for(;this.cellCount-this.visiblCellCount>this.curOuts;)this.remove()},S.prototype.countRendered=function(){return this.cellCount},S.prototype.countVisible=function(){return this.visiblCellCount},S.prototype.isLastIncomplete=function(){var e=this.instance.wtTable.getLastVisibleRow(),t=this.instance.wtTable.getFirstVisibleColumn(),n=this.instance.wtTable.getCell(new f(e,t)),i=o.Dom.offset(n).top,r=o.Dom.outerHeight(n),s=i+r,a=this.instance.wtScrollbars.horizontal.scrollHandler.offsetTop+this.instance.wtScrollbars.vertical.getScrollPosition(),l=this.instance.wtViewport.getViewportHeight(),c=a+l;return s>c},R.prototype.scrollVertical=function(e){if(!this.instance.drawn)throw new Error("scrollVertical can only be called after table was drawn to DOM");var t,o=this.instance,n=o.getSetting("offsetRow"),i=o.getSetting("fixedRowsTop"),r=o.getSetting("totalRows"),s=o.wtViewport.getViewportHeight();return t=r>0&&!this.instance.wtTable.isLastRowFullyVisible()?this.scrollLogicVertical(e,n,r,i,s,function(e){return i>e-n&&e-n>=0?o.getSetting("rowHeight",e-n):o.getSetting("rowHeight",e)}):0,t!==n&&this.instance.wtScrollbars.vertical.scrollTo(t),o},R.prototype.scrollHorizontal=function(e){return this.instance.wtScrollbars.horizontal.scrollTo(e),this.instance},R.prototype.scrollLogicVertical=function(e,t,o,n){var i=t+e;return i>=o-n&&(i=o-n-1),0>i&&(i=0),i},R.prototype.scrollViewport=function(e){if(this.instance.drawn){var t=(this.instance.getSetting("offsetRow"),this.instance.getSetting("totalRows")),o=this.instance.getSetting("totalColumns");if(e.row<0||e.row>t-1)throw new Error("row "+e.row+" does not exist");if(e.col<0||e.col>o-1)throw new Error("column "+e.col+" does not exist");var n=this.instance.wtTable.getCell(e);"object"==typeof n?e.col>=this.instance.getSetting("fixedColumnsLeft")&&this.scrollToRenderedCell(n):e.row>=this.instance.wtTable.getLastVisibleRow()?(this.scrollVertical(e.row-this.instance.wtTable.getLastVisibleRow()),e.row==this.instance.wtTable.getLastVisibleRow()&&this.instance.wtTable.getRowStrategy().isLastIncomplete()&&this.scrollViewport(e)):e.row>=this.instance.getSetting("fixedRowsTop")&&this.scrollVertical(e.row-this.instance.wtTable.getFirstVisibleRow())}},R.prototype.scrollToRenderedCell=function(e){var n=o.Dom.offset(e),i=o.Dom.outerWidth(e),r=o.Dom.outerHeight(e),s=o.Dom.offset(this.instance.wtTable.TABLE),a={left:this.instance.wtScrollbars.horizontal.getScrollPosition(),top:this.instance.wtScrollbars.vertical.getScrollPosition()},l=this.instance.wtViewport.getWorkspaceWidth(),c=this.instance.wtViewport.getWorkspaceHeight(),u=o.Dom.outerWidth(this.instance.wtScrollbars.horizontal.clone.wtTable.TABLE),h=o.Dom.outerHeight(this.instance.wtScrollbars.vertical.clone.wtTable.TABLE);if(this.instance.wtScrollbars.horizontal.scrollHandler!==t&&(s.left=0,n.left-=o.Dom.offset(this.instance.wtScrollbars.horizontal.scrollHandler).left),this.instance.wtScrollbars.vertical.scrollHandler!==t&&(s.top=0,n.top=n.top-o.Dom.offset(this.instance.wtScrollbars.vertical.scrollHandler).top),l>i)if(n.left<a.left+u)this.instance.wtScrollbars.horizontal.setScrollPosition(n.left-u);else if(n.left+i>s.left+a.left+l){var d=n.left+i-(s.left+a.left+l);this.instance.wtScrollbars.horizontal.setScrollPosition(a.left+d)}c>r&&(n.top<a.top+h?(this.instance.wtScrollbars.vertical.setScrollPosition(n.top-h),this.instance.wtScrollbars.vertical.onScroll()):n.top+r>a.top+c&&(this.instance.wtScrollbars.vertical.setScrollPosition(n.top-c+r),this.instance.wtScrollbars.vertical.onScroll()))},T.prototype=new u,T.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===t){var n=this.instance.wtTable.holder.getBoundingClientRect(),i=Math.ceil(n.top),r=Math.ceil(n.left);e.style.left=0>r?-r+"px":"0",e.style.top=0>i?-i+"px":"0"}else e.style.top=this.instance.wtScrollbars.vertical.getScrollPosition()+"px",e.style.left=this.instance.wtScrollbars.horizontal.getScrollPosition()+"px";e.style.width=o.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px",e.style.height=o.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},E.prototype=new u,E.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===t){var n=this.instance.wtTable.holder.getBoundingClientRect(),i=Math.ceil(n.left);e.style.left=0>i?-i+"px":"0",e.style.top=this.instance.wtTable.hider.style.top}else e.style.top=this.instance.wtTable.hider.style.top,e.style.left=this.getScrollPosition()+"px";e.style.height=o.Dom.outerHeight(this.clone.wtTable.TABLE)+"px",e.style.width=o.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px"}},E.prototype.refresh=function(e){u.prototype.refresh.call(this,e)},E.prototype.getScrollPosition=function(){return o.Dom.getScrollLeft(this.scrollHandler)},E.prototype.setScrollPosition=function(e){this.scrollHandler===t?t.scrollTo(e,o.Dom.getWindowScrollTop()):this.scrollHandler.scrollLeft=e},E.prototype.onScroll=function(){this.readSettings(),this.instance.getSetting("onScrollHorizontally")},E.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleColumn()},E.prototype.applyToDOM=function(){},E.prototype.scrollTo=function(e){this.setScrollPosition(this.getTableParentOffset()+e*this.cellSize)},E.prototype.getTableParentOffset=function(){return this.scrollHandler===t?this.instance.wtTable.holderOffset.left:0},E.prototype.readSettings=function(){this.total=this.instance.getSetting("totalColumns")},k.prototype=new u,k.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===t){var n=this.instance.wtTable.holder.getBoundingClientRect(),i=Math.ceil(n.top);e.style.left="0",e.style.top=0>i?-i+"px":"0"}else e.style.top=this.getScrollPosition()+"px",e.style.left="0";e.style.width=this.instance.wtScrollbars.horizontal.scrollHandler===t?this.instance.wtViewport.getWorkspaceActualWidth()+"px":o.Dom.outerWidth(this.clone.wtTable.TABLE)+"px",e.style.height=o.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},k.prototype.getScrollPosition=function(){return o.Dom.getScrollTop(this.scrollHandler)},k.prototype.setScrollPosition=function(e){this.scrollHandler===t?t.scrollTo(o.Dom.getWindowScrollLeft(),e):this.scrollHandler.scrollTop=e},k.prototype.onScroll=function(){this.readSettings(),this.instance.draw(!0),this.instance.getSetting("onScrollVertically")},k.prototype.getLastCell=function(){return this.instance.getSetting("offsetRow")+this.instance.wtTable.tbodyChildrenLength-1},k.prototype.sumCellSizes=function(e,t){for(var o,n=0;t>e;)o=this.instance.wtSettings.settings.rowHeight(e),n+=void 0!==o?o:this.instance.wtSettings.settings.defaultRowHeight,e++;return n},k.prototype.refresh=function(e){this.applyToDOM(),u.prototype.refresh.call(this,e)},k.prototype.applyToDOM=function(){var e=this.getLastCell();this.measureBefore=this.sumCellSizes(0,this.offset),this.measureAfter=-1===e?0:this.sumCellSizes(e,this.total-e);var t=this.instance.wtViewport.getColumnHeaderHeight();this.fixedContainer.style.height=t+this.sumCellSizes(0,this.total)+4+"px",this.fixed.style.top=this.measureBefore+"px",this.fixed.style.bottom=""},k.prototype.scrollTo=function(e){var t=this.getTableParentOffset()+e*this.cellSize;this.setScrollPosition(t),this.onScroll()},k.prototype.getTableParentOffset=function(){return this.scrollHandler===t?this.instance.wtTable.holderOffset.top:0},k.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetRow"),this.total=this.instance.getSetting("totalRows");for(var e,t,o=this.getScrollPosition()-this.getTableParentOffset(),n=0,i=0;i<this.total&&(t=this.instance.getSetting("rowHeight",i),e=void 0!==t?t:this.instance.wtSettings.settings.defaultRowHeight,n+=e,!(n-1>o));i++);this.offset=Math.min(i,this.total),this.instance.update("offsetRow",this.offset)},D.prototype.registerListeners=function(){function o(){if(a.instance.drawn){if(!a.instance.wtTable.holder.parentNode)return void a.destroy();a.vertical.windowScrollPosition=a.vertical.getScrollPosition(),a.horizontal.windowScrollPosition=a.horizontal.getScrollPosition(),a.box=a.instance.wtTable.hider.getBoundingClientRect(),(a.vertical.windowScrollPosition!==n||a.horizontal.windowScrollPosition!==i||a.box.top!==r||a.box.left!==s)&&(a.vertical.onScroll(),a.horizontal.onScroll(),n=a.vertical.windowScrollPosition,i=a.horizontal.windowScrollPosition,r=a.box.top,s=a.box.left)}}var n,i,r,s,a=this,l=e(t);this.vertical.$scrollHandler.on("scroll."+this.instance.guid,o),this.vertical.scrollHandler!==this.horizontal.scrollHandler&&this.horizontal.$scrollHandler.on("scroll."+this.instance.guid,o),this.vertical.scrollHandler!==t&&this.horizontal.scrollHandler!==t&&l.on("scroll."+this.instance.guid,o)},D.prototype.destroy=function(){this.vertical&&(this.vertical.destroy(),this.vertical.$scrollHandler.off("scroll."+this.instance.guid)),this.horizontal&&(this.horizontal.destroy(),this.vertical.$scrollHandler.off("scroll."+this.instance.guid)),e(t).off("scroll."+this.instance.guid),this.corner&&this.corner.destroy(),this.debug&&this.debug.destroy()},D.prototype.refresh=function(e){this.horizontal&&this.horizontal.readSettings(),this.vertical&&this.vertical.readSettings(),this.horizontal&&this.horizontal.refresh(e),this.vertical&&this.vertical.refresh(e),this.corner&&this.corner.refresh(e),this.debug&&this.debug.refresh(e)},D.prototype.applyToDOM=function(){this.horizontal&&this.horizontal.applyToDOM(),this.vertical&&this.vertical.applyToDOM()},x.prototype.getBorder=function(e){return this.instanceBorders[e.guid]?this.instanceBorders[e.guid]:void(this.instanceBorders[e.guid]=new d(e,this.settings))},x.prototype.isEmpty=function(){return null===this.cellRange},x.prototype.add=function(e){this.isEmpty()?this.cellRange=new p(e,e,e):this.cellRange.expand(e)},x.prototype.replace=function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1},x.prototype.clear=function(){this.cellRange=null},x.prototype.getCorners=function(){var e=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[e.row,e.col,t.row,t.col]},x.prototype.addClassAtCoords=function(e,t,n,i){var r=e.wtTable.getCell(new f(t,n));"object"==typeof r&&o.Dom.addClass(r,i)},x.prototype.draw=function(e){var t,n,i,r,s,a=e.wtTable.getRowStrategy().countVisible(),l=e.wtTable.getColumnStrategy().cellCount;if(this.isEmpty()){if(this.settings.border){var c=this.getBorder(e);c&&c.disappear()}}else{for(t=this.getCorners(),n=0;a>n;n++)for(r=e.wtTable.rowFilter.visibleToSource(n),i=0;l>i;i++)if(s=e.wtTable.columnFilter.visibleToSource(i),r>=t[0]&&r<=t[2]&&s>=t[1]&&s<=t[3]){if(this.settings.className&&this.addClassAtCoords(e,r,s,this.settings.className),s===t[1]){var u=e.wtTable.getRowHeader(r);u&&o.Dom.addClass(u,this.settings.highlightRowClassName)}if(r===t[0]||r>t[0]&&0==n){var u=e.wtTable.getColumnHeader(s);u&&o.Dom.addClass(u,this.settings.highlightColumnClassName)}}else r>=t[0]&&r<=t[2]?this.addClassAtCoords(e,r,s,this.settings.highlightRowClassName):s>=t[1]&&s<=t[3]&&this.addClassAtCoords(e,r,s,this.settings.highlightColumnClassName);if(e.getSetting("onBeforeDrawBorders",t,this.settings.className),this.settings.border){var c=this.getBorder(e);c&&c.appear(t)}}},A.prototype.update=function(e,t){if(void 0===t)for(var o in e)e.hasOwnProperty(o)&&(this.settings[o]=e[o]);else this.settings[e]=t;return this.instance},A.prototype.getSetting=function(e,t,o,n,i){return"function"==typeof this.settings[e]?this.settings[e](t,o,n,i):void 0!==t&&"[object Array]"===Object.prototype.toString.call(this.settings[e])?this.settings[e][t]:this.settings[e]},A.prototype.has=function(e){return!!this.settings[e]},H.prototype.getRowStrategy=function(){return this.isWorkingOnClone()?this.instance.cloneSource.wtTable.rowStrategy:this.rowStrategy},H.prototype.getColumnStrategy=function(){return this.isWorkingOnClone()?this.instance.cloneSource.wtTable.columnStrategy:this.columnStrategy},H.prototype.isWorkingOnClone=function(){return!!this.instance.cloneSource},H.prototype.refreshHiderDimensions=function(){var e=this.spreader.style;e.position="relative",e.width="auto",e.height="auto"},H.prototype.draw=function(e){if(e)this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!0);else{this.isWorkingOnClone()?this.tableOffset=this.instance.cloneSource.wtTable.tableOffset:(this.holderOffset=o.Dom.offset(this.holder),this.tableOffset=o.Dom.offset(this.TABLE),this.instance.wtScrollbars.vertical.readSettings(),this.instance.wtScrollbars.horizontal.readSettings(),this.instance.wtViewport.resetSettings());var t;t=this.instance.cloneOverlay instanceof v||this.instance.cloneOverlay instanceof k||this.instance.cloneOverlay instanceof T?0:this.instance.wtSettings.settings.offsetRow,this.rowFilter=new b(t,this.instance.getSetting("totalRows"),this.instance.getSetting("columnHeaders").length),this.columnFilter=new g(this.instance.getSetting("totalColumns"),this.instance.getSetting("rowHeaders").length),this._doDraw()}return this.refreshPositions(e),this.isWorkingOnClone()||(this.instance.wtScrollbars.vertical.resetFixedPosition(),this.instance.wtScrollbars.horizontal.resetFixedPosition(),this.instance.wtScrollbars.corner.resetFixedPosition(),this.instance.wtScrollbars.debug&&this.instance.wtScrollbars.debug.resetFixedPosition()),this.instance.drawn=!0,this},H.prototype._doDraw=function(){var e=new O(this);e.render()},H.prototype.refreshPositions=function(e){this.refreshHiderDimensions(),this.refreshSelections(e)},H.prototype.removeClassFromCells=function(e){for(var t=this.TABLE.querySelectorAll("."+e),n=0,i=t.length;i>n;n++)o.Dom.removeClass(t[n],e)},H.prototype.refreshSelections=function(e){if(this.instance.selections){if(e)for(var t=0,o=this.instance.selections.length;o>t;t++)this.instance.selections[t].settings.className&&this.removeClassFromCells(this.instance.selections[t].settings.className),this.instance.selections[t].settings.highlightRowClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightRowClassName),this.instance.selections[t].settings.highlightColumnClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightColumnClassName);for(var t=0,o=this.instance.selections.length;o>t;t++)this.instance.selections[t].draw(this.instance,e)}},H.prototype.getCell=function(e){if(this.isRowBeforeViewport(e.row))return-1;if(this.isRowAfterViewport(e.row))return-2;var t=this.TBODY.childNodes[this.rowFilter.sourceToVisible(e.row)];return t?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e.col)]:void 0},H.prototype.getColumnHeader=function(e){var t=this.THEAD.childNodes[0];return t?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]:void 0},H.prototype.getRowHeader=function(e){if(0==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToVisible(e)];return t?t.childNodes[0]:void 0},H.prototype.getCoords=function(e){var t=e.parentNode,n=o.Dom.index(t);return n=t.parentNode===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(n):this.rowFilter.visibleToSource(n),new f(n,this.columnFilter.visibleRowHeadedColumnToSourceColumn(e.cellIndex))},H.prototype.getTrForRow=function(e){return this.TBODY.childNodes[this.rowFilter.sourceToVisible(e)]},H.prototype.getFirstVisibleRow=function(){return this.rowFilter.visibleToSource(0)},H.prototype.getFirstVisibleColumn=function(){if(this.isWorkingOnClone())return this.instance.cloneOverlay instanceof E||this.instance.cloneOverlay instanceof T?0:this.instance.cloneSource.wtTable.getFirstVisibleColumn();var e=this.instance.wtScrollbars.horizontal.getScrollPosition(),t=this.getColumnStrategy().cellCount,o=this.TBODY.firstChild;if(!o)return 0;for(var n=0;t>n;n++)if(e-=o.childNodes[n].offsetWidth,0>e)return n;return-1},H.prototype.getLastVisibleRow=function(){var e=this.rowFilter.visibleToSource(this.getRowStrategy().countVisible()-1),t=this.instance;if(t.cloneOverlay instanceof k||t.cloneOverlay instanceof T){var o=this.instance.getSetting("fixedRowsTop");return Math.min(o-1,e)}return e},H.prototype.getLastVisibleColumn=function(){var e=this.instance;if(this.isWorkingOnClone()){if(e.cloneOverlay instanceof E||e.cloneOverlay instanceof T){var t=this.getColumnStrategy().countVisible()-1,o=e.getSetting("fixedColumnsLeft");return Math.min(o-1,t)}return this.instance.cloneSource.wtTable.getLastVisibleColumn()}var n=this.instance.wtScrollbars.horizontal.getScrollPosition(),i=n+this.instance.wtViewport.getWorkspaceWidth(1/0),r=this.getColumnStrategy().cellCount,s=this.instance.getSetting("rowHeaders").length||0,a=this.TBODY.firstChild;if(!r)return-1;for(var l=0;r+s>l;l++)if(i-=a.childNodes[l].offsetWidth,0>=i)return l-s;return l-s-1},H.prototype.isRowBeforeViewport=function(e){return this.rowFilter.sourceToVisible(e)<0&&e>=0},H.prototype.isRowAfterViewport=function(e){return e>this.getLastVisibleRow()},H.prototype.isColumnBeforeViewport=function(e){return this.columnFilter.sourceToVisible(e)<0&&e>=0},H.prototype.isColumnAfterViewport=function(e){return e>this.getLastVisibleColumn()},H.prototype.isRowInViewport=function(e){return!this.isRowBeforeViewport(e)&&!this.isRowAfterViewport(e)},H.prototype.isColumnInViewport=function(e){return!this.isColumnBeforeViewport(e)&&!this.isColumnAfterViewport(e)},H.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.instance.getSetting("totalRows")-1&&!this.getRowStrategy().isLastIncomplete()},H.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.instance.getSetting("totalColumns")-1&&!this.getColumnStrategy().isLastIncomplete()},H.prototype.getVisibleRowsCount=function(){return this.getRowStrategy().countVisible()},H.prototype.allRowsInViewport=function(){return this.getRowStrategy().cellCount==this.getVisibleRowsCount()},O.prototype.render=function(){this.wtTable.isWorkingOnClone()||this.instance.getSetting("beforeDraw",!0),this.rowHeaders=this.instance.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.instance.getSetting("fixedRowsTop"),this.columnHeaders=this.instance.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var e,t,o,n=this.instance.getSetting("totalRows"),i=this.instance.getSetting("totalColumns"),r=!1;if(i>0){var s;this.wtTable.isWorkingOnClone()&&(this.instance.cloneOverlay instanceof k||this.instance.cloneOverlay instanceof T?s=this.fixedRowsTop:this.instance.cloneOverlay instanceof E&&(s=this.wtTable.getRowStrategy().cellCount)),this.adjustAvailableNodes(),r=!0,this.renderColGroups(),this.renderColumnHeaders(),t=this.getColumnCount(),this.renderRows(n,s,t),this.wtTable.isWorkingOnClone()||(o=this.instance.wtViewport.getWorkspaceWidth(),this.instance.wtViewport.containerWidth=null,this.wtTable.getColumnStrategy().stretch()),this.adjustColumnWidths(t)
}if(r||this.adjustAvailableNodes(),this.instance.cloneOverlay instanceof v||this.removeRedundantRows(),!this.wtTable.isWorkingOnClone()){if(this.markOversizedRows(),this.instance.wtScrollbars.applyToDOM(),o!==this.instance.wtViewport.getWorkspaceWidth()){this.instance.wtViewport.containerWidth=null,this.wtTable.getColumnStrategy().stretch();var a=this.instance.wtTable.columnWidthCache;for(e=0;e<this.wtTable.getColumnStrategy().cellCount;e++){var l=this.wtTable.getColumnStrategy().getSize(e);this.COLGROUP.childNodes[e+this.rowHeaderCount].style.width=l+"px",a[e]=l}}this.instance.wtScrollbars.refresh(!1),this.instance.getSetting("onDraw",!0)}},O.prototype.removeRedundantRows=function(){for(var e=this.wtTable.getRowStrategy().countRendered();this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},O.prototype.renderRows=function(e,t,o){for(var n,i,r,s=this.instance.getSetting("offsetRow"),a=0,l=this.rowFilter.visibleToSource(a),c=this.wtTable.isWorkingOnClone();e>l&&l>=0;){if(a>1e3)throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");if(void 0!==t&&a===t)break;if(i=this.getOrCreateTrForRow(a,i),this.renderRowHeaders(l,i),this.adjustColumns(i,o+this.rowHeaderCount),n=this.renderCells(l,i,o),s=this.instance.getSetting("offsetRow"),!c){if(r=this.wtTable.getRowStrategy().add(a,n),r===!1)break;this.resetOversizedRow(l)}if(i.firstChild){var u=this.instance.getSetting("rowHeight",l);i.firstChild.style.height=u?u+"px":""}a++,l=this.rowFilter.visibleToSource(a)}},O.prototype.resetOversizedRow=function(e){this.instance.wtTable.oversizedRows&&this.instance.wtTable.oversizedRows[e]&&(this.instance.wtTable.oversizedRows[e]=void 0)},O.prototype.markOversizedRows=function(){for(var e,t,n,i,r=this.instance.wtTable.TBODY.childNodes.length;r;)r--,n=this.instance.wtTable.rowFilter.visibleToSource(r),e=this.instance.wtSettings.settings.rowHeight(n),i=this.instance.wtTable.getTrForRow(n),t=o.Dom.innerHeight(i)-1,(!e&&this.instance.wtSettings.settings.defaultRowHeight<t||t>e)&&(this.instance.wtTable.oversizedRows||(this.instance.wtTable.oversizedRows={}),this.instance.wtTable.oversizedRows[n]=t)},O.prototype.renderCells=function(e,t,n){for(var i,r,s=0;n>s;s++)r=this.columnFilter.visibleToSource(s),i=0===s?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]:i.nextSibling,"TH"==i.nodeName&&(i=this.utils.replaceThWithTd(i,t)),o.Dom.hasClass(i,"hide")||(i.className=""),i.removeAttribute("style"),this.instance.getSetting("cellRenderer",e,r,i);return i},O.prototype.adjustColumnWidths=function(e){for(var t,o=this.instance.wtTable.columnWidthCache,n=!1,i=0;e>i;i++)t=this.wtTable.isWorkingOnClone()?this.instance.cloneSource.wtTable.columnWidthCache[i]:this.wtTable.getColumnStrategy().getSize(i),t!==o[i]&&(this.COLGROUP.childNodes[i+this.rowHeaderCount].style.width=t+"px",o[i]=t,n=!0)},O.prototype.appendToTbody=function(e){this.TBODY.appendChild(e),this.wtTable.tbodyChildrenLength++},O.prototype.getOrCreateTrForRow=function(e,t){var o;return e>=this.wtTable.tbodyChildrenLength?(o=this.createRow(),this.appendToTbody(o)):o=0===e?this.TBODY.firstChild:t.nextSibling,o},O.prototype.createRow=function(){for(var e=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)e.appendChild(document.createElement("TH"));return e},O.prototype.renderRowHeader=function(e,t,o){o.className="",o.removeAttribute("style"),this.rowHeaders[t](e,o,t)},O.prototype.renderRowHeaders=function(e,t){for(var o=t.firstChild,n=0;n<this.rowHeaderCount;n++)o?"TD"==o.nodeName&&(o=this.utils.replaceTdWithTh(o,t)):(o=document.createElement("TH"),t.appendChild(o)),this.renderRowHeader(e,n,o),o=o.nextSibling},O.prototype.adjustAvailableNodes=function(){this.refreshStretching(),this.adjustColGroups(),this.adjustThead()},O.prototype.renderColumnHeaders=function(){if(this.columnHeaderCount)for(var e,t=this.getColumnCount(),o=0;o<this.columnHeaderCount;o++){e=this.getTrForColumnHeaders(o);for(var n=-1*this.rowHeaderCount;t>n;n++)this.renderColumnHeader(o,n,e.childNodes[n+this.rowHeaderCount])}},O.prototype.adjustColGroups=function(){for(var e=this.getColumnCount();this.wtTable.colgroupChildrenLength<e+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>e+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--,this.wtTable.columnWidthCache&&this.wtTable.columnWidthCache.splice(-1,1)},O.prototype.adjustThead=function(){var e=this.getColumnCount(),t=this.THEAD.firstChild;if(this.columnHeaders.length){for(var n=0,i=this.columnHeaders.length;i>n;n++){for(t=this.THEAD.childNodes[n],t||(t=document.createElement("TR"),this.THEAD.appendChild(t)),this.theadChildrenLength=t.childNodes.length;this.theadChildrenLength<e+this.rowHeaderCount;)t.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>e+this.rowHeaderCount;)t.removeChild(t.lastChild),this.theadChildrenLength--}var r=this.THEAD.childNodes.length;if(r>this.columnHeaders.length)for(var n=this.columnHeaders.length;r>n;n++)this.THEAD.removeChild(this.THEAD.lastChild)}else t&&o.Dom.empty(t)},O.prototype.getTrForColumnHeaders=function(e){var t=this.THEAD.childNodes[e];return t},O.prototype.renderColumnHeader=function(e,t,o){return o.className="",o.removeAttribute("style"),this.columnHeaders[e](t,o,e)},O.prototype.getColumnCount=function(){return this.wtTable.isWorkingOnClone()&&(this.instance.cloneOverlay instanceof E||this.instance.cloneOverlay instanceof T)?this.instance.getSetting("fixedColumnsLeft"):this.wtTable.getColumnStrategy().cellCount},O.prototype.renderColGroups=function(){for(var e=0;e<this.wtTable.colgroupChildrenLength;e++)e<this.rowHeaderCount?o.Dom.addClass(this.COLGROUP.childNodes[e],"rowHeader"):o.Dom.removeClass(this.COLGROUP.childNodes[e],"rowHeader")},O.prototype.adjustColumns=function(e,t){for(var o=e.childNodes.length;t>o;){var n=document.createElement("TD");e.appendChild(n),o++}for(;o>t;)e.removeChild(e.lastChild),o--},O.prototype.refreshStretching=function(){if(!this.wtTable.isWorkingOnClone()){var e=this.instance,t=e.getSetting("stretchH"),o=(e.getSetting("totalRows"),e.getSetting("totalColumns")),n=function(e){var t=i.instance.wtViewport.getViewportWidth(e);return t},i=this,r=function(t){var n=i.columnFilter.visibleToSource(t);return o>n?e.getSetting("columnWidth",n):void 0},s=function(t){return i.instance.cloneOverlay instanceof v||e.wtSettings.settings.renderAllRows?1/0:i.instance.wtViewport.getViewportHeight(t)},a=function(){return e.wtSettings.settings.defaultRowHeight};this.wtTable.columnStrategy=new m(e,n,r,t),this.wtTable.rowStrategy=new S(e,s,a)}},O.utils={},O.utils.replaceTdWithTh=function(e,t){var o;return o=document.createElement("TH"),t.insertBefore(o,e),t.removeChild(e),o},O.utils.replaceThWithTd=function(e,t){var o=document.createElement("TD");return t.insertBefore(o,e),t.removeChild(e),o},M.prototype.getWorkspaceHeight=function(){var e=this.instance.wtScrollbars.vertical.scrollHandler;if(e===t)return document.documentElement.clientHeight;var n=o.Dom.outerHeight(e),i=n>0&&e.clientHeight>0?e.clientHeight:1/0;return i},M.prototype.getWorkspaceWidth=function(){var e=Math.min(this.getContainerFillWidth(),document.documentElement.offsetWidth-this.getWorkspaceOffset().left,document.documentElement.offsetWidth),n=this.instance.wtScrollbars.horizontal.scrollHandler;if(n!=t){var i=this.instance.wtScrollbars.horizontal.scrollHandler.style.overflow;if("scroll"==i||"hidden"==i||"auto"==i)return Math.max(e,n.clientWidth)}return Math.max(e,o.Dom.outerWidth(this.instance.wtTable.TABLE))},M.prototype.getContainerFillWidth=function(){if(this.containerWidth)return this.containerWidth;for(var e,t,o=this.instance.wtTable.holder;o.parentNode!=document.body&&null!=o.parentNode&&-1===o.className.indexOf("handsontable");)o=o.parentNode;return t=document.createElement("DIV"),t.style.width="100%",t.style.height="1px",o.appendChild(t),e=t.offsetWidth,this.containerWidth=e,o.removeChild(t),e},M.prototype.getWorkspaceOffset=function(){return o.Dom.offset(this.instance.wtTable.TABLE)},M.prototype.getWorkspaceActualHeight=function(){return o.Dom.outerHeight(this.instance.wtTable.TABLE)},M.prototype.getWorkspaceActualWidth=function(){return o.Dom.outerWidth(this.instance.wtTable.TABLE)||o.Dom.outerWidth(this.instance.wtTable.TBODY)||o.Dom.outerWidth(this.instance.wtTable.THEAD)},M.prototype.getColumnHeaderHeight=function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=o.Dom.outerHeight(this.instance.wtTable.THEAD)),this.columnHeaderHeight},M.prototype.getViewportHeight=function(e){var t=this.getWorkspaceHeight(e);if(1/0===t)return t;var o=this.getColumnHeaderHeight();return o>0&&(t-=o),t},M.prototype.getRowHeaderWidth=function(){if(this.instance.cloneSource)return this.instance.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth)){var e=this.instance.getSetting("rowHeaders");if(e.length){var t=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var n=0,i=e.length;i>n;n++)t?(this.rowHeaderWidth+=o.Dom.outerWidth(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth},M.prototype.getViewportWidth=function(e){var t=this.getWorkspaceWidth(e);if(1/0===t)return t;var o=this.getRowHeaderWidth();return o>0?t-o:t},M.prototype.resetSettings=function(){this.rowHeaderWidth=0/0,this.columnHeaderHeight=0/0}}(jQuery,window,Handsontable),function(){function e(e){this._value=e}function t(e,t,o,n){var i,r,s=Math.pow(10,t);return r=(o(e*s)/s).toFixed(t),n&&(i=new RegExp("0{1,"+n+"}$"),r=r.replace(i,"")),r}function o(e,t,o){var n;return n=t.indexOf("$")>-1?i(e,t,o):t.indexOf("%")>-1?r(e,t,o):t.indexOf(":")>-1?s(e,t):l(e._value,t,o)}function n(e,t){var o,n,i,r,s,l=t,c=["KB","MB","GB","TB","PB","EB","ZB","YB"],u=!1;if(t.indexOf(":")>-1)e._value=a(t);else if(t===m)e._value=0;else{for("."!==p[g].delimiters.decimal&&(t=t.replace(/\./g,"").replace(p[g].delimiters.decimal,".")),o=new RegExp("[^a-zA-Z]"+p[g].abbreviations.thousand+"(?:\\)|(\\"+p[g].currency.symbol+")?(?:\\))?)?$"),n=new RegExp("[^a-zA-Z]"+p[g].abbreviations.million+"(?:\\)|(\\"+p[g].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+p[g].abbreviations.billion+"(?:\\)|(\\"+p[g].currency.symbol+")?(?:\\))?)?$"),r=new RegExp("[^a-zA-Z]"+p[g].abbreviations.trillion+"(?:\\)|(\\"+p[g].currency.symbol+")?(?:\\))?)?$"),s=0;s<=c.length&&!(u=t.indexOf(c[s])>-1?Math.pow(1024,s+1):!1);s++);e._value=(u?u:1)*(l.match(o)?Math.pow(10,3):1)*(l.match(n)?Math.pow(10,6):1)*(l.match(i)?Math.pow(10,9):1)*(l.match(r)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(t.replace(/[^0-9\.]+/g,"")),e._value=u?Math.ceil(e._value):e._value}return e._value}function i(e,t,o){var n,i,r=t.indexOf("$"),s=t.indexOf("("),a=t.indexOf("-"),c="";return t.indexOf(" $")>-1?(c=" ",t=t.replace(" $","")):t.indexOf("$ ")>-1?(c=" ",t=t.replace("$ ","")):t=t.replace("$",""),i=l(e._value,t,o),1>=r?i.indexOf("(")>-1||i.indexOf("-")>-1?(i=i.split(""),n=1,(s>r||a>r)&&(n=0),i.splice(n,0,p[g].currency.symbol+c),i=i.join("")):i=p[g].currency.symbol+c+i:i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,c+p[g].currency.symbol),i=i.join("")):i=i+c+p[g].currency.symbol,i}function r(e,t,o){var n,i="",r=100*e._value;return t.indexOf(" %")>-1?(i=" ",t=t.replace(" %","")):t=t.replace("%",""),n=l(r,t,o),n.indexOf(")")>-1?(n=n.split(""),n.splice(-1,0,i+"%"),n=n.join("")):n=n+i+"%",n}function s(e){var t=Math.floor(e._value/60/60),o=Math.floor((e._value-60*t*60)/60),n=Math.round(e._value-60*t*60-60*o);return t+":"+(10>o?"0"+o:o)+":"+(10>n?"0"+n:n)}function a(e){var t=e.split(":"),o=0;return 3===t.length?(o+=60*Number(t[0])*60,o+=60*Number(t[1]),o+=Number(t[2])):2===t.length&&(o+=60*Number(t[0]),o+=Number(t[1])),Number(o)}function l(e,o,n){var i,r,s,a,l,c,u=!1,h=!1,d=!1,f="",w=!1,v=!1,y=!1,C=!1,b=!1,S="",R="",T=Math.abs(e),E=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],k="",D=!1;if(0===e&&null!==m)return m;if(o.indexOf("(")>-1?(u=!0,o=o.slice(1,-1)):o.indexOf("+")>-1&&(h=!0,o=o.replace(/\+/g,"")),o.indexOf("a")>-1&&(w=o.indexOf("aK")>=0,v=o.indexOf("aM")>=0,y=o.indexOf("aB")>=0,C=o.indexOf("aT")>=0,b=w||v||y||C,o.indexOf(" a")>-1?(f=" ",o=o.replace(" a","")):o=o.replace("a",""),T>=Math.pow(10,12)&&!b||C?(f+=p[g].abbreviations.trillion,e/=Math.pow(10,12)):T<Math.pow(10,12)&&T>=Math.pow(10,9)&&!b||y?(f+=p[g].abbreviations.billion,e/=Math.pow(10,9)):T<Math.pow(10,9)&&T>=Math.pow(10,6)&&!b||v?(f+=p[g].abbreviations.million,e/=Math.pow(10,6)):(T<Math.pow(10,6)&&T>=Math.pow(10,3)&&!b||w)&&(f+=p[g].abbreviations.thousand,e/=Math.pow(10,3))),o.indexOf("b")>-1)for(o.indexOf(" b")>-1?(S=" ",o=o.replace(" b","")):o=o.replace("b",""),s=0;s<=E.length;s++)if(i=Math.pow(1024,s),r=Math.pow(1024,s+1),e>=i&&r>e){S+=E[s],i>0&&(e/=i);break}return o.indexOf("o")>-1&&(o.indexOf(" o")>-1?(R=" ",o=o.replace(" o","")):o=o.replace("o",""),R+=p[g].ordinal(e)),o.indexOf("[.]")>-1&&(d=!0,o=o.replace("[.]",".")),a=e.toString().split(".")[0],l=o.split(".")[1],c=o.indexOf(","),l?(l.indexOf("[")>-1?(l=l.replace("]",""),l=l.split("["),k=t(e,l[0].length+l[1].length,n,l[1].length)):k=t(e,l.length,n),a=k.split(".")[0],k=k.split(".")[1].length?p[g].delimiters.decimal+k.split(".")[1]:"",d&&0===Number(k.slice(1))&&(k="")):a=t(e,null,n),a.indexOf("-")>-1&&(a=a.slice(1),D=!0),c>-1&&(a=a.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+p[g].delimiters.thousands)),0===o.indexOf(".")&&(a=""),(u&&D?"(":"")+(!u&&D?"-":"")+(!D&&h?"+":"")+a+k+(R?R:"")+(f?f:"")+(S?S:"")+(u&&D?")":"")}function c(e,t){p[e]=t}function u(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function h(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){var o=u(e),n=u(t);return o>n?o:n},-1/0)}var d,f="1.5.3",p={},g="en",m=null,w="0,0",v="undefined"!=typeof module&&module.exports;d=function(t){return d.isNumeral(t)?t=t.value():0===t||"undefined"==typeof t?t=0:Number(t)||(t=d.fn.unformat(t)),new e(Number(t))},d.version=f,d.isNumeral=function(t){return t instanceof e},d.language=function(e,t){if(!e)return g;if(e&&!t){if(!p[e])throw new Error("Unknown language : "+e);g=e}return(t||!p[e])&&c(e,t),d},d.languageData=function(e){if(!e)return p[g];if(!p[e])throw new Error("Unknown language : "+e);return p[e]},d.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),d.zeroFormat=function(e){m="string"==typeof e?e:null},d.defaultFormat=function(e){w="string"==typeof e?e:"0.0"},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,t){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var o,n,i=this.length>>>0,r=!1;for(1<arguments.length&&(n=t,r=!0),o=0;i>o;++o)this.hasOwnProperty(o)&&(r?n=e(n,this[o],o,this):(n=this[o],r=!0));if(!r)throw new TypeError("Reduce of empty array with no initial value");return n}),d.fn=e.prototype={clone:function(){return d(this)},format:function(e,t){return o(this,e?e:w,void 0!==t?t:Math.round)},unformat:function(e){return"[object Number]"===Object.prototype.toString.call(e)?e:n(this,e?e:w)},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){function t(e,t){return e+o*t}var o=h.call(null,this._value,e);return this._value=[this._value,e].reduce(t,0)/o,this},subtract:function(e){function t(e,t){return e-o*t}var o=h.call(null,this._value,e);return this._value=[e].reduce(t,this._value*o)/o,this},multiply:function(e){function t(e,t){var o=h(e,t);return e*o*t*o/(o*o)}return this._value=[this._value,e].reduce(t,1),this},divide:function(e){function t(e,t){var o=h(e,t);return e*o/(t*o)}return this._value=[this._value,e].reduce(t),this},difference:function(e){return Math.abs(d(this._value).subtract(e).value())}},v&&(module.exports=d),"undefined"==typeof ender&&(this.numeral=d),"function"==typeof define&&define.amd&&define([],function(){return d})}.call(this),function(){"use strict";function e(){for(var e=h.getData(),t=[],o=0;o<e.length;o++)null!==e[o][0]&&t.push(e[o][0]);return t}function t(){return[0,1,2,3,4,5,6,7]}function o(e){return 0===e.length?0:e.reduce(function(e,t){return e+t})}function n(){return d?e():$("#dataEntryBox").val().split(",").map(function(e){return parseFloat(e)})}function i(e){var t=n();if(0===e)return[c.names[e]].concat(t.map(function(e){return e/t[0]*100}));for(var i=[],r=[],s=[],u=[],h=[1],d=[100],f=[t[0]],p=[],g=1;g<t.length;g++)i[g]=Math.abs(t[g]-t[g-1]),r[g]=1===g?a/(a+l):r[g-1]*(l+g-2)/(a+l+g-1),s[g]=Math.log(r[g])*i[g],u[g]=o(r),h[g]=1-u[g],d[g]=100*h[g],f[g]=t[g-1]*h[g],p[g]=Math.abs(f[g]-f[g-1]);return[c.names[e]].concat(d)}function r(){var e=JSON.stringify(n());$.ajax({url:"http://blooming-temple-6800.herokuapp.com/sbg-mle",dataType:"jsonp",data:{data:e}}).done(function(e){var t=JSON.parse(e);a=parseFloat(t[0]),l=parseFloat(t[1]),$("#alphaLabel").text("Alpha = "+s(a,3)),$("#betaLabel").text("Beta = "+s(l,3)),f.updateData()}).fail(function(){alert("The solver cannot converge to an alpha and beta")})}function s(e,t){var t=t||0,o=Math.pow(10,t),n=Math.abs(Math.round(e*o)),i=(0>e?"-":"")+String(Math.floor(n/o));if(t>0){var r=String(n%o),s=new Array(Math.max(t-r.length,0)+1).join("0");i+="."+s+r}return i}var a=.763665175981773,l=1.29582884513434,c={names:["Actual Data","Estimated Data"],axis:{x:{label:{text:"Years",position:"outer-center"}},y:{label:{text:"% Survivors",position:"outer-middle"}}}},u=[[1e3],[631],[468],[382],[326],[289],[262],[241]];$("#table").handsontable({data:u,colHeaders:["Survivors"],rowHeaders:function(e){return e},columns:[{type:"numeric"}]});var h=$("#table").handsontable("getInstance");$("#addrow").click(function(){h.alter("insert_row")});{var d=!0,f=new LineGraph(c,t,i,null);f.genGraph()}$("#updateTable").click(function(){d=!0,r()}),$("#updateTextArea").click(function(){d=!1,r()})}();